/*! For license information please see ZegoExpressPlayer-1.0.0.js.LICENSE.txt */
var ZegoExpressPlayer;(()=>{var e={204:e=>{"use strict";var t,n="object"==typeof Reflect?Reflect:null,i=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var r=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(n,i){function r(n){e.removeListener(t,o),i(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",r),n([].slice.call(arguments))}_(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&_(e,"error",t,n)}(e,r,{once:!0})}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function d(e,t,n,i){var r,o,s,d;if(a(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]),void 0===s)s=o[t]=n,++e._eventsCount;else if("function"==typeof s?s=o[t]=i?[n,s]:[s,n]:i?s.unshift(n):s.push(n),(r=l(e))>0&&s.length>r&&!s.warned){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,d=u,console&&console.warn&&console.warn(d)}return e}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function c(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=u.bind(i);return r.listener=n,i.wrapFn=r,r}function h(e,t,n){var i=e._events;if(void 0===i)return[];var r=i[t];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):f(r,r.length)}function p(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function f(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function _(e,t,n,i){if("function"==typeof e.on)i.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function r(o){i.once&&e.removeEventListener(t,r),n(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return l(this)},o.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=o[e];if(void 0===l)return!1;if("function"==typeof l)i(l,this,t);else{var d=l.length,u=f(l,d);for(n=0;n<d;++n)i(u[n],this,t)}return!0},o.prototype.addListener=function(e,t){return d(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return d(this,e,t,!0)},o.prototype.once=function(e,t){return a(t),this.on(e,c(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,c(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,i,r,o,s;if(a(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,r=o;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,o=Object.keys(n);for(i=0;i<o.length;++i)"removeListener"!==(r=o[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},o.prototype.listeners=function(e){return h(this,e,!0)},o.prototype.rawListeners=function(e){return h(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},o.prototype.listenerCount=p,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},705:(e,t,n)=>{const i=n(227),r=n(445),o=n(307);e.exports=i+r+o},701:(e,t,n)=>{e.exports={lowercase:n(445),uppercase:n(307),numbers:n(227),nolookalikes:n(251),nolookalikesSafe:n(403),alphanumeric:n(705)}},445:e=>{e.exports="abcdefghijklmnopqrstuvwxyz"},403:e=>{e.exports="6789BCDFGHJKLMNPQRTWbcdfghjkmnpqrtwz"},251:e=>{e.exports="346789ABCDEFGHJKLMNPQRTUVWXYabcdefghijkmnpqrtwxyz"},227:e=>{e.exports="0123456789"},307:e=>{e.exports="ABCDEFGHIJKLMNOPQRSTUVWXYZ"},892:(e,t,n)=>{var i;!function(e){!function(t){var i="object"==typeof n.g?n.g:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),r=o(e);function o(e,t){return function(n,i){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:i}),t&&t(n,i)}}void 0===i.Reflect?i.Reflect=e:r=o(i.Reflect,r),function(e){var t=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,i=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",r=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,s={__proto__:[]}instanceof Array,a=!o&&!s,l={create:o?function(){return ie(Object.create(null))}:s?function(){return ie({__proto__:null})}:function(){return ie({})},has:a?function(e,n){return t.call(e,n)}:function(e,t){return t in e},get:a?function(e,n){return t.call(e,n)?e[n]:void 0}:function(e,t){return e[t]}},d=Object.getPrototypeOf(Function),u="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,c=u||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?ee():Map,h=u||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?te():Set,p=new(u||"function"!=typeof WeakMap?ne():WeakMap);function f(e,t,n,i){if(O(n)){if(!W(e))throw new TypeError;if(!G(t))throw new TypeError;return R(e,t)}if(!W(e))throw new TypeError;if(!B(t))throw new TypeError;if(!B(i)&&!O(i)&&!L(i))throw new TypeError;return L(i)&&(i=void 0),P(e,t,n=H(n),i)}function _(e,t){function n(n,i){if(!B(n))throw new TypeError;if(!O(i)&&!Y(i))throw new TypeError;M(e,t,n,i)}return n}function g(e,t,n,i){if(!B(n))throw new TypeError;return O(i)||(i=H(i)),M(e,t,n,i)}function y(e,t,n){if(!B(t))throw new TypeError;return O(n)||(n=H(n)),k(e,t,n)}function m(e,t,n){if(!B(t))throw new TypeError;return O(n)||(n=H(n)),S(e,t,n)}function v(e,t,n){if(!B(t))throw new TypeError;return O(n)||(n=H(n)),C(e,t,n)}function w(e,t,n){if(!B(t))throw new TypeError;return O(n)||(n=H(n)),D(e,t,n)}function b(e,t){if(!B(e))throw new TypeError;return O(t)||(t=H(t)),x(e,t)}function E(e,t){if(!B(e))throw new TypeError;return O(t)||(t=H(t)),I(e,t)}function A(e,t,n){if(!B(t))throw new TypeError;O(n)||(n=H(n));var i=T(t,n,!1);if(O(i))return!1;if(!i.delete(e))return!1;if(i.size>0)return!0;var r=p.get(t);return r.delete(n),r.size>0||p.delete(t),!0}function R(e,t){for(var n=e.length-1;n>=0;--n){var i=(0,e[n])(t);if(!O(i)&&!L(i)){if(!G(i))throw new TypeError;t=i}}return t}function P(e,t,n,i){for(var r=e.length-1;r>=0;--r){var o=(0,e[r])(t,n,i);if(!O(o)&&!L(o)){if(!B(o))throw new TypeError;i=o}}return i}function T(e,t,n){var i=p.get(e);if(O(i)){if(!n)return;i=new c,p.set(e,i)}var r=i.get(t);if(O(r)){if(!n)return;r=new c,i.set(t,r)}return r}function k(e,t,n){if(S(e,t,n))return!0;var i=Q(t);return!L(i)&&k(e,i,n)}function S(e,t,n){var i=T(t,n,!1);return!O(i)&&z(i.has(e))}function C(e,t,n){if(S(e,t,n))return D(e,t,n);var i=Q(t);return L(i)?void 0:C(e,i,n)}function D(e,t,n){var i=T(t,n,!1);if(!O(i))return i.get(e)}function M(e,t,n,i){T(n,i,!0).set(e,t)}function x(e,t){var n=I(e,t),i=Q(e);if(null===i)return n;var r=x(i,t);if(r.length<=0)return n;if(n.length<=0)return r;for(var o=new h,s=[],a=0,l=n;a<l.length;a++){var d=l[a];o.has(d)||(o.add(d),s.push(d))}for(var u=0,c=r;u<c.length;u++){d=c[u];o.has(d)||(o.add(d),s.push(d))}return s}function I(e,t){var n=[],i=T(e,t,!1);if(O(i))return n;for(var r=K(i.keys()),o=0;;){var s=X(r);if(!s)return n.length=o,n;var a=$(s);try{n[o]=a}catch(e){try{J(r)}finally{throw e}}o++}}function F(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function O(e){return void 0===e}function L(e){return null===e}function N(e){return"symbol"==typeof e}function B(e){return"object"==typeof e?null!==e:"function"==typeof e}function j(e,t){switch(F(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",r=Z(e,i);if(void 0!==r){var o=r.call(e,n);if(B(o))throw new TypeError;return o}return U(e,"default"===n?"number":n)}function U(e,t){if("string"===t){var n=e.toString;if(q(n))if(!B(r=n.call(e)))return r;if(q(i=e.valueOf))if(!B(r=i.call(e)))return r}else{var i;if(q(i=e.valueOf))if(!B(r=i.call(e)))return r;var r,o=e.toString;if(q(o))if(!B(r=o.call(e)))return r}throw new TypeError}function z(e){return!!e}function V(e){return""+e}function H(e){var t=j(e,3);return N(t)?t:V(t)}function W(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function q(e){return"function"==typeof e}function G(e){return"function"==typeof e}function Y(e){switch(F(e)){case 3:case 4:return!0;default:return!1}}function Z(e,t){var n=e[t];if(null!=n){if(!q(n))throw new TypeError;return n}}function K(e){var t=Z(e,r);if(!q(t))throw new TypeError;var n=t.call(e);if(!B(n))throw new TypeError;return n}function $(e){return e.value}function X(e){var t=e.next();return!t.done&&t}function J(e){var t=e.return;t&&t.call(e)}function Q(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===d)return t;if(t!==d)return t;var n=e.prototype,i=n&&Object.getPrototypeOf(n);if(null==i||i===Object.prototype)return t;var r=i.constructor;return"function"!=typeof r||r===e?t:r}function ee(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[r]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var i=this._keys.length,r=n+1;r<i;r++)this._keys[r-1]=this._keys[r],this._values[r-1]=this._values[r];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,i)},t.prototype.values=function(){return new n(this._keys,this._values,o)},t.prototype.entries=function(){return new n(this._keys,this._values,s)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[r]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function i(e,t){return e}function o(e,t){return t}function s(e,t){return[e,t]}}function te(){return function(){function e(){this._map=new c}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[r]=function(){return this.keys()},e}()}function ne(){var e=16,n=l.create(),i=r();return function(){function e(){this._key=r()}return e.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&l.has(t,this._key)},e.prototype.get=function(e){var t=o(e,!1);return void 0!==t?l.get(t,this._key):void 0},e.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=r()},e}();function r(){var e;do{e="@@WeakMap@@"+d()}while(l.has(n,e));return n[e]=!0,e}function o(e,n){if(!t.call(e,i)){if(!n)return;Object.defineProperty(e,i,{value:l.create()})}return e[i]}function s(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function a(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):s(new Uint8Array(e),e):s(new Array(e),e)}function d(){var t=a(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var n="",i=0;i<e;++i){var r=t[i];4!==i&&6!==i&&8!==i||(n+="-"),r<16&&(n+="0"),n+=r.toString(16).toLowerCase()}return n}}function ie(e){return e.__=void 0,delete e.__,e}e("decorate",f),e("metadata",_),e("defineMetadata",g),e("hasMetadata",y),e("hasOwnMetadata",m),e("getMetadata",v),e("getOwnMetadata",w),e("getMetadataKeys",b),e("getOwnMetadataKeys",E),e("deleteMetadata",A)}(r)}()}(i||(i={}))}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,n),o.exports}n.m=e,n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.u=e=>e+".ZegoExpressPlayer-1.0.0.js",n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");if(i.length)for(var r=i.length-1;r>-1&&!e;)e=i[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),n.b=document.baseURI||self.location.href;var i={};(()=>{"use strict";n.d(i,{ZegoExpressPlayer:()=>Ya});var e={Request:"Request",Singleton:"Singleton",Transient:"Transient"},t={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},r={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"},o=0;function s(){return o++}var a=function(){function n(e,n){this.id=s(),this.activated=!1,this.serviceIdentifier=e,this.scope=n,this.type=t.Invalid,this.constraint=function(e){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null}return n.prototype.clone=function(){var t=new n(this.serviceIdentifier,this.scope);return t.activated=t.scope===e.Singleton&&this.activated,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.factory=this.factory,t.provider=this.provider,t.constraint=this.constraint,t.onActivation=this.onActivation,t.onDeactivation=this.onDeactivation,t.cache=this.cache,t},n}(),l="Metadata key was used more than once in a parameter:",d="NULL argument",u="Key Not Found",c="Ambiguous match found for serviceIdentifier:",h="No matching bindings found for serviceIdentifier:",p="Missing required @injectable annotation in:",f="Missing required @inject or @multiInject annotation in:",_="Circular dependency found:",g="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",y=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"The number of constructor arguments in the derived class "+e[0]+" must be >= than the number of constructor arguments of its base class."},m=function(e,t){return"@postConstruct error in class "+e+": "+t},v=function(e,t){return"@preDestroy error in class "+e+": "+t},w=function(e,t){return"onDeactivation() error in class "+e+": "+t},b="Maximum call stack size exceeded",E="named",A="name",R="unmanaged",P="optional",T="inject",k="multi_inject",S="inversify:tagged",C="inversify:tagged_props",D="inversify:paramtypes",M="post_construct",x="pre_destroy";var I=[T,k,A,R,E,P],F=function(){function e(){}return e.prototype.getConstructorMetadata=function(e){return{compilerGeneratedMetadata:Reflect.getMetadata(D,e),userGeneratedMetadata:Reflect.getMetadata(S,e)||{}}},e.prototype.getPropertiesMetadata=function(e){return Reflect.getMetadata(C,e)||[]},e}(),O={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};function L(e){return e instanceof RangeError||e.message===b}function N(e){return"function"==typeof e?e.name:"symbol"==typeof e?e.toString():e}function B(e,t,n){var i="",r=n(e,t);return 0!==r.length&&(i="\nRegistered bindings:",r.forEach((function(e){var t="Object";null!==e.implementationType&&(t=z(e.implementationType)),i=i+"\n "+t,e.constraint.metaData&&(i=i+" - "+e.constraint.metaData)}))),i}function j(e,t){return null!==e.parentRequest&&(e.parentRequest.serviceIdentifier===t||j(e.parentRequest,t))}function U(e){e.childRequests.forEach((function(e){if(j(e,e.serviceIdentifier)){var t=function(e){var t=function e(t,n){void 0===n&&(n=[]);var i=N(t.serviceIdentifier);return n.push(i),null!==t.parentRequest?e(t.parentRequest,n):n}(e);return t.reverse().join(" --\x3e ")}(e);throw new Error(_+" "+t)}U(e)}))}function z(e){if(e.name)return e.name;var t=e.toString(),n=t.match(/^function\s*([^\s(]+)/);return n?n[1]:"Anonymous function: "+t}var V=function(){function e(e){this.id=s(),this.container=e}return e.prototype.addPlan=function(e){this.plan=e},e.prototype.setCurrentRequest=function(e){this.currentRequest=e},e}(),H=function(){function e(e,t){this.key=e,this.value=t}return e.prototype.toString=function(){return this.key===E?"named: "+String(this.value).toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+String(this.value)+" }"},e}(),W=function(e,t){this.parentContext=e,this.rootRequest=t},q=function(){function e(e){this._cb=e}return e.prototype.unwrap=function(){return this._cb()},e}(),G=function(){function e(e){this.str=e}return e.prototype.startsWith=function(e){return 0===this.str.indexOf(e)},e.prototype.endsWith=function(e){var t,n=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},e.prototype.contains=function(e){return-1!==this.str.indexOf(e)},e.prototype.equals=function(e){return this.str===e},e.prototype.value=function(){return this.str},e}(),Y=function(){function e(e,t,n,i){this.id=s(),this.type=e,this.serviceIdentifier=n;var r="symbol"==typeof t?t.toString().slice(7,-1):t;this.name=new G(r||""),this.identifier=t,this.metadata=new Array;var o=null;"string"==typeof i?o=new H(E,i):i instanceof H&&(o=i),null!==o&&this.metadata.push(o)}return e.prototype.hasTag=function(e){for(var t=0,n=this.metadata;t<n.length;t++){if(n[t].key===e)return!0}return!1},e.prototype.isArray=function(){return this.hasTag(k)},e.prototype.matchesArray=function(e){return this.matchesTag(k)(e)},e.prototype.isNamed=function(){return this.hasTag(E)},e.prototype.isTagged=function(){return this.metadata.some((function(e){return I.every((function(t){return e.key!==t}))}))},e.prototype.isOptional=function(){return this.matchesTag(P)(!0)},e.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(e){return e.key===E}))[0]:null},e.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(e){return I.every((function(t){return e.key!==t}))})):null},e.prototype.matchesNamedTag=function(e){return this.matchesTag(E)(e)},e.prototype.matchesTag=function(e){var t=this;return function(n){for(var i=0,r=t.metadata;i<r.length;i++){var o=r[i];if(o.key===e&&o.value===n)return!0}return!1}},e}(),Z=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))};function K(e,t,n,i){var r=e.getConstructorMetadata(n),o=r.compilerGeneratedMetadata;if(void 0===o)throw new Error(p+" "+t+".");var s=r.userGeneratedMetadata,a=Object.keys(s),l=0===n.length&&a.length>0,d=a.length>n.length,u=function(e,t,n,i,r){for(var o=[],s=0;s<r;s++){var a=$(s,e,t,n,i);null!==a&&o.push(a)}return o}(i,t,o,s,l||d?a.length:n.length),c=J(e,n,t);return Z(Z([],u,!0),c,!0)}function $(e,t,n,i,o){var s=o[e.toString()]||[],a=ee(s),l=!0!==a.unmanaged,d=i[e],u=a.inject||a.multiInject;if((d=u||d)instanceof q&&(d=d.unwrap()),l){if(!t&&(d===Object||d===Function||void 0===d))throw new Error(f+" argument "+e+" in class "+n+".");var c=new Y(r.ConstructorArgument,a.targetName,d);return c.metadata=s,c}return null}function X(e,t,n,i){var r=e||t;if(void 0===r){var o=p+" for property "+String(n)+" in class "+i+".";throw new Error(o)}return r}function J(e,t,n){for(var i=e.getPropertiesMetadata(t),o=[],s=Object.getOwnPropertySymbols(i),a=0,l=Object.keys(i).concat(s);a<l.length;a++){var d=l[a],u=i[d],c=ee(u),h=c.targetName||d,p=X(c.inject,c.multiInject,d,n),f=new Y(r.ClassProperty,h,p);f.metadata=u,o.push(f)}var _=Object.getPrototypeOf(t.prototype).constructor;if(_!==Object){var g=J(e,_,n);o=Z(Z([],o,!0),g,!0)}return o}function Q(e,t){var n=Object.getPrototypeOf(t.prototype).constructor;if(n!==Object){var i=K(e,z(n),n,!0),r=i.map((function(e){return e.metadata.filter((function(e){return e.key===R}))})),o=[].concat.apply([],r).length,s=i.length-o;return s>0?s:Q(e,n)}return 0}function ee(e){var t={};return e.forEach((function(e){t[e.key.toString()]=e.value})),{inject:t[T],multiInject:t[k],targetName:t[A],unmanaged:t[R]}}var te=function(){function e(e,t,n,i,r){this.id=s(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=r,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=null===n?new Map:null}return e.prototype.addChildRequest=function(t,n,i){var r=new e(t,this.parentContext,this,n,i);return this.childRequests.push(r),r},e}();function ne(e){return e._bindingDictionary}function ie(e,t,n,i,r){var o=oe(n.container,r.serviceIdentifier),s=[];return o.length===O.NoBindingsAvailable&&n.container.options.autoBindInjectable&&"function"==typeof r.serviceIdentifier&&e.getConstructorMetadata(r.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(r.serviceIdentifier).toSelf(),o=oe(n.container,r.serviceIdentifier)),s=t?o:o.filter((function(e){var t=new te(e.serviceIdentifier,n,i,e,r);return e.constraint(t)})),function(e,t,n,i){switch(t.length){case O.NoBindingsAvailable:if(n.isOptional())return t;var r=N(e),o=h;throw o+=function(e,t){if(t.isTagged()||t.isNamed()){var n="",i=t.getNamedTag(),r=t.getCustomTags();return null!==i&&(n+=i.toString()+"\n"),null!==r&&r.forEach((function(e){n+=e.toString()+"\n"}))," "+e+"\n "+e+" - "+n}return" "+e}(r,n),o+=B(i,r,oe),new Error(o);case O.OnlyOneBindingAvailable:return t;case O.MultipleBindingsAvailable:default:if(n.isArray())return t;r=N(e),o=c+" "+r;throw o+=B(i,r,oe),new Error(o)}}(r.serviceIdentifier,s,r,n.container),s}function re(e,n,i,r,o,s){var a,l;if(null===o){a=ie(e,n,r,null,s),l=new te(i,r,null,a,s);var d=new W(r,l);r.addPlan(d)}else a=ie(e,n,r,o,s),l=o.addChildRequest(s.serviceIdentifier,a,s);a.forEach((function(n){var i=null;if(s.isArray())i=l.addChildRequest(n.serviceIdentifier,n,s);else{if(n.cache)return;i=l}if(n.type===t.Instance&&null!==n.implementationType){var o=function(e,t){return K(e,z(t),t,!1)}(e,n.implementationType);if(!r.container.options.skipBaseClassChecks){var a=Q(e,n.implementationType);if(o.length<a){var d=y(z(n.implementationType));throw new Error(d)}}o.forEach((function(t){re(e,!1,t.serviceIdentifier,r,i,t)}))}}))}function oe(e,t){var n=[],i=ne(e);return i.hasKey(t)?n=i.get(t):null!==e.parent&&(n=oe(e.parent,t)),n}function se(e,t,n,i,r,o,s,a){void 0===a&&(a=!1);var l=new V(t),d=function(e,t,n,i,r,o){var s=new H(e?k:T,n),a=new Y(t,i,n,s);if(void 0!==r){var l=new H(r,o);a.metadata.push(l)}return a}(n,i,r,"",o,s);try{return re(e,a,r,l,null,d),l}catch(e){throw L(e)&&U(l.plan.rootRequest),e}}function ae(e){return("object"==typeof e&&null!==e||"function"==typeof e)&&"function"==typeof e.then}function le(e){return!!ae(e)||Array.isArray(e)&&e.some(ae)}var de,ue=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))},ce=function(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},he=function(e,t,n){e.has(t.id)||e.set(t.id,n)},pe=function(e,t){e.cache=t,e.activated=!0,ae(t)&&fe(e,t)},fe=function(e,t){return ue(void 0,void 0,void 0,(function(){var n,i;return ce(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,t];case 1:return n=r.sent(),e.cache=n,[3,3];case 2:throw i=r.sent(),e.cache=null,e.activated=!1,i;case 3:return[2]}}))}))};!function(e){e.DynamicValue="toDynamicValue",e.Factory="toFactory",e.Provider="toProvider"}(de||(de={}));var _e=function(){return _e=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},_e.apply(this,arguments)},ge=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))},ye=function(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},me=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))};function ve(e,t,n){var i;if(t.length>0){var o=function(e,t){return e.reduce((function(e,n){var i=t(n);return n.target.type===r.ConstructorArgument?e.constructorInjections.push(i):(e.propertyRequests.push(n),e.propertyInjections.push(i)),e.isAsync||(e.isAsync=le(i)),e}),{constructorInjections:[],propertyInjections:[],propertyRequests:[],isAsync:!1})}(t,n),s=_e(_e({},o),{constr:e});i=o.isAsync?function(e){return ge(this,void 0,void 0,(function(){var t,n;return ye(this,(function(i){switch(i.label){case 0:return[4,be(e.constructorInjections)];case 1:return t=i.sent(),[4,be(e.propertyInjections)];case 2:return n=i.sent(),[2,we(_e(_e({},e),{constructorInjections:t,propertyInjections:n}))]}}))}))}(s):we(s)}else i=new e;return i}function we(e){var t,n=new((t=e.constr).bind.apply(t,me([void 0],e.constructorInjections,!1)));return e.propertyRequests.forEach((function(t,i){var r=t.target.identifier,o=e.propertyInjections[i];n[r]=o})),n}function be(e){return ge(this,void 0,void 0,(function(){var t,n,i,r;return ye(this,(function(o){for(t=[],n=0,i=e;n<i.length;n++)r=i[n],Array.isArray(r)?t.push(Promise.all(r)):t.push(r);return[2,Promise.all(t)]}))}))}function Ee(e,t){var n=function(e,t){var n,i;if(Reflect.hasMetadata(M,e)){var r=Reflect.getMetadata(M,e);try{return null===(i=(n=t)[r.value])||void 0===i?void 0:i.call(n)}catch(t){throw new Error(m(e.name,t.message))}}}(e,t);return ae(n)?n.then((function(){return t})):t}function Ae(t,n){t.scope!==e.Singleton&&function(t,n){var i="Class cannot be instantiated in "+(t.scope===e.Request?"request":"transient")+" scope.";if("function"==typeof t.onDeactivation)throw new Error(w(n.name,i));if(Reflect.hasMetadata(x,n))throw new Error(v(n.name,i))}(t,n)}var Re=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))},Pe=function(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},Te=function(e){return function(t){t.parentContext.setCurrentRequest(t);var n=t.bindings,i=t.childRequests,r=t.target&&t.target.isArray(),o=!(t.parentRequest&&t.parentRequest.target&&t.target&&t.parentRequest.target.matchesArray(t.target.serviceIdentifier));if(r&&o)return i.map((function(t){return Te(e)(t)}));if(!t.target.isOptional()||0!==n.length){var s=n[0];return De(e,t,s)}}},ke=function(e,n){var i=function(e){switch(e.type){case t.Factory:return{factory:e.factory,factoryType:de.Factory};case t.Provider:return{factory:e.provider,factoryType:de.Provider};case t.DynamicValue:return{factory:e.dynamicValue,factoryType:de.DynamicValue};default:throw new Error("Unexpected factory type "+e.type)}}(e);return function(e,t){try{return e()}catch(e){throw L(e)&&(e=t()),e}}((function(){return i.factory.bind(e)(n)}),(function(){return new Error((e=i.factoryType,t=n.currentRequest.serviceIdentifier.toString(),"It looks like there is a circular dependency in one of the '"+e+"' bindings. Please investigate bindings withservice identifier '"+t+"'."));var e,t}))},Se=function(e,n,i){var r,o=n.childRequests;switch(function(e){var n=null;switch(e.type){case t.ConstantValue:case t.Function:n=e.cache;break;case t.Constructor:case t.Instance:n=e.implementationType;break;case t.DynamicValue:n=e.dynamicValue;break;case t.Provider:n=e.provider;break;case t.Factory:n=e.factory}if(null===n){var i=N(e.serviceIdentifier);throw new Error("Invalid binding type: "+i)}}(i),i.type){case t.ConstantValue:case t.Function:r=i.cache;break;case t.Constructor:r=i.implementationType;break;case t.Instance:r=function(e,t,n,i){Ae(e,t);var r=ve(t,n,i);return ae(r)?r.then((function(e){return Ee(t,e)})):Ee(t,r)}(i,i.implementationType,o,Te(e));break;default:r=ke(i,n.parentContext)}return r},Ce=function(t,n,i){var r=function(t,n){return n.scope===e.Singleton&&n.activated?n.cache:n.scope===e.Request&&t.has(n.id)?t.get(n.id):null}(t,n);return null!==r||function(t,n,i){n.scope===e.Singleton&&pe(n,i),n.scope===e.Request&&he(t,n,i)}(t,n,r=i()),r},De=function(e,t,n){return Ce(e,n,(function(){var i=Se(e,t,n);return i=ae(i)?i.then((function(e){return Me(t,n,e)})):Me(t,n,i)}))};function Me(e,t,n){var i,r=xe(e.parentContext,t,n),o=Le(e.parentContext.container),s=o.next();do{i=s.value;var a=e.parentContext,l=e.serviceIdentifier,d=Oe(i,l);r=ae(r)?Fe(d,a,r):Ie(d,a,r),s=o.next()}while(!0!==s.done&&!ne(i).hasKey(e.serviceIdentifier));return r}var xe=function(e,t,n){return"function"==typeof t.onActivation?t.onActivation(e,n):n},Ie=function(e,t,n){for(var i=e.next();!i.done;){if(ae(n=i.value(t,n)))return Fe(e,t,n);i=e.next()}return n},Fe=function(e,t,n){return Re(void 0,void 0,void 0,(function(){var i,r;return Pe(this,(function(o){switch(o.label){case 0:return[4,n];case 1:i=o.sent(),r=e.next(),o.label=2;case 2:return r.done?[3,4]:[4,r.value(t,i)];case 3:return i=o.sent(),r=e.next(),[3,2];case 4:return[2,i]}}))}))},Oe=function(e,t){var n=e._activations;return n.hasKey(t)?n.get(t).values():[].values()},Le=function(e){for(var t=[e],n=e.parent;null!==n;)t.push(n),n=n.parent;return{next:function(){var e=t.pop();return void 0!==e?{done:!1,value:e}:{done:!0,value:void 0}}}};var Ne=function(e,t){var n=e.parentRequest;return null!==n&&(!!t(n)||Ne(n,t))},Be=function(e){return function(t){var n=function(n){return null!==n&&null!==n.target&&n.target.matchesTag(e)(t)};return n.metaData=new H(e,t),n}},je=Be(E),Ue=function(e){return function(t){var n=null;if(null!==t){if(n=t.bindings[0],"string"==typeof e)return n.serviceIdentifier===e;var i=t.bindings[0].implementationType;return e===i}return!1}},ze=function(){function e(e){this._binding=e}return e.prototype.when=function(e){return this._binding.constraint=e,new Ve(this._binding)},e.prototype.whenTargetNamed=function(e){return this._binding.constraint=je(e),new Ve(this._binding)},e.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){return null!==e&&(null!==e.target&&!e.target.isNamed()&&!e.target.isTagged())},new Ve(this._binding)},e.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=Be(e)(t),new Ve(this._binding)},e.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return null!==t&&Ue(e)(t.parentRequest)},new Ve(this._binding)},e.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return null!==t&&je(e)(t.parentRequest)},new Ve(this._binding)},e.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(n){return null!==n&&Be(e)(t)(n.parentRequest)},new Ve(this._binding)},e.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return null!==t&&Ne(t,Ue(e))},new Ve(this._binding)},e.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return null!==t&&!Ne(t,Ue(e))},new Ve(this._binding)},e.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return null!==t&&Ne(t,je(e))},new Ve(this._binding)},e.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return null!==t&&!Ne(t,je(e))},new Ve(this._binding)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(n){return null!==n&&Ne(n,Be(e)(t))},new Ve(this._binding)},e.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(n){return null!==n&&!Ne(n,Be(e)(t))},new Ve(this._binding)},e.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return null!==t&&Ne(t,e)},new Ve(this._binding)},e.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return null!==t&&!Ne(t,e)},new Ve(this._binding)},e}(),Ve=function(){function e(e){this._binding=e}return e.prototype.onActivation=function(e){return this._binding.onActivation=e,new ze(this._binding)},e.prototype.onDeactivation=function(e){return this._binding.onDeactivation=e,new ze(this._binding)},e}(),He=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new ze(this._binding),this._bindingOnSyntax=new Ve(this._binding)}return e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},e}(),We=function(){function t(e){this._binding=e}return t.prototype.inRequestScope=function(){return this._binding.scope=e.Request,new He(this._binding)},t.prototype.inSingletonScope=function(){return this._binding.scope=e.Singleton,new He(this._binding)},t.prototype.inTransientScope=function(){return this._binding.scope=e.Transient,new He(this._binding)},t}(),qe=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new ze(this._binding),this._bindingOnSyntax=new Ve(this._binding),this._bindingInSyntax=new We(e)}return e.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},e.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},e.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},e}(),Ge=function(){function n(e){this._binding=e}return n.prototype.to=function(e){return this._binding.type=t.Instance,this._binding.implementationType=e,new qe(this._binding)},n.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error("The toSelf function can only be applied when a constructor is used as service identifier");var e=this._binding.serviceIdentifier;return this.to(e)},n.prototype.toConstantValue=function(n){return this._binding.type=t.ConstantValue,this._binding.cache=n,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=e.Singleton,new He(this._binding)},n.prototype.toDynamicValue=function(e){return this._binding.type=t.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new qe(this._binding)},n.prototype.toConstructor=function(n){return this._binding.type=t.Constructor,this._binding.implementationType=n,this._binding.scope=e.Singleton,new He(this._binding)},n.prototype.toFactory=function(n){return this._binding.type=t.Factory,this._binding.factory=n,this._binding.scope=e.Singleton,new He(this._binding)},n.prototype.toFunction=function(n){if("function"!=typeof n)throw new Error("Value provided to function binding must be a function!");var i=this.toConstantValue(n);return this._binding.type=t.Function,this._binding.scope=e.Singleton,i},n.prototype.toAutoFactory=function(n){return this._binding.type=t.Factory,this._binding.factory=function(e){return function(){return e.container.get(n)}},this._binding.scope=e.Singleton,new He(this._binding)},n.prototype.toAutoNamedFactory=function(e){return this._binding.type=t.Factory,this._binding.factory=function(t){return function(n){return t.container.getNamed(e,n)}},new He(this._binding)},n.prototype.toProvider=function(n){return this._binding.type=t.Provider,this._binding.provider=n,this._binding.scope=e.Singleton,new He(this._binding)},n.prototype.toService=function(e){this.toDynamicValue((function(t){return t.container.get(e)}))},n}(),Ye=function(){function e(){}return e.of=function(t,n,i,r,o){var s=new e;return s.bindings=t,s.middleware=n,s.deactivations=r,s.activations=i,s.moduleActivationStore=o,s},e}();var Ze=function(){function e(){this._map=new Map}return e.prototype.getMap=function(){return this._map},e.prototype.add=function(e,t){if(null==e)throw new Error(d);if(null==t)throw new Error(d);var n=this._map.get(e);void 0!==n?n.push(t):this._map.set(e,[t])},e.prototype.get=function(e){if(null==e)throw new Error(d);var t=this._map.get(e);if(void 0!==t)return t;throw new Error(u)},e.prototype.remove=function(e){if(null==e)throw new Error(d);if(!this._map.delete(e))throw new Error(u)},e.prototype.removeIntersection=function(e){var t=this;this.traverse((function(n,i){var r=e.hasKey(n)?e.get(n):void 0;if(void 0!==r){var o=i.filter((function(e){return!r.some((function(t){return e===t}))}));t._setValue(n,o)}}))},e.prototype.removeByCondition=function(e){var t=this,n=[];return this._map.forEach((function(i,r){for(var o=[],s=0,a=i;s<a.length;s++){var l=a[s];e(l)?n.push(l):o.push(l)}t._setValue(r,o)})),n},e.prototype.hasKey=function(e){if(null==e)throw new Error(d);return this._map.has(e)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,n){e.forEach((function(e){return t.add(n,"object"==typeof(i=e)&&null!==i&&"clone"in i&&"function"==typeof i.clone?e.clone():e);var i}))})),t},e.prototype.traverse=function(e){this._map.forEach((function(t,n){e(n,t)}))},e.prototype._setValue=function(e,t){t.length>0?this._map.set(e,t):this._map.delete(e)},e}(),Ke=function(){function e(){this._map=new Map}return e.prototype.remove=function(e){if(this._map.has(e)){var t=this._map.get(e);return this._map.delete(e),t}return this._getEmptyHandlersStore()},e.prototype.addDeactivation=function(e,t,n){this._getModuleActivationHandlers(e).onDeactivations.add(t,n)},e.prototype.addActivation=function(e,t,n){this._getModuleActivationHandlers(e).onActivations.add(t,n)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,n){t._map.set(n,{onActivations:e.onActivations.clone(),onDeactivations:e.onDeactivations.clone()})})),t},e.prototype._getModuleActivationHandlers=function(e){var t=this._map.get(e);return void 0===t&&(t=this._getEmptyHandlersStore(),this._map.set(e,t)),t},e.prototype._getEmptyHandlersStore=function(){return{onActivations:new Ze,onDeactivations:new Ze}},e}(),$e=function(){return $e=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},$e.apply(this,arguments)},Xe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))},Je=function(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},Qe=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},et=function(){function t(t){var n=t||{};if("object"!=typeof n)throw new Error("Invalid Container constructor argument. Container options must be an object.");if(void 0===n.defaultScope)n.defaultScope=e.Transient;else if(n.defaultScope!==e.Singleton&&n.defaultScope!==e.Transient&&n.defaultScope!==e.Request)throw new Error("Invalid Container option. Default scope must be a string ('singleton' or 'transient').");if(void 0===n.autoBindInjectable)n.autoBindInjectable=!1;else if("boolean"!=typeof n.autoBindInjectable)throw new Error("Invalid Container option. Auto bind injectable must be a boolean");if(void 0===n.skipBaseClassChecks)n.skipBaseClassChecks=!1;else if("boolean"!=typeof n.skipBaseClassChecks)throw new Error("Invalid Container option. Skip base check must be a boolean");this.options={autoBindInjectable:n.autoBindInjectable,defaultScope:n.defaultScope,skipBaseClassChecks:n.skipBaseClassChecks},this.id=s(),this._bindingDictionary=new Ze,this._snapshots=[],this._middleware=null,this._activations=new Ze,this._deactivations=new Ze,this.parent=null,this._metadataReader=new F,this._moduleActivationStore=new Ke}return t.merge=function(e,n){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];var o=new t,s=Qe([e,n],i,!0).map((function(e){return ne(e)})),a=ne(o);return s.forEach((function(e){var t;t=a,e.traverse((function(e,n){n.forEach((function(e){t.add(e.serviceIdentifier,e.clone())}))}))})),o},t.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),i=0,r=e;i<r.length;i++){var o=r[i],s=n(o.id);o.registry(s.bindFunction,s.unbindFunction,s.isboundFunction,s.rebindFunction,s.unbindAsyncFunction,s.onActivationFunction,s.onDeactivationFunction)}},t.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Xe(this,void 0,void 0,(function(){var t,n,i,r,o;return Je(this,(function(s){switch(s.label){case 0:t=this._getContainerModuleHelpersFactory(),n=0,i=e,s.label=1;case 1:return n<i.length?(r=i[n],o=t(r.id),[4,r.registry(o.bindFunction,o.unbindFunction,o.isboundFunction,o.rebindFunction,o.unbindAsyncFunction,o.onActivationFunction,o.onDeactivationFunction)]):[3,4];case 2:s.sent(),s.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},t.prototype.unload=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.forEach((function(t){var n=e._removeModuleBindings(t.id);e._deactivateSingletons(n),e._removeModuleHandlers(t.id)}))},t.prototype.unloadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Xe(this,void 0,void 0,(function(){var t,n,i,r;return Je(this,(function(o){switch(o.label){case 0:t=0,n=e,o.label=1;case 1:return t<n.length?(i=n[t],r=this._removeModuleBindings(i.id),[4,this._deactivateSingletonsAsync(r)]):[3,4];case 2:o.sent(),this._removeModuleHandlers(i.id),o.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},t.prototype.bind=function(t){var n=this.options.defaultScope||e.Transient,i=new a(t,n);return this._bindingDictionary.add(t,i),new Ge(i)},t.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},t.prototype.rebindAsync=function(e){return Xe(this,void 0,void 0,(function(){return Je(this,(function(t){switch(t.label){case 0:return[4,this.unbindAsync(e)];case 1:return t.sent(),[2,this.bind(e)]}}))}))},t.prototype.unbind=function(e){if(this._bindingDictionary.hasKey(e)){var t=this._bindingDictionary.get(e);this._deactivateSingletons(t)}this._removeServiceFromDictionary(e)},t.prototype.unbindAsync=function(e){return Xe(this,void 0,void 0,(function(){var t;return Je(this,(function(n){switch(n.label){case 0:return this._bindingDictionary.hasKey(e)?(t=this._bindingDictionary.get(e),[4,this._deactivateSingletonsAsync(t)]):[3,2];case 1:n.sent(),n.label=2;case 2:return this._removeServiceFromDictionary(e),[2]}}))}))},t.prototype.unbindAll=function(){var e=this;this._bindingDictionary.traverse((function(t,n){e._deactivateSingletons(n)})),this._bindingDictionary=new Ze},t.prototype.unbindAllAsync=function(){return Xe(this,void 0,void 0,(function(){var e,t=this;return Je(this,(function(n){switch(n.label){case 0:return e=[],this._bindingDictionary.traverse((function(n,i){e.push(t._deactivateSingletonsAsync(i))})),[4,Promise.all(e)];case 1:return n.sent(),this._bindingDictionary=new Ze,[2]}}))}))},t.prototype.onActivation=function(e,t){this._activations.add(e,t)},t.prototype.onDeactivation=function(e,t){this._deactivations.add(e,t)},t.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},t.prototype.isCurrentBound=function(e){return this._bindingDictionary.hasKey(e)},t.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,E,t)},t.prototype.isBoundTagged=function(e,t,n){var i=!1;if(this._bindingDictionary.hasKey(e)){var o=this._bindingDictionary.get(e),s=function(e,t,n,i){var o=new Y(r.Variable,"",t,new H(n,i)),s=new V(e);return new te(t,s,null,[],o)}(this,e,t,n);i=o.some((function(e){return e.constraint(s)}))}return!i&&this.parent&&(i=this.parent.isBoundTagged(e,t,n)),i},t.prototype.snapshot=function(){this._snapshots.push(Ye.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()))},t.prototype.restore=function(){var e=this._snapshots.pop();if(void 0===e)throw new Error("No snapshot available to restore.");this._bindingDictionary=e.bindings,this._activations=e.activations,this._deactivations=e.deactivations,this._middleware=e.middleware,this._moduleActivationStore=e.moduleActivationStore},t.prototype.createChild=function(e){var n=new t(e||this.options);return n.parent=this,n},t.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce((function(e,t){return t(e)}),n)},t.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},t.prototype.get=function(e){var t=this._getNotAllArgs(e,!1);return this._getButThrowIfAsync(t)},t.prototype.getAsync=function(e){return Xe(this,void 0,void 0,(function(){var t;return Je(this,(function(n){return t=this._getNotAllArgs(e,!1),[2,this._get(t)]}))}))},t.prototype.getTagged=function(e,t,n){var i=this._getNotAllArgs(e,!1,t,n);return this._getButThrowIfAsync(i)},t.prototype.getTaggedAsync=function(e,t,n){return Xe(this,void 0,void 0,(function(){var i;return Je(this,(function(r){return i=this._getNotAllArgs(e,!1,t,n),[2,this._get(i)]}))}))},t.prototype.getNamed=function(e,t){return this.getTagged(e,E,t)},t.prototype.getNamedAsync=function(e,t){return this.getTaggedAsync(e,E,t)},t.prototype.getAll=function(e){var t=this._getAllArgs(e);return this._getButThrowIfAsync(t)},t.prototype.getAllAsync=function(e){var t=this._getAllArgs(e);return this._getAll(t)},t.prototype.getAllTagged=function(e,t,n){var i=this._getNotAllArgs(e,!0,t,n);return this._getButThrowIfAsync(i)},t.prototype.getAllTaggedAsync=function(e,t,n){var i=this._getNotAllArgs(e,!0,t,n);return this._getAll(i)},t.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,E,t)},t.prototype.getAllNamedAsync=function(e,t){return this.getAllTaggedAsync(e,E,t)},t.prototype.resolve=function(e){var t=this.isBound(e);t||this.bind(e).toSelf();var n=this.get(e);return t||this.unbind(e),n},t.prototype._preDestroy=function(e,t){if(Reflect.hasMetadata(x,e))return t[Reflect.getMetadata(x,e).value]()},t.prototype._removeModuleHandlers=function(e){var t=this._moduleActivationStore.remove(e);this._activations.removeIntersection(t.onActivations),this._deactivations.removeIntersection(t.onDeactivations)},t.prototype._removeModuleBindings=function(e){return this._bindingDictionary.removeByCondition((function(t){return t.moduleId===e}))},t.prototype._deactivate=function(e,t){var n=this,i=Object.getPrototypeOf(t).constructor;try{if(this._deactivations.hasKey(e.serviceIdentifier)){var r=this._deactivateContainer(t,this._deactivations.get(e.serviceIdentifier).values());if(ae(r))return this._handleDeactivationError(r.then((function(){return n._propagateContainerDeactivationThenBindingAndPreDestroyAsync(e,t,i)})),i)}var o=this._propagateContainerDeactivationThenBindingAndPreDestroy(e,t,i);if(ae(o))return this._handleDeactivationError(o,i)}catch(e){throw new Error(w(i.name,e.message))}},t.prototype._handleDeactivationError=function(e,t){return Xe(this,void 0,void 0,(function(){var n;return Je(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e];case 1:return i.sent(),[3,3];case 2:throw n=i.sent(),new Error(w(t.name,n.message));case 3:return[2]}}))}))},t.prototype._deactivateContainer=function(e,t){for(var n=this,i=t.next();i.value;){var r=i.value(e);if(ae(r))return r.then((function(){return n._deactivateContainerAsync(e,t)}));i=t.next()}},t.prototype._deactivateContainerAsync=function(e,t){return Xe(this,void 0,void 0,(function(){var n;return Je(this,(function(i){switch(i.label){case 0:n=t.next(),i.label=1;case 1:return n.value?[4,n.value(e)]:[3,3];case 2:return i.sent(),n=t.next(),[3,1];case 3:return[2]}}))}))},t.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(e,t){e._binding.moduleId=t},n=function(n){return function(i){var r=e.rebind(i);return t(r,n),r}},i=function(t){return function(n,i){e._moduleActivationStore.addActivation(t,n,i),e.onActivation(n,i)}},r=function(t){return function(n,i){e._moduleActivationStore.addDeactivation(t,n,i),e.onDeactivation(n,i)}};return function(o){return{bindFunction:(s=o,function(n){var i=e.bind(n);return t(i,s),i}),isboundFunction:function(t){return e.isBound(t)},onActivationFunction:i(o),onDeactivationFunction:r(o),rebindFunction:n(o),unbindFunction:function(t){return e.unbind(t)},unbindAsyncFunction:function(t){return e.unbindAsync(t)}};var s}},t.prototype._getAll=function(e){return Promise.all(this._get(e))},t.prototype._get=function(e){var t=$e($e({},e),{contextInterceptor:function(e){return e},targetType:r.Variable});if(this._middleware){var n=this._middleware(t);if(null==n)throw new Error("Invalid return type in middleware. Middleware must return!");return n}return this._planAndResolve()(t)},t.prototype._getButThrowIfAsync=function(e){var t=this._get(e);if(le(t))throw new Error("You are attempting to construct '"+e.serviceIdentifier+"' in a synchronous way\n but it has asynchronous dependencies.");return t},t.prototype._getAllArgs=function(e){return{avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:e}},t.prototype._getNotAllArgs=function(e,t,n,i){return{avoidConstraints:!1,isMultiInject:t,serviceIdentifier:e,key:n,value:i}},t.prototype._planAndResolve=function(){var e=this;return function(t){var n=se(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);return function(e){return Te(e.plan.rootRequest.requestScope)(e.plan.rootRequest)}(n=t.contextInterceptor(n))}},t.prototype._deactivateIfSingleton=function(e){var t=this;if(e.activated)return ae(e.cache)?e.cache.then((function(n){return t._deactivate(e,n)})):this._deactivate(e,e.cache)},t.prototype._deactivateSingletons=function(e){for(var t=0,n=e;t<n.length;t++){var i=n[t];if(ae(this._deactivateIfSingleton(i)))throw new Error("Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)")}},t.prototype._deactivateSingletonsAsync=function(e){return Xe(this,void 0,void 0,(function(){var t=this;return Je(this,(function(n){switch(n.label){case 0:return[4,Promise.all(e.map((function(e){return t._deactivateIfSingleton(e)})))];case 1:return n.sent(),[2]}}))}))},t.prototype._propagateContainerDeactivationThenBindingAndPreDestroy=function(e,t,n){return this.parent?this._deactivate.bind(this.parent)(e,t):this._bindingDeactivationAndPreDestroy(e,t,n)},t.prototype._propagateContainerDeactivationThenBindingAndPreDestroyAsync=function(e,t,n){return Xe(this,void 0,void 0,(function(){return Je(this,(function(i){switch(i.label){case 0:return this.parent?[4,this._deactivate.bind(this.parent)(e,t)]:[3,2];case 1:return i.sent(),[3,4];case 2:return[4,this._bindingDeactivationAndPreDestroyAsync(e,t,n)];case 3:i.sent(),i.label=4;case 4:return[2]}}))}))},t.prototype._removeServiceFromDictionary=function(e){try{this._bindingDictionary.remove(e)}catch(t){throw new Error("Could not unbind serviceIdentifier: "+N(e))}},t.prototype._bindingDeactivationAndPreDestroy=function(e,t,n){var i=this;if("function"==typeof e.onDeactivation){var r=e.onDeactivation(t);if(ae(r))return r.then((function(){return i._preDestroy(n,t)}))}return this._preDestroy(n,t)},t.prototype._bindingDeactivationAndPreDestroyAsync=function(e,t,n){return Xe(this,void 0,void 0,(function(){return Je(this,(function(i){switch(i.label){case 0:return"function"!=typeof e.onDeactivation?[3,2]:[4,e.onDeactivation(t)];case 1:i.sent(),i.label=2;case 2:return[4,this._preDestroy(n,t)];case 3:return i.sent(),[2]}}))}))},t}();class tt extends et{constructor(){super({defaultScope:"Singleton",autoBindInjectable:!0,skipBaseClassChecks:!0})}}function nt(){return function(e){if(Reflect.hasOwnMetadata(D,e))throw new Error("Cannot apply @injectable decorator multiple times.");var t=Reflect.getMetadata("design:paramtypes",e)||[];return Reflect.defineMetadata(D,t,e),e}}function it(e,t,n,i){!function(e){if(void 0!==e)throw new Error(g)}(t),ot(S,e,n.toString(),i)}function rt(e){var t=[];if(Array.isArray(e)){var n=function(e){for(var t=new Set,n=0,i=e;n<i.length;n++){var r=i[n];if(t.has(r))return r;t.add(r)}}((t=e).map((function(e){return e.key})));if(void 0!==n)throw new Error(l+" "+n.toString())}else t=[e];return t}function ot(e,t,n,i){var r=rt(i),o={};Reflect.hasOwnMetadata(e,t)&&(o=Reflect.getMetadata(e,t));var s=o[n];if(void 0===s)s=[];else for(var a=function(e){if(r.some((function(t){return t.key===e.key})))throw new Error(l+" "+e.key.toString())},d=0,u=s;d<u.length;d++){a(u[d])}s.push.apply(s,r),o[n]=s,Reflect.defineMetadata(e,o,t)}function st(e){return function(t,n,i){"number"==typeof i?it(t,n,i,e):function(e,t,n){if(void 0!==e.prototype)throw new Error(g);ot(C,e.constructor,t,n)}(t,n,e)}}var at,lt,dt=(at=T,function(e){return function(t,n,i){if(void 0===e){var r="function"==typeof t?t.name:t.constructor.name;throw new Error("@inject called with undefined this could mean that the class "+r+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation.")}return st(new H(at,e))(t,n,i)}});n(892);!function(e){e.RESET="reset",e.DOWNLOAD="download",e.PLAY="play",e.PAUSE="pause",e.SRC_CHANGED="mediaResourceChanged",e.SET_VOLUME="setVolume",e.STOP="stop",e.TASK="NewTask",e.PLAYER_EVENT_EMIT="playerEventEmit"}(lt||(lt={}));function ut(e){let t=e.length;for(;--t>=0;)e[t]=0}const ct=256,ht=286,pt=30,ft=15,_t=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),gt=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),yt=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),mt=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),vt=new Array(576);ut(vt);const wt=new Array(60);ut(wt);const bt=new Array(512);ut(bt);const Et=new Array(256);ut(Et);const At=new Array(29);ut(At);const Rt=new Array(pt);function Pt(e,t,n,i,r){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=e&&e.length}let Tt,kt,St;function Ct(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}ut(Rt);const Dt=e=>e<256?bt[e]:bt[256+(e>>>7)],Mt=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},xt=(e,t,n)=>{e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,Mt(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},It=(e,t,n)=>{xt(e,n[2*t],n[2*t+1])},Ft=(e,t)=>{let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},Ot=(e,t,n)=>{const i=new Array(16);let r,o,s=0;for(r=1;r<=ft;r++)s=s+n[r-1]<<1,i[r]=s;for(o=0;o<=t;o++){let t=e[2*o+1];0!==t&&(e[2*o]=Ft(i[t]++,t))}},Lt=e=>{let t;for(t=0;t<ht;t++)e.dyn_ltree[2*t]=0;for(t=0;t<pt;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},Nt=e=>{e.bi_valid>8?Mt(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Bt=(e,t,n,i)=>{const r=2*t,o=2*n;return e[r]<e[o]||e[r]===e[o]&&i[t]<=i[n]},jt=(e,t,n)=>{const i=e.heap[n];let r=n<<1;for(;r<=e.heap_len&&(r<e.heap_len&&Bt(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!Bt(t,i,e.heap[r],e.depth));)e.heap[n]=e.heap[r],n=r,r<<=1;e.heap[n]=i},Ut=(e,t,n)=>{let i,r,o,s,a=0;if(0!==e.sym_next)do{i=255&e.pending_buf[e.sym_buf+a++],i+=(255&e.pending_buf[e.sym_buf+a++])<<8,r=e.pending_buf[e.sym_buf+a++],0===i?It(e,r,t):(o=Et[r],It(e,o+ct+1,t),s=_t[o],0!==s&&(r-=At[o],xt(e,r,s)),i--,o=Dt(i),It(e,o,n),s=gt[o],0!==s&&(i-=Rt[o],xt(e,i,s)))}while(a<e.sym_next);It(e,256,t)},zt=(e,t)=>{const n=t.dyn_tree,i=t.stat_desc.static_tree,r=t.stat_desc.has_stree,o=t.stat_desc.elems;let s,a,l,d=-1;for(e.heap_len=0,e.heap_max=573,s=0;s<o;s++)0!==n[2*s]?(e.heap[++e.heap_len]=d=s,e.depth[s]=0):n[2*s+1]=0;for(;e.heap_len<2;)l=e.heap[++e.heap_len]=d<2?++d:0,n[2*l]=1,e.depth[l]=0,e.opt_len--,r&&(e.static_len-=i[2*l+1]);for(t.max_code=d,s=e.heap_len>>1;s>=1;s--)jt(e,n,s);l=o;do{s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],jt(e,n,1),a=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=a,n[2*l]=n[2*s]+n[2*a],e.depth[l]=(e.depth[s]>=e.depth[a]?e.depth[s]:e.depth[a])+1,n[2*s+1]=n[2*a+1]=l,e.heap[1]=l++,jt(e,n,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const n=t.dyn_tree,i=t.max_code,r=t.stat_desc.static_tree,o=t.stat_desc.has_stree,s=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,l=t.stat_desc.max_length;let d,u,c,h,p,f,_=0;for(h=0;h<=ft;h++)e.bl_count[h]=0;for(n[2*e.heap[e.heap_max]+1]=0,d=e.heap_max+1;d<573;d++)u=e.heap[d],h=n[2*n[2*u+1]+1]+1,h>l&&(h=l,_++),n[2*u+1]=h,u>i||(e.bl_count[h]++,p=0,u>=a&&(p=s[u-a]),f=n[2*u],e.opt_len+=f*(h+p),o&&(e.static_len+=f*(r[2*u+1]+p)));if(0!==_){do{for(h=l-1;0===e.bl_count[h];)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[l]--,_-=2}while(_>0);for(h=l;0!==h;h--)for(u=e.bl_count[h];0!==u;)c=e.heap[--d],c>i||(n[2*c+1]!==h&&(e.opt_len+=(h-n[2*c+1])*n[2*c],n[2*c+1]=h),u--)}})(e,t),Ot(n,d,e.bl_count)},Vt=(e,t,n)=>{let i,r,o=-1,s=t[1],a=0,l=7,d=4;for(0===s&&(l=138,d=3),t[2*(n+1)+1]=65535,i=0;i<=n;i++)r=s,s=t[2*(i+1)+1],++a<l&&r===s||(a<d?e.bl_tree[2*r]+=a:0!==r?(r!==o&&e.bl_tree[2*r]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,o=r,0===s?(l=138,d=3):r===s?(l=6,d=3):(l=7,d=4))},Ht=(e,t,n)=>{let i,r,o=-1,s=t[1],a=0,l=7,d=4;for(0===s&&(l=138,d=3),i=0;i<=n;i++)if(r=s,s=t[2*(i+1)+1],!(++a<l&&r===s)){if(a<d)do{It(e,r,e.bl_tree)}while(0!=--a);else 0!==r?(r!==o&&(It(e,r,e.bl_tree),a--),It(e,16,e.bl_tree),xt(e,a-3,2)):a<=10?(It(e,17,e.bl_tree),xt(e,a-3,3)):(It(e,18,e.bl_tree),xt(e,a-11,7));a=0,o=r,0===s?(l=138,d=3):r===s?(l=6,d=3):(l=7,d=4)}};let Wt=!1;const qt=(e,t,n,i)=>{xt(e,0+(i?1:0),3),Nt(e),Mt(e,n),Mt(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n};var Gt=(e,t,n,i)=>{let r,o,s=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<ct;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),zt(e,e.l_desc),zt(e,e.d_desc),s=(e=>{let t;for(Vt(e,e.dyn_ltree,e.l_desc.max_code),Vt(e,e.dyn_dtree,e.d_desc.max_code),zt(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*mt[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),r=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,o<=r&&(r=o)):r=o=n+5,n+4<=r&&-1!==t?qt(e,t,n,i):4===e.strategy||o===r?(xt(e,2+(i?1:0),3),Ut(e,vt,wt)):(xt(e,4+(i?1:0),3),((e,t,n,i)=>{let r;for(xt(e,t-257,5),xt(e,n-1,5),xt(e,i-4,4),r=0;r<i;r++)xt(e,e.bl_tree[2*mt[r]+1],3);Ht(e,e.dyn_ltree,t-1),Ht(e,e.dyn_dtree,n-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),Ut(e,e.dyn_ltree,e.dyn_dtree)),Lt(e),i&&Nt(e)},Yt={_tr_init:e=>{Wt||((()=>{let e,t,n,i,r;const o=new Array(16);for(n=0,i=0;i<28;i++)for(At[i]=n,e=0;e<1<<_t[i];e++)Et[n++]=i;for(Et[n-1]=i,r=0,i=0;i<16;i++)for(Rt[i]=r,e=0;e<1<<gt[i];e++)bt[r++]=i;for(r>>=7;i<pt;i++)for(Rt[i]=r<<7,e=0;e<1<<gt[i]-7;e++)bt[256+r++]=i;for(t=0;t<=ft;t++)o[t]=0;for(e=0;e<=143;)vt[2*e+1]=8,e++,o[8]++;for(;e<=255;)vt[2*e+1]=9,e++,o[9]++;for(;e<=279;)vt[2*e+1]=7,e++,o[7]++;for(;e<=287;)vt[2*e+1]=8,e++,o[8]++;for(Ot(vt,287,o),e=0;e<pt;e++)wt[2*e+1]=5,wt[2*e]=Ft(e,5);Tt=new Pt(vt,_t,257,ht,ft),kt=new Pt(wt,gt,0,pt,ft),St=new Pt(new Array(0),yt,0,19,7)})(),Wt=!0),e.l_desc=new Ct(e.dyn_ltree,Tt),e.d_desc=new Ct(e.dyn_dtree,kt),e.bl_desc=new Ct(e.bl_tree,St),e.bi_buf=0,e.bi_valid=0,Lt(e)},_tr_stored_block:qt,_tr_flush_block:Gt,_tr_tally:(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(Et[n]+ct+1)]++,e.dyn_dtree[2*Dt(t)]++),e.sym_next===e.sym_end),_tr_align:e=>{xt(e,2,3),It(e,256,vt),(e=>{16===e.bi_valid?(Mt(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}};var Zt=(e,t,n,i)=>{let r=65535&e|0,o=e>>>16&65535|0,s=0;for(;0!==n;){s=n>2e3?2e3:n,n-=s;do{r=r+t[i++]|0,o=o+r|0}while(--s);r%=65521,o%=65521}return r|o<<16|0};const Kt=new Uint32Array((()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t})());var $t=(e,t,n,i)=>{const r=Kt,o=i+n;e^=-1;for(let n=i;n<o;n++)e=e>>>8^r[255&(e^t[n])];return-1^e},Xt={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Jt={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Qt,_tr_stored_block:en,_tr_flush_block:tn,_tr_tally:nn,_tr_align:rn}=Yt,{Z_NO_FLUSH:on,Z_PARTIAL_FLUSH:sn,Z_FULL_FLUSH:an,Z_FINISH:ln,Z_BLOCK:dn,Z_OK:un,Z_STREAM_END:cn,Z_STREAM_ERROR:hn,Z_DATA_ERROR:pn,Z_BUF_ERROR:fn,Z_DEFAULT_COMPRESSION:_n,Z_FILTERED:gn,Z_HUFFMAN_ONLY:yn,Z_RLE:mn,Z_FIXED:vn,Z_DEFAULT_STRATEGY:wn,Z_UNKNOWN:bn,Z_DEFLATED:En}=Jt,An=258,Rn=262,Pn=42,Tn=113,kn=666,Sn=(e,t)=>(e.msg=Xt[t],t),Cn=e=>2*e-(e>4?9:0),Dn=e=>{let t=e.length;for(;--t>=0;)e[t]=0},Mn=e=>{let t,n,i,r=e.w_size;t=e.hash_size,i=t;do{n=e.head[--i],e.head[i]=n>=r?n-r:0}while(--t);t=r,i=t;do{n=e.prev[--i],e.prev[i]=n>=r?n-r:0}while(--t)};let xn=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask;const In=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},Fn=(e,t)=>{tn(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,In(e.strm)},On=(e,t)=>{e.pending_buf[e.pending++]=t},Ln=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},Nn=(e,t,n,i)=>{let r=e.avail_in;return r>i&&(r=i),0===r?0:(e.avail_in-=r,t.set(e.input.subarray(e.next_in,e.next_in+r),n),1===e.state.wrap?e.adler=Zt(e.adler,t,r,n):2===e.state.wrap&&(e.adler=$t(e.adler,t,r,n)),e.next_in+=r,e.total_in+=r,r)},Bn=(e,t)=>{let n,i,r=e.max_chain_length,o=e.strstart,s=e.prev_length,a=e.nice_match;const l=e.strstart>e.w_size-Rn?e.strstart-(e.w_size-Rn):0,d=e.window,u=e.w_mask,c=e.prev,h=e.strstart+An;let p=d[o+s-1],f=d[o+s];e.prev_length>=e.good_match&&(r>>=2),a>e.lookahead&&(a=e.lookahead);do{if(n=t,d[n+s]===f&&d[n+s-1]===p&&d[n]===d[o]&&d[++n]===d[o+1]){o+=2,n++;do{}while(d[++o]===d[++n]&&d[++o]===d[++n]&&d[++o]===d[++n]&&d[++o]===d[++n]&&d[++o]===d[++n]&&d[++o]===d[++n]&&d[++o]===d[++n]&&d[++o]===d[++n]&&o<h);if(i=An-(h-o),o=h-An,i>s){if(e.match_start=t,s=i,i>=a)break;p=d[o+s-1],f=d[o+s]}}}while((t=c[t&u])>l&&0!=--r);return s<=e.lookahead?s:e.lookahead},jn=e=>{const t=e.w_size;let n,i,r;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-Rn)&&(e.window.set(e.window.subarray(t,t+t-i),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),Mn(e),i+=t),0===e.strm.avail_in)break;if(n=Nn(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=n,e.lookahead+e.insert>=3)for(r=e.strstart-e.insert,e.ins_h=e.window[r],e.ins_h=xn(e,e.ins_h,e.window[r+1]);e.insert&&(e.ins_h=xn(e,e.ins_h,e.window[r+3-1]),e.prev[r&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=r,r++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<Rn&&0!==e.strm.avail_in)},Un=(e,t)=>{let n,i,r,o=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,s=0,a=e.strm.avail_in;do{if(n=65535,r=e.bi_valid+42>>3,e.strm.avail_out<r)break;if(r=e.strm.avail_out-r,i=e.strstart-e.block_start,n>i+e.strm.avail_in&&(n=i+e.strm.avail_in),n>r&&(n=r),n<o&&(0===n&&t!==ln||t===on||n!==i+e.strm.avail_in))break;s=t===ln&&n===i+e.strm.avail_in?1:0,en(e,0,0,s),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,In(e.strm),i&&(i>n&&(i=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+i),e.strm.next_out),e.strm.next_out+=i,e.strm.avail_out-=i,e.strm.total_out+=i,e.block_start+=i,n-=i),n&&(Nn(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(0===s);return a-=e.strm.avail_in,a&&(a>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=a&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-a,e.strm.next_in),e.strstart),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),s?4:t!==on&&t!==ln&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(r=e.window_size-e.strstart,e.strm.avail_in>r&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,r+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),r>e.strm.avail_in&&(r=e.strm.avail_in),r&&(Nn(e.strm,e.window,e.strstart,r),e.strstart+=r,e.insert+=r>e.w_size-e.insert?e.w_size-e.insert:r),e.high_water<e.strstart&&(e.high_water=e.strstart),r=e.bi_valid+42>>3,r=e.pending_buf_size-r>65535?65535:e.pending_buf_size-r,o=r>e.w_size?e.w_size:r,i=e.strstart-e.block_start,(i>=o||(i||t===ln)&&t!==on&&0===e.strm.avail_in&&i<=r)&&(n=i>r?r:i,s=t===ln&&0===e.strm.avail_in&&n===i?1:0,en(e,e.block_start,n,s),e.block_start+=n,In(e.strm)),s?3:1)},zn=(e,t)=>{let n,i;for(;;){if(e.lookahead<Rn){if(jn(e),e.lookahead<Rn&&t===on)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=xn(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-Rn&&(e.match_length=Bn(e,n)),e.match_length>=3)if(i=nn(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=xn(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=xn(e,e.ins_h,e.window[e.strstart+1]);else i=nn(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(Fn(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===ln?(Fn(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Fn(e,!1),0===e.strm.avail_out)?1:2},Vn=(e,t)=>{let n,i,r;for(;;){if(e.lookahead<Rn){if(jn(e),e.lookahead<Rn&&t===on)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=xn(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-Rn&&(e.match_length=Bn(e,n),e.match_length<=5&&(e.strategy===gn||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-3,i=nn(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=r&&(e.ins_h=xn(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(Fn(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(i=nn(e,0,e.window[e.strstart-1]),i&&Fn(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=nn(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===ln?(Fn(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Fn(e,!1),0===e.strm.avail_out)?1:2};function Hn(e,t,n,i,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=r}const Wn=[new Hn(0,0,0,0,Un),new Hn(4,4,8,4,zn),new Hn(4,5,16,8,zn),new Hn(4,6,32,32,zn),new Hn(4,4,16,16,Vn),new Hn(8,16,32,32,Vn),new Hn(8,16,128,128,Vn),new Hn(8,32,128,256,Vn),new Hn(32,128,258,1024,Vn),new Hn(32,258,258,4096,Vn)];function qn(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=En,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Dn(this.dyn_ltree),Dn(this.dyn_dtree),Dn(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Dn(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Dn(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Gn=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==Pn&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==Tn&&t.status!==kn?1:0},Yn=e=>{if(Gn(e))return Sn(e,hn);e.total_in=e.total_out=0,e.data_type=bn;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?Pn:Tn,e.adler=2===t.wrap?0:1,t.last_flush=-2,Qt(t),un},Zn=e=>{const t=Yn(e);var n;return t===un&&((n=e.state).window_size=2*n.w_size,Dn(n.head),n.max_lazy_match=Wn[n.level].max_lazy,n.good_match=Wn[n.level].good_length,n.nice_match=Wn[n.level].nice_length,n.max_chain_length=Wn[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),t},Kn=(e,t,n,i,r,o)=>{if(!e)return hn;let s=1;if(t===_n&&(t=6),i<0?(s=0,i=-i):i>15&&(s=2,i-=16),r<1||r>9||n!==En||i<8||i>15||t<0||t>9||o<0||o>vn||8===i&&1!==s)return Sn(e,hn);8===i&&(i=9);const a=new qn;return e.state=a,a.strm=e,a.status=Pn,a.wrap=s,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=r+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<r+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=3*(a.lit_bufsize-1),a.level=t,a.strategy=o,a.method=n,Zn(e)};var $n={deflateInit:(e,t)=>Kn(e,t,En,15,8,wn),deflateInit2:Kn,deflateReset:Zn,deflateResetKeep:Yn,deflateSetHeader:(e,t)=>Gn(e)||2!==e.state.wrap?hn:(e.state.gzhead=t,un),deflate:(e,t)=>{if(Gn(e)||t>dn||t<0)return e?Sn(e,hn):hn;const n=e.state;if(!e.output||0!==e.avail_in&&!e.input||n.status===kn&&t!==ln)return Sn(e,0===e.avail_out?fn:hn);const i=n.last_flush;if(n.last_flush=t,0!==n.pending){if(In(e),0===e.avail_out)return n.last_flush=-1,un}else if(0===e.avail_in&&Cn(t)<=Cn(i)&&t!==ln)return Sn(e,fn);if(n.status===kn&&0!==e.avail_in)return Sn(e,fn);if(n.status===Pn&&0===n.wrap&&(n.status=Tn),n.status===Pn){let t=En+(n.w_bits-8<<4)<<8,i=-1;if(i=n.strategy>=yn||n.level<2?0:n.level<6?1:6===n.level?2:3,t|=i<<6,0!==n.strstart&&(t|=32),t+=31-t%31,Ln(n,t),0!==n.strstart&&(Ln(n,e.adler>>>16),Ln(n,65535&e.adler)),e.adler=1,n.status=Tn,In(e),0!==n.pending)return n.last_flush=-1,un}if(57===n.status)if(e.adler=0,On(n,31),On(n,139),On(n,8),n.gzhead)On(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),On(n,255&n.gzhead.time),On(n,n.gzhead.time>>8&255),On(n,n.gzhead.time>>16&255),On(n,n.gzhead.time>>24&255),On(n,9===n.level?2:n.strategy>=yn||n.level<2?4:0),On(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(On(n,255&n.gzhead.extra.length),On(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=$t(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(On(n,0),On(n,0),On(n,0),On(n,0),On(n,0),On(n,9===n.level?2:n.strategy>=yn||n.level<2?4:0),On(n,3),n.status=Tn,In(e),0!==n.pending)return n.last_flush=-1,un;if(69===n.status){if(n.gzhead.extra){let t=n.pending,i=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+i>n.pending_buf_size;){let r=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+r),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>t&&(e.adler=$t(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex+=r,In(e),0!==n.pending)return n.last_flush=-1,un;t=0,i-=r}let r=new Uint8Array(n.gzhead.extra);n.pending_buf.set(r.subarray(n.gzindex,n.gzindex+i),n.pending),n.pending+=i,n.gzhead.hcrc&&n.pending>t&&(e.adler=$t(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex=0}n.status=73}if(73===n.status){if(n.gzhead.name){let t,i=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>i&&(e.adler=$t(e.adler,n.pending_buf,n.pending-i,i)),In(e),0!==n.pending)return n.last_flush=-1,un;i=0}t=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,On(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>i&&(e.adler=$t(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex=0}n.status=91}if(91===n.status){if(n.gzhead.comment){let t,i=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>i&&(e.adler=$t(e.adler,n.pending_buf,n.pending-i,i)),In(e),0!==n.pending)return n.last_flush=-1,un;i=0}t=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,On(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>i&&(e.adler=$t(e.adler,n.pending_buf,n.pending-i,i))}n.status=103}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(In(e),0!==n.pending))return n.last_flush=-1,un;On(n,255&e.adler),On(n,e.adler>>8&255),e.adler=0}if(n.status=Tn,In(e),0!==n.pending)return n.last_flush=-1,un}if(0!==e.avail_in||0!==n.lookahead||t!==on&&n.status!==kn){let i=0===n.level?Un(n,t):n.strategy===yn?((e,t)=>{let n;for(;;){if(0===e.lookahead&&(jn(e),0===e.lookahead)){if(t===on)return 1;break}if(e.match_length=0,n=nn(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(Fn(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===ln?(Fn(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Fn(e,!1),0===e.strm.avail_out)?1:2})(n,t):n.strategy===mn?((e,t)=>{let n,i,r,o;const s=e.window;for(;;){if(e.lookahead<=An){if(jn(e),e.lookahead<=An&&t===on)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(r=e.strstart-1,i=s[r],i===s[++r]&&i===s[++r]&&i===s[++r])){o=e.strstart+An;do{}while(i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&r<o);e.match_length=An-(o-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=nn(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=nn(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(Fn(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===ln?(Fn(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Fn(e,!1),0===e.strm.avail_out)?1:2})(n,t):Wn[n.level].func(n,t);if(3!==i&&4!==i||(n.status=kn),1===i||3===i)return 0===e.avail_out&&(n.last_flush=-1),un;if(2===i&&(t===sn?rn(n):t!==dn&&(en(n,0,0,!1),t===an&&(Dn(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),In(e),0===e.avail_out))return n.last_flush=-1,un}return t!==ln?un:n.wrap<=0?cn:(2===n.wrap?(On(n,255&e.adler),On(n,e.adler>>8&255),On(n,e.adler>>16&255),On(n,e.adler>>24&255),On(n,255&e.total_in),On(n,e.total_in>>8&255),On(n,e.total_in>>16&255),On(n,e.total_in>>24&255)):(Ln(n,e.adler>>>16),Ln(n,65535&e.adler)),In(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?un:cn)},deflateEnd:e=>{if(Gn(e))return hn;const t=e.state.status;return e.state=null,t===Tn?Sn(e,pn):un},deflateSetDictionary:(e,t)=>{let n=t.length;if(Gn(e))return hn;const i=e.state,r=i.wrap;if(2===r||1===r&&i.status!==Pn||i.lookahead)return hn;if(1===r&&(e.adler=Zt(e.adler,t,n,0)),i.wrap=0,n>=i.w_size){0===r&&(Dn(i.head),i.strstart=0,i.block_start=0,i.insert=0);let e=new Uint8Array(i.w_size);e.set(t.subarray(n-i.w_size,n),0),t=e,n=i.w_size}const o=e.avail_in,s=e.next_in,a=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,jn(i);i.lookahead>=3;){let e=i.strstart,t=i.lookahead-2;do{i.ins_h=xn(i,i.ins_h,i.window[e+3-1]),i.prev[e&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=e,e++}while(--t);i.strstart=e,i.lookahead=2,jn(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,e.next_in=s,e.input=a,e.avail_in=o,i.wrap=r,un},deflateInfo:"pako deflate (from Nodeca project)"};const Xn=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Jn={assign:function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const t in n)Xn(n,t)&&(e[t]=n[t])}}return e},flattenChunks:e=>{let t=0;for(let n=0,i=e.length;n<i;n++)t+=e[n].length;const n=new Uint8Array(t);for(let t=0,i=0,r=e.length;t<r;t++){let r=e[t];n.set(r,i),i+=r.length}return n}};let Qn=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){Qn=!1}const ei=new Uint8Array(256);for(let e=0;e<256;e++)ei[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;ei[254]=ei[254]=1;var ti={string2buf:e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,n,i,r,o,s=e.length,a=0;for(r=0;r<s;r++)n=e.charCodeAt(r),55296==(64512&n)&&r+1<s&&(i=e.charCodeAt(r+1),56320==(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),r++)),a+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(a),o=0,r=0;o<a;r++)n=e.charCodeAt(r),55296==(64512&n)&&r+1<s&&(i=e.charCodeAt(r+1),56320==(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),r++)),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|63&n):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|63&n):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|63&n);return t},buf2string:(e,t)=>{const n=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let i,r;const o=new Array(2*n);for(r=0,i=0;i<n;){let t=e[i++];if(t<128){o[r++]=t;continue}let s=ei[t];if(s>4)o[r++]=65533,i+=s-1;else{for(t&=2===s?31:3===s?15:7;s>1&&i<n;)t=t<<6|63&e[i++],s--;s>1?o[r++]=65533:t<65536?o[r++]=t:(t-=65536,o[r++]=55296|t>>10&1023,o[r++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&Qn)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let i=0;i<t;i++)n+=String.fromCharCode(e[i]);return n})(o,r)},utf8border:(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let n=t-1;for(;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+ei[e[n]]>t?n:t}};var ni=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const ii=Object.prototype.toString,{Z_NO_FLUSH:ri,Z_SYNC_FLUSH:oi,Z_FULL_FLUSH:si,Z_FINISH:ai,Z_OK:li,Z_STREAM_END:di,Z_DEFAULT_COMPRESSION:ui,Z_DEFAULT_STRATEGY:ci,Z_DEFLATED:hi}=Jt;function pi(e){this.options=Jn.assign({level:ui,method:hi,chunkSize:16384,windowBits:15,memLevel:8,strategy:ci},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ni,this.strm.avail_out=0;let n=$n.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==li)throw new Error(Xt[n]);if(t.header&&$n.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?ti.string2buf(t.dictionary):"[object ArrayBuffer]"===ii.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,n=$n.deflateSetDictionary(this.strm,e),n!==li)throw new Error(Xt[n]);this._dict_set=!0}}function fi(e,t){const n=new pi(t);if(n.push(e,!0),n.err)throw n.msg||Xt[n.err];return n.result}pi.prototype.push=function(e,t){const n=this.strm,i=this.options.chunkSize;let r,o;if(this.ended)return!1;for(o=t===~~t?t:!0===t?ai:ri,"string"==typeof e?n.input=ti.string2buf(e):"[object ArrayBuffer]"===ii.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),(o===oi||o===si)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(r=$n.deflate(n,o),r===di)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),r=$n.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===li;if(0!==n.avail_out){if(o>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},pi.prototype.onData=function(e){this.chunks.push(e)},pi.prototype.onEnd=function(e){e===li&&(this.result=Jn.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var _i={Deflate:pi,deflate:fi,deflateRaw:function(e,t){return(t=t||{}).raw=!0,fi(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,fi(e,t)},constants:Jt};const gi=16209;var yi=function(e,t){let n,i,r,o,s,a,l,d,u,c,h,p,f,_,g,y,m,v,w,b,E,A,R,P;const T=e.state;n=e.next_in,R=e.input,i=n+(e.avail_in-5),r=e.next_out,P=e.output,o=r-(t-e.avail_out),s=r+(e.avail_out-257),a=T.dmax,l=T.wsize,d=T.whave,u=T.wnext,c=T.window,h=T.hold,p=T.bits,f=T.lencode,_=T.distcode,g=(1<<T.lenbits)-1,y=(1<<T.distbits)-1;e:do{p<15&&(h+=R[n++]<<p,p+=8,h+=R[n++]<<p,p+=8),m=f[h&g];t:for(;;){if(v=m>>>24,h>>>=v,p-=v,v=m>>>16&255,0===v)P[r++]=65535&m;else{if(!(16&v)){if(0==(64&v)){m=f[(65535&m)+(h&(1<<v)-1)];continue t}if(32&v){T.mode=16191;break e}e.msg="invalid literal/length code",T.mode=gi;break e}w=65535&m,v&=15,v&&(p<v&&(h+=R[n++]<<p,p+=8),w+=h&(1<<v)-1,h>>>=v,p-=v),p<15&&(h+=R[n++]<<p,p+=8,h+=R[n++]<<p,p+=8),m=_[h&y];n:for(;;){if(v=m>>>24,h>>>=v,p-=v,v=m>>>16&255,!(16&v)){if(0==(64&v)){m=_[(65535&m)+(h&(1<<v)-1)];continue n}e.msg="invalid distance code",T.mode=gi;break e}if(b=65535&m,v&=15,p<v&&(h+=R[n++]<<p,p+=8,p<v&&(h+=R[n++]<<p,p+=8)),b+=h&(1<<v)-1,b>a){e.msg="invalid distance too far back",T.mode=gi;break e}if(h>>>=v,p-=v,v=r-o,b>v){if(v=b-v,v>d&&T.sane){e.msg="invalid distance too far back",T.mode=gi;break e}if(E=0,A=c,0===u){if(E+=l-v,v<w){w-=v;do{P[r++]=c[E++]}while(--v);E=r-b,A=P}}else if(u<v){if(E+=l+u-v,v-=u,v<w){w-=v;do{P[r++]=c[E++]}while(--v);if(E=0,u<w){v=u,w-=v;do{P[r++]=c[E++]}while(--v);E=r-b,A=P}}}else if(E+=u-v,v<w){w-=v;do{P[r++]=c[E++]}while(--v);E=r-b,A=P}for(;w>2;)P[r++]=A[E++],P[r++]=A[E++],P[r++]=A[E++],w-=3;w&&(P[r++]=A[E++],w>1&&(P[r++]=A[E++]))}else{E=r-b;do{P[r++]=P[E++],P[r++]=P[E++],P[r++]=P[E++],w-=3}while(w>2);w&&(P[r++]=P[E++],w>1&&(P[r++]=P[E++]))}break}}break}}while(n<i&&r<s);w=p>>3,n-=w,p-=w<<3,h&=(1<<p)-1,e.next_in=n,e.next_out=r,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=r<s?s-r+257:257-(r-s),T.hold=h,T.bits=p};const mi=15,vi=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),wi=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),bi=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Ei=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Ai=(e,t,n,i,r,o,s,a)=>{const l=a.bits;let d,u,c,h,p,f,_=0,g=0,y=0,m=0,v=0,w=0,b=0,E=0,A=0,R=0,P=null;const T=new Uint16Array(16),k=new Uint16Array(16);let S,C,D,M=null;for(_=0;_<=mi;_++)T[_]=0;for(g=0;g<i;g++)T[t[n+g]]++;for(v=l,m=mi;m>=1&&0===T[m];m--);if(v>m&&(v=m),0===m)return r[o++]=20971520,r[o++]=20971520,a.bits=1,0;for(y=1;y<m&&0===T[y];y++);for(v<y&&(v=y),E=1,_=1;_<=mi;_++)if(E<<=1,E-=T[_],E<0)return-1;if(E>0&&(0===e||1!==m))return-1;for(k[1]=0,_=1;_<mi;_++)k[_+1]=k[_]+T[_];for(g=0;g<i;g++)0!==t[n+g]&&(s[k[t[n+g]]++]=g);if(0===e?(P=M=s,f=20):1===e?(P=vi,M=wi,f=257):(P=bi,M=Ei,f=0),R=0,g=0,_=y,p=o,w=v,b=0,c=-1,A=1<<v,h=A-1,1===e&&A>852||2===e&&A>592)return 1;for(;;){S=_-b,s[g]+1<f?(C=0,D=s[g]):s[g]>=f?(C=M[s[g]-f],D=P[s[g]-f]):(C=96,D=0),d=1<<_-b,u=1<<w,y=u;do{u-=d,r[p+(R>>b)+u]=S<<24|C<<16|D|0}while(0!==u);for(d=1<<_-1;R&d;)d>>=1;if(0!==d?(R&=d-1,R+=d):R=0,g++,0==--T[_]){if(_===m)break;_=t[n+s[g]]}if(_>v&&(R&h)!==c){for(0===b&&(b=v),p+=y,w=_-b,E=1<<w;w+b<m&&(E-=T[w+b],!(E<=0));)w++,E<<=1;if(A+=1<<w,1===e&&A>852||2===e&&A>592)return 1;c=R&h,r[c]=v<<24|w<<16|p-o|0}}return 0!==R&&(r[p+R]=_-b<<24|64<<16|0),a.bits=v,0};const{Z_FINISH:Ri,Z_BLOCK:Pi,Z_TREES:Ti,Z_OK:ki,Z_STREAM_END:Si,Z_NEED_DICT:Ci,Z_STREAM_ERROR:Di,Z_DATA_ERROR:Mi,Z_MEM_ERROR:xi,Z_BUF_ERROR:Ii,Z_DEFLATED:Fi}=Jt,Oi=16180,Li=16190,Ni=16191,Bi=16192,ji=16194,Ui=16199,zi=16200,Vi=16206,Hi=16209,Wi=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function qi(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Gi=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Oi||t.mode>16211?1:0},Yi=e=>{if(Gi(e))return Di;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=Oi,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,ki},Zi=e=>{if(Gi(e))return Di;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Yi(e)},Ki=(e,t)=>{let n;if(Gi(e))return Di;const i=e.state;return t<0?(n=0,t=-t):(n=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Di:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,Zi(e))},$i=(e,t)=>{if(!e)return Di;const n=new qi;e.state=n,n.strm=e,n.window=null,n.mode=Oi;const i=Ki(e,t);return i!==ki&&(e.state=null),i};let Xi,Ji,Qi=!0;const er=e=>{if(Qi){Xi=new Int32Array(512),Ji=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Ai(1,e.lens,0,288,Xi,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Ai(2,e.lens,0,32,Ji,0,e.work,{bits:5}),Qi=!1}e.lencode=Xi,e.lenbits=9,e.distcode=Ji,e.distbits=5},tr=(e,t,n,i)=>{let r;const o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),i>=o.wsize?(o.window.set(t.subarray(n-o.wsize,n),0),o.wnext=0,o.whave=o.wsize):(r=o.wsize-o.wnext,r>i&&(r=i),o.window.set(t.subarray(n-i,n-i+r),o.wnext),(i-=r)?(o.window.set(t.subarray(n-i,n),0),o.wnext=i,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0};var nr={inflateReset:Zi,inflateReset2:Ki,inflateResetKeep:Yi,inflateInit:e=>$i(e,15),inflateInit2:$i,inflate:(e,t)=>{let n,i,r,o,s,a,l,d,u,c,h,p,f,_,g,y,m,v,w,b,E,A,R=0;const P=new Uint8Array(4);let T,k;const S=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Gi(e)||!e.output||!e.input&&0!==e.avail_in)return Di;n=e.state,n.mode===Ni&&(n.mode=Bi),s=e.next_out,r=e.output,l=e.avail_out,o=e.next_in,i=e.input,a=e.avail_in,d=n.hold,u=n.bits,c=a,h=l,A=ki;e:for(;;)switch(n.mode){case Oi:if(0===n.wrap){n.mode=Bi;break}for(;u<16;){if(0===a)break e;a--,d+=i[o++]<<u,u+=8}if(2&n.wrap&&35615===d){0===n.wbits&&(n.wbits=15),n.check=0,P[0]=255&d,P[1]=d>>>8&255,n.check=$t(n.check,P,2,0),d=0,u=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&d)<<8)+(d>>8))%31){e.msg="incorrect header check",n.mode=Hi;break}if((15&d)!==Fi){e.msg="unknown compression method",n.mode=Hi;break}if(d>>>=4,u-=4,E=8+(15&d),0===n.wbits&&(n.wbits=E),E>15||E>n.wbits){e.msg="invalid window size",n.mode=Hi;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=512&d?16189:Ni,d=0,u=0;break;case 16181:for(;u<16;){if(0===a)break e;a--,d+=i[o++]<<u,u+=8}if(n.flags=d,(255&n.flags)!==Fi){e.msg="unknown compression method",n.mode=Hi;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=Hi;break}n.head&&(n.head.text=d>>8&1),512&n.flags&&4&n.wrap&&(P[0]=255&d,P[1]=d>>>8&255,n.check=$t(n.check,P,2,0)),d=0,u=0,n.mode=16182;case 16182:for(;u<32;){if(0===a)break e;a--,d+=i[o++]<<u,u+=8}n.head&&(n.head.time=d),512&n.flags&&4&n.wrap&&(P[0]=255&d,P[1]=d>>>8&255,P[2]=d>>>16&255,P[3]=d>>>24&255,n.check=$t(n.check,P,4,0)),d=0,u=0,n.mode=16183;case 16183:for(;u<16;){if(0===a)break e;a--,d+=i[o++]<<u,u+=8}n.head&&(n.head.xflags=255&d,n.head.os=d>>8),512&n.flags&&4&n.wrap&&(P[0]=255&d,P[1]=d>>>8&255,n.check=$t(n.check,P,2,0)),d=0,u=0,n.mode=16184;case 16184:if(1024&n.flags){for(;u<16;){if(0===a)break e;a--,d+=i[o++]<<u,u+=8}n.length=d,n.head&&(n.head.extra_len=d),512&n.flags&&4&n.wrap&&(P[0]=255&d,P[1]=d>>>8&255,n.check=$t(n.check,P,2,0)),d=0,u=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&(p=n.length,p>a&&(p=a),p&&(n.head&&(E=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(i.subarray(o,o+p),E)),512&n.flags&&4&n.wrap&&(n.check=$t(n.check,i,p,o)),a-=p,o+=p,n.length-=p),n.length))break e;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(0===a)break e;p=0;do{E=i[o+p++],n.head&&E&&n.length<65536&&(n.head.name+=String.fromCharCode(E))}while(E&&p<a);if(512&n.flags&&4&n.wrap&&(n.check=$t(n.check,i,p,o)),a-=p,o+=p,E)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(0===a)break e;p=0;do{E=i[o+p++],n.head&&E&&n.length<65536&&(n.head.comment+=String.fromCharCode(E))}while(E&&p<a);if(512&n.flags&&4&n.wrap&&(n.check=$t(n.check,i,p,o)),a-=p,o+=p,E)break e}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;u<16;){if(0===a)break e;a--,d+=i[o++]<<u,u+=8}if(4&n.wrap&&d!==(65535&n.check)){e.msg="header crc mismatch",n.mode=Hi;break}d=0,u=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=Ni;break;case 16189:for(;u<32;){if(0===a)break e;a--,d+=i[o++]<<u,u+=8}e.adler=n.check=Wi(d),d=0,u=0,n.mode=Li;case Li:if(0===n.havedict)return e.next_out=s,e.avail_out=l,e.next_in=o,e.avail_in=a,n.hold=d,n.bits=u,Ci;e.adler=n.check=1,n.mode=Ni;case Ni:if(t===Pi||t===Ti)break e;case Bi:if(n.last){d>>>=7&u,u-=7&u,n.mode=Vi;break}for(;u<3;){if(0===a)break e;a--,d+=i[o++]<<u,u+=8}switch(n.last=1&d,d>>>=1,u-=1,3&d){case 0:n.mode=16193;break;case 1:if(er(n),n.mode=Ui,t===Ti){d>>>=2,u-=2;break e}break;case 2:n.mode=16196;break;case 3:e.msg="invalid block type",n.mode=Hi}d>>>=2,u-=2;break;case 16193:for(d>>>=7&u,u-=7&u;u<32;){if(0===a)break e;a--,d+=i[o++]<<u,u+=8}if((65535&d)!=(d>>>16^65535)){e.msg="invalid stored block lengths",n.mode=Hi;break}if(n.length=65535&d,d=0,u=0,n.mode=ji,t===Ti)break e;case ji:n.mode=16195;case 16195:if(p=n.length,p){if(p>a&&(p=a),p>l&&(p=l),0===p)break e;r.set(i.subarray(o,o+p),s),a-=p,o+=p,l-=p,s+=p,n.length-=p;break}n.mode=Ni;break;case 16196:for(;u<14;){if(0===a)break e;a--,d+=i[o++]<<u,u+=8}if(n.nlen=257+(31&d),d>>>=5,u-=5,n.ndist=1+(31&d),d>>>=5,u-=5,n.ncode=4+(15&d),d>>>=4,u-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=Hi;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;u<3;){if(0===a)break e;a--,d+=i[o++]<<u,u+=8}n.lens[S[n.have++]]=7&d,d>>>=3,u-=3}for(;n.have<19;)n.lens[S[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,T={bits:n.lenbits},A=Ai(0,n.lens,0,19,n.lencode,0,n.work,T),n.lenbits=T.bits,A){e.msg="invalid code lengths set",n.mode=Hi;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;R=n.lencode[d&(1<<n.lenbits)-1],g=R>>>24,y=R>>>16&255,m=65535&R,!(g<=u);){if(0===a)break e;a--,d+=i[o++]<<u,u+=8}if(m<16)d>>>=g,u-=g,n.lens[n.have++]=m;else{if(16===m){for(k=g+2;u<k;){if(0===a)break e;a--,d+=i[o++]<<u,u+=8}if(d>>>=g,u-=g,0===n.have){e.msg="invalid bit length repeat",n.mode=Hi;break}E=n.lens[n.have-1],p=3+(3&d),d>>>=2,u-=2}else if(17===m){for(k=g+3;u<k;){if(0===a)break e;a--,d+=i[o++]<<u,u+=8}d>>>=g,u-=g,E=0,p=3+(7&d),d>>>=3,u-=3}else{for(k=g+7;u<k;){if(0===a)break e;a--,d+=i[o++]<<u,u+=8}d>>>=g,u-=g,E=0,p=11+(127&d),d>>>=7,u-=7}if(n.have+p>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=Hi;break}for(;p--;)n.lens[n.have++]=E}}if(n.mode===Hi)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=Hi;break}if(n.lenbits=9,T={bits:n.lenbits},A=Ai(1,n.lens,0,n.nlen,n.lencode,0,n.work,T),n.lenbits=T.bits,A){e.msg="invalid literal/lengths set",n.mode=Hi;break}if(n.distbits=6,n.distcode=n.distdyn,T={bits:n.distbits},A=Ai(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,T),n.distbits=T.bits,A){e.msg="invalid distances set",n.mode=Hi;break}if(n.mode=Ui,t===Ti)break e;case Ui:n.mode=zi;case zi:if(a>=6&&l>=258){e.next_out=s,e.avail_out=l,e.next_in=o,e.avail_in=a,n.hold=d,n.bits=u,yi(e,h),s=e.next_out,r=e.output,l=e.avail_out,o=e.next_in,i=e.input,a=e.avail_in,d=n.hold,u=n.bits,n.mode===Ni&&(n.back=-1);break}for(n.back=0;R=n.lencode[d&(1<<n.lenbits)-1],g=R>>>24,y=R>>>16&255,m=65535&R,!(g<=u);){if(0===a)break e;a--,d+=i[o++]<<u,u+=8}if(y&&0==(240&y)){for(v=g,w=y,b=m;R=n.lencode[b+((d&(1<<v+w)-1)>>v)],g=R>>>24,y=R>>>16&255,m=65535&R,!(v+g<=u);){if(0===a)break e;a--,d+=i[o++]<<u,u+=8}d>>>=v,u-=v,n.back+=v}if(d>>>=g,u-=g,n.back+=g,n.length=m,0===y){n.mode=16205;break}if(32&y){n.back=-1,n.mode=Ni;break}if(64&y){e.msg="invalid literal/length code",n.mode=Hi;break}n.extra=15&y,n.mode=16201;case 16201:if(n.extra){for(k=n.extra;u<k;){if(0===a)break e;a--,d+=i[o++]<<u,u+=8}n.length+=d&(1<<n.extra)-1,d>>>=n.extra,u-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;R=n.distcode[d&(1<<n.distbits)-1],g=R>>>24,y=R>>>16&255,m=65535&R,!(g<=u);){if(0===a)break e;a--,d+=i[o++]<<u,u+=8}if(0==(240&y)){for(v=g,w=y,b=m;R=n.distcode[b+((d&(1<<v+w)-1)>>v)],g=R>>>24,y=R>>>16&255,m=65535&R,!(v+g<=u);){if(0===a)break e;a--,d+=i[o++]<<u,u+=8}d>>>=v,u-=v,n.back+=v}if(d>>>=g,u-=g,n.back+=g,64&y){e.msg="invalid distance code",n.mode=Hi;break}n.offset=m,n.extra=15&y,n.mode=16203;case 16203:if(n.extra){for(k=n.extra;u<k;){if(0===a)break e;a--,d+=i[o++]<<u,u+=8}n.offset+=d&(1<<n.extra)-1,d>>>=n.extra,u-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=Hi;break}n.mode=16204;case 16204:if(0===l)break e;if(p=h-l,n.offset>p){if(p=n.offset-p,p>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=Hi;break}p>n.wnext?(p-=n.wnext,f=n.wsize-p):f=n.wnext-p,p>n.length&&(p=n.length),_=n.window}else _=r,f=s-n.offset,p=n.length;p>l&&(p=l),l-=p,n.length-=p;do{r[s++]=_[f++]}while(--p);0===n.length&&(n.mode=zi);break;case 16205:if(0===l)break e;r[s++]=n.length,l--,n.mode=zi;break;case Vi:if(n.wrap){for(;u<32;){if(0===a)break e;a--,d|=i[o++]<<u,u+=8}if(h-=l,e.total_out+=h,n.total+=h,4&n.wrap&&h&&(e.adler=n.check=n.flags?$t(n.check,r,h,s-h):Zt(n.check,r,h,s-h)),h=l,4&n.wrap&&(n.flags?d:Wi(d))!==n.check){e.msg="incorrect data check",n.mode=Hi;break}d=0,u=0}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;u<32;){if(0===a)break e;a--,d+=i[o++]<<u,u+=8}if(4&n.wrap&&d!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=Hi;break}d=0,u=0}n.mode=16208;case 16208:A=Si;break e;case Hi:A=Mi;break e;case 16210:return xi;default:return Di}return e.next_out=s,e.avail_out=l,e.next_in=o,e.avail_in=a,n.hold=d,n.bits=u,(n.wsize||h!==e.avail_out&&n.mode<Hi&&(n.mode<Vi||t!==Ri))&&tr(e,e.output,e.next_out,h-e.avail_out),c-=e.avail_in,h-=e.avail_out,e.total_in+=c,e.total_out+=h,n.total+=h,4&n.wrap&&h&&(e.adler=n.check=n.flags?$t(n.check,r,h,e.next_out-h):Zt(n.check,r,h,e.next_out-h)),e.data_type=n.bits+(n.last?64:0)+(n.mode===Ni?128:0)+(n.mode===Ui||n.mode===ji?256:0),(0===c&&0===h||t===Ri)&&A===ki&&(A=Ii),A},inflateEnd:e=>{if(Gi(e))return Di;let t=e.state;return t.window&&(t.window=null),e.state=null,ki},inflateGetHeader:(e,t)=>{if(Gi(e))return Di;const n=e.state;return 0==(2&n.wrap)?Di:(n.head=t,t.done=!1,ki)},inflateSetDictionary:(e,t)=>{const n=t.length;let i,r,o;return Gi(e)?Di:(i=e.state,0!==i.wrap&&i.mode!==Li?Di:i.mode===Li&&(r=1,r=Zt(r,t,n,0),r!==i.check)?Mi:(o=tr(e,t,n,n),o?(i.mode=16210,xi):(i.havedict=1,ki)))},inflateInfo:"pako inflate (from Nodeca project)"};var ir=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const rr=Object.prototype.toString,{Z_NO_FLUSH:or,Z_FINISH:sr,Z_OK:ar,Z_STREAM_END:lr,Z_NEED_DICT:dr,Z_STREAM_ERROR:ur,Z_DATA_ERROR:cr,Z_MEM_ERROR:hr}=Jt;function pr(e){this.options=Jn.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ni,this.strm.avail_out=0;let n=nr.inflateInit2(this.strm,t.windowBits);if(n!==ar)throw new Error(Xt[n]);if(this.header=new ir,nr.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=ti.string2buf(t.dictionary):"[object ArrayBuffer]"===rr.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=nr.inflateSetDictionary(this.strm,t.dictionary),n!==ar)))throw new Error(Xt[n])}function fr(e,t){const n=new pr(t);if(n.push(e),n.err)throw n.msg||Xt[n.err];return n.result}pr.prototype.push=function(e,t){const n=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let o,s,a;if(this.ended)return!1;for(s=t===~~t?t:!0===t?sr:or,"[object ArrayBuffer]"===rr.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),o=nr.inflate(n,s),o===dr&&r&&(o=nr.inflateSetDictionary(n,r),o===ar?o=nr.inflate(n,s):o===cr&&(o=dr));n.avail_in>0&&o===lr&&n.state.wrap>0&&0!==e[n.next_in];)nr.inflateReset(n),o=nr.inflate(n,s);switch(o){case ur:case cr:case dr:case hr:return this.onEnd(o),this.ended=!0,!1}if(a=n.avail_out,n.next_out&&(0===n.avail_out||o===lr))if("string"===this.options.to){let e=ti.utf8border(n.output,n.next_out),t=n.next_out-e,r=ti.buf2string(n.output,e);n.next_out=t,n.avail_out=i-t,t&&n.output.set(n.output.subarray(e,e+t),0),this.onData(r)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(o!==ar||0!==a){if(o===lr)return o=nr.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},pr.prototype.onData=function(e){this.chunks.push(e)},pr.prototype.onEnd=function(e){e===ar&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Jn.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var _r={Inflate:pr,inflate:fr,inflateRaw:function(e,t){return(t=t||{}).raw=!0,fr(e,t)},ungzip:fr,constants:Jt};const{Deflate:gr,deflate:yr,deflateRaw:mr,gzip:vr}=_i,{Inflate:wr,inflate:br,inflateRaw:Er,ungzip:Ar}=_r;var Rr={Deflate:gr,deflate:yr,deflateRaw:mr,gzip:vr,Inflate:wr,inflate:br,inflateRaw:Er,ungzip:Ar,constants:Jt};const Pr=n.p+"asset/767e8a3ee282f679ec7c.gz",Tr=n.p+"asset/f48e1e55f206f96e2078.js";var kr=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};const Sr="promise aborted";class Cr{constructor(){this._map=new Map}get(e){let t=this._map.get(e);return t||(this._map.set(e,new Dr),t=this._map.get(e)),t}reset(){this._map.forEach((e=>{e.reset()})),this._map=new Map}}class Dr{constructor(){this._list=[]}add(...e){this._list.push(...e)}reset(){this._list.forEach((e=>{e.abort(Sr)})),this._list=[]}all(){return kr(this,void 0,void 0,(function*(){const e=[];this._list.forEach((t=>{e.push(t.promise)})),yield Promise.all(e),this._list=[]}))}}class Mr{constructor(e){const t=new Promise(e),n=new Promise(((e,t)=>{this._abort=t}));this._promise=Promise.race([t,n])}get promise(){return this._promise}abort(e){this._abort(e)}}var xr,Ir=n(204);!function(e){e.DECODER="decoder",e.LOADER="loader",e.RENDER="render",e.EVENT_EMITTER="playerEventEmitter",e.DATA_MANAGER="dataManager",e.LOGGER_MANAGER="logger",e.ERROR_HANDLER="errorHandler",e.PLAYER_CONTROLLER="playerController",e.QUALITY_STATISTIC="qualityStatistic"}(xr||(xr={}));class Fr{static getBrowser(){var e,t={},n=navigator.userAgent.toLowerCase();return(e=n.match(/msie ([\d.]+)/))?t.ie=e[1]:(e=n.match(/firefox\/([\d.]+)/))?t.firefox=e[1]:(e=n.match(/chrome\/([\d.]+)/))?t.chrome=e[1]:(e=n.match(/opera.([\d.]+)/))?t.opera=e[1]:(e=n.match(/version\/([\d.]+).*safari/))&&(t.safari=e[1]),t.ie?"ie":t.firefox?"firefox":t.chrome?"chrome":t.opera?"opera":t.safari?"safari":"unknown"}static change2fullPath(e){const t=document.createElement("A");return t.href=e,e=t.href}static deepClone(e){return JSON.parse(JSON.stringify(e))}static wait(e){return new Promise((t=>{setTimeout((()=>t()),e)}))}static isFlvMediaSource(e){if(""===e)return!1;e=Fr.change2fullPath(e);return new URL(e).pathname.endsWith("flv")}}class Or{constructor(e){this._info={frameWidth:0,frameHeight:0,frameRate:0,sampleRate:0,channelCount:0,formatName:"",videoCodecName:"",audioCodecName:"",duration:-1},e&&(this._info=Object.assign(Object.assign({},this._info),e))}equal(e){return this.frameWidth===e.frameWidth&&this.frameHeight===e.frameHeight&&this.frameRate===e.frameRate&&this.sampleRate===e.sampleRate&&this.channelCount===e.channelCount&&this.formatName===e.formatName&&this.videoCodecName===e.videoCodecName&&this.audioCodecName===e.audioCodecName&&this.duration===e.duration}get noAudioInfo(){return Object.assign(Object.assign({},this.info),{channelCount:0,sampleRate:0,audioCodecName:""})}get noVideoInfo(){return Object.assign(Object.assign({},this.info),{frameWidth:0,frameHeight:0,videoCodecName:""})}get info(){return Fr.deepClone(this._info)}get sampleRate(){return this._info.sampleRate}get frameHeight(){return this._info.frameHeight}get frameWidth(){return this._info.frameWidth}get duration(){return this._info.duration}get channelCount(){return this._info.channelCount}get noVideo(){return this._info.frameHeight<=0||this._info.frameWidth<=0}get noAudio(){return this._info.sampleRate<=0||this._info.channelCount<=0}get videoCodecName(){return this._info.videoCodecName}get audioCodecName(){return this._info.audioCodecName}get formatName(){return this._info.formatName}get frameRate(){return this._info.frameRate}validate(){return this.sampleRate>=3e3&&this.sampleRate<=768e3&&this.channelCount>0||this.frameWidth>0&&this.frameHeight>0}toString(){return`media info: ${JSON.stringify(this.info,null,2)} noVideo=${this.noVideo}, noAudio=${this.noAudio}`}}class Lr{static _getLeftPCMBuffer(e){const t=new Int32Array(Math.floor(e.length/2));for(let n=0;n<e.length;n+=2)t[Math.floor(n/2)]=e[n];return t}static _getRightPCMBuffer(e){const t=new Int32Array(Math.floor(e.length/2));for(let n=1;n<e.length;n+=2)t[Math.floor(n/2)]=e[n];return t}static PCMToIEEEFloat(e){const t=new Float32Array(e.length);for(let n=0;n<e.length;n++){const i=e[n];t[n]=i<0?i/2147483648:i/2147483647}return t}static getLeftChannelData(e){const t=this._getLeftPCMBuffer(e);return this.PCMToIEEEFloat(t)}static getRightChannelData(e){const t=this._getRightPCMBuffer(e);return this.PCMToIEEEFloat(t)}}class Nr{update(e){this._model=Object.assign(Object.assign({},this._model),e)}getModel(){return Object.assign({},this._model)}}let Br=e=>crypto.getRandomValues(new Uint8Array(e)),jr=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+=(t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_"),"");const Ur="1.0.0";var zr=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Vr=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Hr=class{constructor(){this._model=new Nr;const e={appid:0,version:Ur,instanceid:jr(6),advanceConfig:{videoPausedSeiNeeded:!1}};this._model.update(e)}setConfig(e){this._model.update(e)}get appid(){return this._model.getModel().appid}get version(){return this._model.getModel().version}get instanceid(){return this._model.getModel().instanceid}get advanceConfig(){return this._model.getModel().advanceConfig}};Hr=zr([nt(),Vr("design:paramtypes",[])],Hr);const Wr="__ZegoError___";class qr extends Error{constructor(e){super(JSON.stringify(e)),this.name=Wr}}function Gr(e,t){return{code:t.code,msg:t.msg+": "+e}}const Yr={code:100001,msg:"InputParamError"},Zr={code:100002,msg:"EnvironmentError"},Kr={code:100003,msg:"RuntimeError"},$r={code:100004,msg:"NetworkError"},Xr={code:100005,msg:"DecodeError"},Jr={code:100006,msg:"AutoPlayError"};class Qr extends Error{constructor(e){super(JSON.stringify(Gr(e,Yr)))}}class eo extends Error{constructor(e){super(JSON.stringify(Gr(e,Zr)))}}class to extends qr{constructor(e){super(Gr(e,Kr))}}class no extends qr{constructor(e){super(Gr(e,$r))}}class io extends qr{constructor(e){super(Gr(e,Xr))}}class ro extends qr{constructor(e){super(Gr(e,Jr))}}class oo{constructor(e){if(e.min>e.max)throw new to("illegal value!");this._min=e.min,this._max=e.max}get max(){return this._max}get min(){return this._min}contain(e){return e>=this._min&&e<=this._max}onLeft(e){return e<this._min}onRight(e){return e>this._max}}class so{constructor(e){this._param=e,this._error=!1,this._negate=!1}static bind(e){return new so(e)}static expect(e){return new so(e)}_verify(e){let t=e();return t=this._negate?!t:t,t||(this._error=!0),this._negate=!1,this}get is(){return this}get not(){return this._negate=!this._negate,this}get true(){return this._verify((()=>"boolean"==typeof this._param&&!0===this._param))}get false(){return this._verify((()=>"boolean"==typeof this._param&&!1===this._param))}get exist(){return this._verify((()=>void 0!==this._param&&null!==this._param))}then(e){return this._param=e,this}oneOf(e){return this._verify((()=>e.some((e=>e===this._param))))}keyof(e){return this._verify((()=>("object"==typeof e||"function"==typeof e)&&e.hasOwnProperty(this._param)))}hasKey(e){return this._verify((()=>("object"==typeof this._param||"function"==typeof this._param)&&(this._param.hasOwnProperty(e)||void 0!==this._param[e])))}verify(e){return this._verify((()=>e(this._param)))}equal(e){return this._verify((()=>this._param===e))}eq(e){return this.equal(e)}typeof(e){return this._verify((()=>typeof this._param===e))}range([e,t]){return this._verify((()=>"number"==typeof this._param&&new oo({min:e,max:t}).contain(this._param)))}contain(e){return this._verify((()=>"number"==typeof this._param&&e.contain(this._param)))}instanceof(e){return this._verify((()=>this._param instanceof e))}catch(e){return e&&this._error&&e(),this._error=!1,this}}const ao="_action_";function lo(e,t){const n=()=>!t||void 0===t.callInfo||t.callInfo;return function(...t){const[i,r,o]=t;if(o){const t=o.value;return o.value=function(){const r=Reflect.getMetadata(ao,i.constructor),o=this.logger,s=o.action;so.bind(r).is.exist.not.eq("").catch((()=>{throw new to(`class ${i.constructor.name} don't have an action.`)})),so.bind(o).is.exist.catch((()=>{throw new to(`class ${i.constructor.name} is missing the attribute 'logger'.`)})),o.action="zep."+r+"."+e;const a=[];for(let e=0;e<arguments.length;e++)"function"==typeof arguments[e]&&a.push("[func]"),"object"==typeof arguments[e]&&a.push("[obj]"),"function"!=typeof arguments[e]&&"object"!=typeof arguments[e]&&a.push(arguments[e]);let l,d="call";0!==a.length&&(d+=", args:[ "+a.join(", ")+" ]"),n()&&o.info(d);try{l=t.apply(this,arguments),l instanceof Promise?l.then((()=>{o.action="zep."+r+"."+e,n(),o.action=s})):n()}catch(e){throw o.action=s,e}return o.action=s,l},o}Reflect.defineMetadata(ao,e,i)}}class uo{constructor(e,t,n){this._metainfo=e,this._action=t,this._logCache=n}get _prefix(){return`${this._action} ${this._metainfo} `}get _log(){return this._logCache}set metainfo(e){this._metainfo=e}get metainfo(){return this._metainfo}set action(e){this._action=e}get action(){return this._action}getSubAction(e){return this.action+"."+e}sub(e){return new uo(this.metainfo,this.getSubAction(e),this._log)}info(...e){this._log.add("info",[this._prefix,...e])}warn(...e){this._log.add("warn",[this._prefix,...e])}error(...e){this._log.add("error",[this._prefix,...e])}}class co{constructor(){this._MAX_CACHE=10240,this._cache=[]}setLogger(e){this._logger=e}add(e,t){this._cache.length<this._MAX_CACHE&&this._cache.push({type:e,args:t}),this._clear()}_log(e){switch(e.type){case"info":this._logger&&this._logger.info(...e.args);break;case"warn":this._logger&&this._logger.warn(...e.args);break;case"error":this._logger&&this._logger.error(...e.args)}}_clear(){this._logger&&(this._cache.forEach((e=>{this._log(e)})),this._cache=[])}}var ho=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},po=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},fo=function(e,t){return function(n,i){t(n,i,e)}};let _o=class{constructor(e){this._configState=e,this._logCache=new co}get metainfo(){return`p#${this._configState.instanceid}#${this._configState.version}`}get logger(){return this._logger}classLogger(e){const t=Reflect.getMetadata(ao,e);return new uo(this.metainfo,"zep."+t,this._logCache)}setZegoLogger(e){this._logCache.setLogger(e)}postMessage(e){}onmessage(e){const{type:t,data:n}=e;switch(t){case"workerlog":{const{level:e,action:t,args:i}=n,r=()=>`${t} ${this.metainfo} `;"info"===e?this._logCache.add("info",[r(),...i]):"warn"===e?this._logCache.add("warn",[r(),...i]):"error"===e&&this._logCache.add("error",[r(),...i]);break}default:this._logCache.add("error",[`zep.0.err ${this.metainfo} `,"unknown msg type: ",e.type])}}terminate(){}};_o=ho([nt(),fo(0,dt(Hr)),po("design:paramtypes",[Hr])],_o);var go,yo,mo=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},vo=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},wo=function(e,t){return function(n,i){t(n,i,e)}};!function(e){e.MEDIA_CAN_PLAY="canplay",e.MEDIA_PLAYED="played",e.MEDIA_PAUSED="paused",e.MEDIA_LOADED="loaded",e.CURRENT_TIME_CHANGE="currentTimeChanged",e.MEDIA_PLAY_ENDED="ended",e.MEDIA_PLAY_WAITING="waiting",e.MEDIA_PLAYING="playing",e.ERROR="ERROR",e.MEDIA_INFO_UPDATE="mediaInfoUpdate",e.RECV_SEI="recvSEI"}(yo||(yo={}));let bo=go=class extends Ir{constructor(e){super(),this._loggerManager=e,this.logger=this._loggerManager.classLogger(go)}onmessage(e){if(e.type===lt.PLAYER_EVENT_EMIT)this.logger.info("msg: ",e.type),this.emit(e.data.eventName,...e.data.args);else this.logger.error("unknown msg type: ",e.type)}postMessage(e){}terminate(){this.removeAllListeners()}};bo=go=mo([nt(),lo("0.peve"),wo(0,dt(_o)),vo("design:paramtypes",[_o])],bo);var Eo=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Ao=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Ro=class{_checkPlayedEvent(){!this._playedEvent&&this.audioDeviceReady&&this.played&&this.mediaOpened&&(this._playerEmitter.emit(yo.MEDIA_PLAYED),this._playedEvent=!0)}constructor(){this._model=new Nr,this._playedEvent=!1;const e={taskID:0,url:"",mediaInfo:new Or,isPlay:!1,loaded:!1,volume:100,currentTime:0,decodeEnded:!1,mediaPlayEnded:!1,muted:!1,waiting:!1,destroy:!1,mediaOpened:!1,audioDeviceReady:!1};this._model.update(e)}set mediaPlayEnded(e){const t=e&&!this.mediaPlayEnded;this._model.update({mediaPlayEnded:e}),t&&this._playerEmitter.emit(yo.MEDIA_PLAY_ENDED)}get mediaPlayEnded(){return this._model.getModel().mediaPlayEnded}set audioDeviceReady(e){this._model.update({audioDeviceReady:e}),this._checkPlayedEvent()}get audioDeviceReady(){return this._model.getModel().audioDeviceReady}set decodeEnded(e){this._model.update({decodeEnded:e})}get decodeEnded(){return this._model.getModel().decodeEnded}set url(e){this.loaded=!1,this.decodeEnded=!1,this.mediaPlayEnded=!1,this.mediaInfo=new Or,this.mediaOpened=!1,this.url!==e&&(this.currentTime=0,this.waiting=!1),this._model.update({url:e}),this._playedEvent=!1}get url(){return this._model.getModel().url}set mediaOpened(e){e&&!this.mediaOpened&&(this._playerEmitter.emit(yo.MEDIA_CAN_PLAY),this._checkPlayedEvent()),this._model.update({mediaOpened:e})}get mediaOpened(){return this._model.getModel().mediaOpened}set played(e){this._model.update({isPlay:e}),this._checkPlayedEvent()}get played(){return this._model.getModel().isPlay}set paused(e){const t=e&&!this.paused;this._model.update({isPlay:!e}),t&&(this._playedEvent=!1),t&&this._playerEmitter.emit(yo.MEDIA_PAUSED)}get paused(){return!this._model.getModel().isPlay}set volume(e){this._model.update({volume:e})}get volume(){return this._model.getModel().volume}set currentTime(e){(e=Number(e.toFixed(2)))>=0&&e!==this.currentTime&&(this.mediaInfo.duration<0||e<=this.mediaInfo.duration)&&(this._model.update({currentTime:e}),this._playerEmitter.emit(yo.CURRENT_TIME_CHANGE))}get currentTime(){return this._model.getModel().currentTime}set loaded(e){const t=e&&!this.loaded;this._model.update({loaded:e}),t&&this._playerEmitter.emit(yo.MEDIA_LOADED)}get loaded(){return this._model.getModel().loaded}set mediaInfo(e){this._model.update({mediaInfo:e}),e.validate()&&(this.mediaInfo.noAudio?this._playerEmitter.emit(yo.MEDIA_INFO_UPDATE,this.mediaInfo.noAudioInfo):this.mediaInfo.noVideo?this._playerEmitter.emit(yo.MEDIA_INFO_UPDATE,this.mediaInfo.noVideoInfo):this._playerEmitter.emit(yo.MEDIA_INFO_UPDATE,this.mediaInfo.info))}get mediaInfo(){return this._model.getModel().mediaInfo}get duration(){return this._model.getModel().mediaInfo.duration}set muted(e){this._model.update({muted:e})}get muted(){return this._model.getModel().muted}set waiting(e){const t=e&&!this.waiting&&this.played;e?(this._model.update({waiting:e}),t&&this._playerEmitter.emit(yo.MEDIA_PLAY_WAITING)):this.playing=!e}get waiting(){return this._model.getModel().waiting}set playing(e){const t=e&&!this.playing;e?(this._model.update({waiting:!e}),t&&!this.mediaPlayEnded&&this._playerEmitter.emit(yo.MEDIA_PLAYING)):this.waiting=!e}get playing(){return!this._model.getModel().waiting}set destroy(e){this._model.update({destroy:e})}get destroy(){return this._model.getModel().destroy}set taskID(e){this._model.update({taskID:e})}get taskID(){return this._model.getModel().taskID}};Eo([dt(bo),Ao("design:type",bo)],Ro.prototype,"_playerEmitter",void 0),Ro=Eo([nt(),Ao("design:paramtypes",[])],Ro);var Po,To,ko,So=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Co=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Do=function(e,t){return function(n,i){t(n,i,e)}};!function(e){e.UPDATE_MODEL="updateModel"}(To||(To={})),function(e){e.PLAYER_STATE="playerState",e.CONFIG_STATE="configState"}(ko||(ko={}));let Mo=Po=class{constructor(e,t,n){this._playerState=e,this._configState=t,this._logManager=n,this.logger=this._logManager.classLogger(Po)}_setProp(e,t,n){e[t]=n}_updatePlayerState(e){for(const t of Object.keys(e)){const n=t,i=e[n];void 0!==i&&this._setProp(this._playerState,n,i)}}_updateConfigState(e){for(const t of Object.keys(e)){const n=t,i=e[n];void 0!==i&&this._setProp(this._configState,n,i)}}_updateModel(e,t){switch(e){case ko.PLAYER_STATE:this.logger.info("update player state",t),this._updatePlayerState(t);break;case ko.CONFIG_STATE:this.logger.info("update config state",t),this._updateConfigState(t);break;default:this.logger.error("unknown model name: ",e)}}postMessage(e){}onmessage(e){switch(e.type){case To.UPDATE_MODEL:{const{modelName:t,model:n}=e.data;this._updateModel(t,n);break}default:this.logger.error("unknown msg type: ",e.type)}}terminate(){}};So([lo("0.uml"),Co("design:type",Function),Co("design:paramtypes",[String,Object]),Co("design:returntype",void 0)],Mo.prototype,"_updateModel",null),Mo=Po=So([nt(),lo("0.dmg"),Do(0,dt(Ro)),Do(1,dt(Hr)),Do(2,dt(_o)),Co("design:paramtypes",[Ro,Hr,_o])],Mo);class xo{constructor(e,t){this._global=e,this._action=t}static create(e,t){const n=Reflect.getMetadata(ao,e);return new xo(t,"zep."+n)}_postLog(e,t){const n={target:xr.LOGGER_MANAGER,type:"workerlog",data:{level:e,args:t,action:this._action}};this._global.postMessage(n)}set action(e){this._action=e}get action(){return this._action}info(...e){this._postLog("info",e)}warn(...e){this._postLog("warn",e)}error(...e){this._postLog("error",e)}}var Io;!function(e){e.ResetStatistic="ResetStatistic",e.MediaStartRequest="MediaStartRequest",e.NetworkStartDownloadBody="NetworkStartDownloadBody",e.NetworkFetchFailed="NetworkFetchFailed",e.AudioFirstFrameRecv="AudioFirstFrameRecv",e.AudioRenderFailed="AudioRenderFailed",e.VideoFirstFrameRecv="VideoFirstFrameRecv",e.VideoRenderFailed="VideoRenderFailed"}(Io||(Io={}));var Fo,Oo,Lo=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},No=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Bo=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};!function(e){e.READY="decodeReady",e.MEDIA_STATE_UPDATE="mediaStateUpdate"}(Oo||(Oo={}));let jo=Fo=class extends Ir{constructor(){super(),this._inited=!1,this._mediaInfo=new Or,this._lastAudioDecodedTime=0,this._lastVideoDecodedTime=0,this._audioDecodeTimeout=null,this._videoDecodeTimeout=null,this._isFirstAudioFrameRecv=!1,this._isFirstVideoFrameRecv=!1,this._decodeTimer=null,this.logger=xo.create(Fo,self)}get ready(){return this._inited}init(e){this._inited?this.logger.info("repeatly initlization"):(this._M=e,this._bindDecodeEvent(),this._inited=!0,this.emit(Oo.READY))}_onMediaLoaded(){self.postMessage({target:xr.DATA_MANAGER,type:To.UPDATE_MODEL,data:{modelName:ko.PLAYER_STATE,model:{loaded:!0}}})}_onMediaError(e){const{UTF8ToString:t}=this._M,n=t(e),i=JSON.parse(n);switch(this.logger.error(n),i.name){case"NetworkError":throw new no(i.reason);case"DecodeError":throw new io(i.reason)}}_onDecodeEnd(){this.stopDecode(),self.postMessage({target:xr.DATA_MANAGER,type:To.UPDATE_MODEL,data:{modelName:ko.PLAYER_STATE,model:{decodeEnded:!0}}})}_onSeiCatch(e,t,n){const i=new Uint8Array(this._M.HEAPU8.subarray(e,e+t));self.postMessage({target:xr.RENDER,type:Xo.RECV_SEI_DATA,data:{sei:i,pts:n}},[i.buffer])}_bindDecodeEvent(){return Bo(this,void 0,void 0,(function*(){const{addFunction:e,_bindDecodeCallback:t}=this._M,n=e(this._onMediaLoaded.bind(this),"v"),i=e(this._onMediaInfoUpdate.bind(this),"vi"),r=e(this._onAudioDecoded.bind(this),"viid");t(n,i,e(this._onVideoDecoded.bind(this),"viidii"),r,e(this._onMediaError.bind(this),"vi"),e(this._onDecodeEnd.bind(this),"v"),e(this._onSeiCatch.bind(this),"viid"))}))}_startVideoDecodeTimeout(){this._videoDecodeTimeout=setTimeout((()=>{(performance.now()-this._lastAudioDecodedTime)/1e3<3&&(this._mediaInfo=new Or(Object.assign(Object.assign({},this._mediaInfo.info),{frameWidth:0,frameHeight:0})),this._updateMediaInfo(this._mediaInfo)),this._videoDecodeTimeout=null}),5e3)}_sendFirstVideoFrameRecv(){this._isFirstVideoFrameRecv=!0,self.postMessage({target:xr.QUALITY_STATISTIC,type:Io.VideoFirstFrameRecv})}_onVideoDecoded(e,t,n,i,r){this._videoDecodeTimeout&&(clearTimeout(this._videoDecodeTimeout),this._videoDecodeTimeout=null),this._lastVideoDecodedTime=performance.now(),this._startVideoDecodeTimeout(),null===this._audioDecodeTimeout&&!this._mediaInfo.noAudio&&this._startAudioDecodeTimeout();const o=new Uint8Array(this._M.HEAPU8.subarray(e,e+t)),s={frame:o,pts:n,width:i,height:r};(this._mediaInfo.noVideo||i!==this._mediaInfo.frameWidth||r!==this._mediaInfo.frameHeight)&&(this._mediaInfo=new Or(Object.assign(Object.assign({},this._mediaInfo.info),{frameWidth:i,frameHeight:r})),this._updateMediaInfo(this._mediaInfo)),self.postMessage({target:xr.RENDER,type:Xo.PUSH_VIDEO_BUFFER,data:s},[o.buffer]),this._isFirstVideoFrameRecv||this._sendFirstVideoFrameRecv()}_startAudioDecodeTimeout(){this._audioDecodeTimeout=setTimeout((()=>{(performance.now()-this._lastVideoDecodedTime)/1e3<3&&(this._mediaInfo=new Or(Object.assign(Object.assign({},this._mediaInfo.info),{channelCount:0})),this._updateMediaInfo(this._mediaInfo)),this._audioDecodeTimeout=null}),5e3)}_sendFirstAudioFrameRecv(){this._isFirstAudioFrameRecv=!0,self.postMessage({target:xr.QUALITY_STATISTIC,type:Io.AudioFirstFrameRecv})}_onAudioDecoded(e,t,n){this._audioDecodeTimeout&&(clearTimeout(this._audioDecodeTimeout),this._audioDecodeTimeout=null),this._lastAudioDecodedTime=performance.now(),this._startAudioDecodeTimeout(),null===this._videoDecodeTimeout&&!this._mediaInfo.noVideo&&this._startVideoDecodeTimeout(),this._mediaInfo.noAudio&&(this._mediaInfo=new Or(Object.assign(Object.assign({},this._mediaInfo.info),{channelCount:2})),this._updateMediaInfo(this._mediaInfo));const i=new Uint8Array(this._M.HEAPU8.subarray(e,e+t)),r=new Int32Array(i.buffer),o=Lr.getLeftChannelData(r),s=Lr.getRightChannelData(r),a={pts:n,pcm:{leftChannel:o,rightChannel:s}};self.postMessage({target:xr.RENDER,type:Xo.PUSH_AUDIO_BUFFER,data:a},[o.buffer,s.buffer]),this._isFirstAudioFrameRecv||this._sendFirstAudioFrameRecv()}_updateMediaInfo(e){this._mediaInfo=e;const t={sampleRate:e.sampleRate,frameWidth:e.frameWidth,frameHeight:e.frameHeight,frameRate:e.frameRate,duration:e.duration<=0?-1:e.duration,channelCount:e.channelCount,videoCodecName:e.videoCodecName,audioCodecName:e.audioCodecName,formatName:e.formatName};this.logger.info("media info data: ",JSON.stringify(t)),self.postMessage({target:xr.RENDER,type:Xo.MEDIA_INFO_UPDATE,data:t})}_onMediaInfoUpdate(e){const t=this._M.__mediaInfo(e);if(!t)throw new io("can not open media");this.logger.info("media opened, info: "+JSON.stringify(t));const n=()=>{const e=!t.sampleRate||t.sampleRate<3e3;return e&&this.logger.info("no audio"),e};if((()=>{const e=!t.frameWidth||!t.frameHeight;return e&&this.logger.info("no video"),e})()&&n())throw this.logger.info("no video & no audio. media open failed."),this.stopDecode(),new io("open media failed.");this._updateMediaInfo(new Or(Object.assign(Object.assign({},t),{channelCount:n()?0:2})))}_stringToPtr(e){const{stringToUTF8:t,_malloc:n,lengthBytesUTF8:i}=this._M,r=n(i(e)+1);return t(e,r,i(e)+1),r}_resetFirstFrameState(){this._isFirstAudioFrameRecv=!1,this._isFirstVideoFrameRecv=!1}_clearDecodeTimer(){null!==this._decodeTimer&&(clearTimeout(this._decodeTimer),this._decodeTimer=null)}_startDecodeTimer(){this._clearDecodeTimer(),this._decodeTimer=setTimeout((()=>{this._M._active(),this._startDecodeTimer()}),16)}decode(e){this._resetFirstFrameState(),this._M._decode(this._stringToPtr(e)),this._startDecodeTimer()}stopDecode(){this._clearDecodeTimer(),this._M._stopDecode()}setSeiConfig(e){this.logger.info(`unregisterSEIFilter="${e.unregisterSEIFilter}", emulationPreventionByte=${e.emulationPreventionByte}`),this._M._setSeiConfig(this._stringToPtr(e.unregisterSEIFilter||""),e.emulationPreventionByte||!1)}videoBufferUpdate(e){this._M._onVideoBufferUpdate(e)}audioBufferUpdate(e){this._M._onAudioBufferUpdate(e)}updateMediaLockState(e){this._M._updateMediaLockState(e)}};Lo([lo("iit"),No("design:type",Function),No("design:paramtypes",[Object]),No("design:returntype",void 0)],jo.prototype,"init",null),Lo([lo("0.udmi"),No("design:type",Function),No("design:paramtypes",[Or]),No("design:returntype",void 0)],jo.prototype,"_updateMediaInfo",null),Lo([lo("dec"),No("design:type",Function),No("design:paramtypes",[String]),No("design:returntype",void 0)],jo.prototype,"decode",null),Lo([lo("spdc"),No("design:type",Function),No("design:paramtypes",[]),No("design:returntype",void 0)],jo.prototype,"stopDecode",null),Lo([lo("sic"),No("design:type",Function),No("design:paramtypes",[Object]),No("design:returntype",void 0)],jo.prototype,"setSeiConfig",null),jo=Fo=Lo([lo("dc.dcer"),No("design:paramtypes",[])],jo);var Uo,zo=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Vo=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Ho=Uo=class{constructor(){this.logger=xo.create(Uo,self)}_getStringFromCharPtr(e){return this._M.UTF8ToString(e)}_webAssemblyLogInfo(e){this.logger.info(this._getStringFromCharPtr(e))}_webAssemblyLogWarn(e){this.logger.warn(this._getStringFromCharPtr(e))}_webAssemblyLogError(e){this.logger.error(this._getStringFromCharPtr(e))}bind(e){this._M=e;const t=this._M.addFunction(this._webAssemblyLogInfo.bind(this),"vi"),n=this._M.addFunction(this._webAssemblyLogWarn.bind(this),"vi"),i=this._M.addFunction(this._webAssemblyLogError.bind(this),"vi");if(t&&n&&i){const{_bindLoggerCallback:e}=this._M;e(t,n,i)}}};zo([lo("i",{callInfo:!1}),Vo("design:type",Function),Vo("design:paramtypes",[Number]),Vo("design:returntype",void 0)],Ho.prototype,"_webAssemblyLogInfo",null),zo([lo("w",{callInfo:!1}),Vo("design:type",Function),Vo("design:paramtypes",[Number]),Vo("design:returntype",void 0)],Ho.prototype,"_webAssemblyLogWarn",null),zo([lo("e",{callInfo:!1}),Vo("design:type",Function),Vo("design:paramtypes",[Number]),Vo("design:returntype",void 0)],Ho.prototype,"_webAssemblyLogError",null),Ho=Uo=zo([lo("dc.wasm"),Vo("design:paramtypes",[])],Ho);var Wo,qo=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Go=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Yo=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};const Zo=self;var Ko;!function(e){e.WasmReady="wasmReady"}(Ko||(Ko={}));let $o=Wo=class extends Ir{constructor(){super(),this._loaded=!1,this._promiseMap=new Cr,this._decoder=new jo,this._wasmLogListener=new Ho,this._decodeLibWasmBlobUrl="",this.logger=xo.create(Wo,self)}_onModuleRuntimeInitialized(){return Yo(this,void 0,void 0,(function*(){this.logger.info("WebAssembly RuntimeInitialized!"),this._M=Zo.ZegoDecodeModule,this._M.ASAN_OPTIONS="malloc_context_size=0",this._wasmLogListener.bind(this._M),this._decoder.init(this._M),this._bindSendMessage2Wasm(),this._loaded=!0,this.emit(Ko.WasmReady)}))}_postMessageFromWasm(e){const{UTF8ToString:t}=this._M,n=t(e),i=JSON.parse(n);self.postMessage(i)}_bindSendMessage2Wasm(){const{_bindSendMessage:e,addFunction:t}=this._M;e(t(this._postMessageFromWasm.bind(this),"vi"))}get _initModuleConfig(){return{locateFile:e=>(this.logger.info("locateFile call"),e.endsWith(".wasm")?this._decodeLibWasmBlobUrl:e),onRuntimeInitialized:()=>Yo(this,void 0,void 0,(function*(){yield this._onModuleRuntimeInitialized()}))}}_ungzip(e){return new Promise(((t,n)=>{fetch(e).then((e=>{if(200===e.status)return e.arrayBuffer();throw new Error("cannot fetch resource .gz file")})).then((e=>{const n=Rr.ungzip(e);t(n)})).catch((e=>{n(e)}))}))}_buffer2BlobUrl(e){const t=new Blob([e],{type:"application/wasm"});return URL.createObjectURL(t)}load(){return Yo(this,void 0,void 0,(function*(){if(!this._loaded)try{const e=yield this._ungzip(Pr);this._decodeLibWasmBlobUrl=this._buffer2BlobUrl(e),Zo.ZegoDecodeModule=this._initModuleConfig,Zo.importScripts(Tr)}catch(e){throw new to(e.message)}}))}WaitEnvironment(e){return Yo(this,void 0,void 0,(function*(){const t=this._promiseMap.get(e);t.reset();const n={},i=()=>Yo(this,void 0,void 0,(function*(){t.add(new Mr(((e,t)=>{this._loaded?e():(n.ready=()=>e(),this.once(Ko.WasmReady,n.ready))}))),yield t.all()}));try{return yield i(),!0}catch(t){if(t==Sr)return this.logger.info(`wait wasm abort. from ${e}`),n.ready&&this.off(Ko.WasmReady,n.ready),!1;throw t}}))}setMediaSource(e){return Yo(this,void 0,void 0,(function*(){(yield this.WaitEnvironment("setMediaSource"))&&this._decoder.decode(e)}))}updateSEIConfig(e){return Yo(this,void 0,void 0,(function*(){(yield this.WaitEnvironment("updateSEIConfig"))&&this._decoder.setSeiConfig(e)}))}videoBufferUpdate(e){return Yo(this,void 0,void 0,(function*(){(yield this.WaitEnvironment("videoBufferUpdate"))&&this._decoder.videoBufferUpdate(e)}))}audioBufferUpdate(e){return Yo(this,void 0,void 0,(function*(){(yield this.WaitEnvironment("audioBufferUpdate"))&&this._decoder.audioBufferUpdate(e)}))}stop(){return Yo(this,void 0,void 0,(function*(){this._promiseMap.reset(),this._loaded?this._decoder.stopDecode():this.logger.info("stop => webassembly not load.")}))}updateMediaBufferLockState(e){return Yo(this,void 0,void 0,(function*(){(yield this.WaitEnvironment("updateMediaBufferLockState"))&&this._decoder.updateMediaLockState(e)}))}};var Xo,Jo,Qo,es;qo([lo("0.omrid"),Go("design:type",Function),Go("design:paramtypes",[]),Go("design:returntype",Promise)],$o.prototype,"_onModuleRuntimeInitialized",null),qo([lo("lod"),Go("design:type",Function),Go("design:paramtypes",[]),Go("design:returntype",Promise)],$o.prototype,"load",null),qo([lo("stmsc"),Go("design:type",Function),Go("design:paramtypes",[String]),Go("design:returntype",Promise)],$o.prototype,"setMediaSource",null),qo([lo("seiu"),Go("design:type",Function),Go("design:paramtypes",[Object]),Go("design:returntype",Promise)],$o.prototype,"updateSEIConfig",null),qo([lo("onstp"),Go("design:type",Function),Go("design:paramtypes",[]),Go("design:returntype",Promise)],$o.prototype,"stop",null),$o=Wo=qo([lo("dc.wsmld"),Go("design:paramtypes",[])],$o),function(e){e.PUSH_VIDEO_BUFFER="pushVideoBuffer",e.PUSH_AUDIO_BUFFER="pushAudioBuffer",e.MEDIA_INFO_UPDATE="mediaInfoUpdate",e.DECODE_END="decodeEnded",e.MEDIA_NOT_FETCH="mediaNotFetch",e.RECV_SEI_DATA="recvSeiData",e.SET_SEI_CONFIG="setSeiConfig"}(Xo||(Xo={})),function(e){e.PACKETS_NUM_CHANEGD="numberOfPakcetsChanged",e.READ_EMPTY="readEmpty"}(Jo||(Jo={})),function(e){e.VIDEO_BUFFER_POP="videoBufferPop",e.AUDIO_BUFFER_POP="audioBufferPop",e.MEDIA_BUFFER_LOCK="mediaLock",e.MEDIA_BUFFER_UNLOCK="mediaBufferUnlock"}(Qo||(Qo={}));class ts extends Ir{constructor(){super(...arguments),this._pool=[],this._locked=!1}get size(){let e=0;return this._pool.forEach((t=>{e+=t.pcm.leftChannel.byteLength,e+=t.pcm.rightChannel.byteLength})),e}get numberOfPackets(){return this._pool.length}lock(){this._locked=!0}unlock(){this._locked=!1}_dropPtsErrDataByPacket(e){this._pool.length>0&&e.pts<this._pool[this._pool.length-1].pts&&this.clear()}push(e){if(this._locked)return;this._dropPtsErrDataByPacket(e);const t=this.numberOfPackets;this._pool.push(e),this._updatePoolChangeEvent(t)}_updatePoolChangeEvent(e){e!=this.numberOfPackets&&(this.emit(Jo.PACKETS_NUM_CHANEGD,this.numberOfPackets),this._postPoolPopEvent())}_postPoolPopEvent(){this.postMessage&&this.postMessage({target:xr.DECODER,type:Qo.AUDIO_BUFFER_POP,data:{numberOfPackets:this.numberOfPackets}})}read(e){if(this.isEmpty())return;const t=this.numberOfPackets,n={pcm:{leftChannel:new Float32Array(e),rightChannel:new Float32Array(e)},pts:-1};let i=0;for(;i<e;){const t=this._pool[0];if(!t)return;const r=Math.min(e-i,t.pcm.leftChannel.length);n.pcm.leftChannel.set(t.pcm.leftChannel.subarray(0,r)),n.pcm.rightChannel.set(t.pcm.rightChannel.subarray(0,r)),n.pts<0&&(n.pts=t.pts),r===t.pcm.leftChannel.length?this._pool.shift():(t.pcm.leftChannel=t.pcm.leftChannel.subarray(r),t.pcm.rightChannel=t.pcm.rightChannel.subarray(r)),i+=r}return this._updatePoolChangeEvent(t),0===this._pool.length&&this.isEmpty()&&this.emit(Jo.READ_EMPTY),n}front(){return this._pool[0]}isEmpty(){return 0===this.size}clear(){const e=this.numberOfPackets;this._pool=[],this._updatePoolChangeEvent(e)}removeBeforePts(e){if(this.isEmpty())return;const t=this.numberOfPackets;this._pool=this._pool.filter((t=>t.pts>=e)),this._updatePoolChangeEvent(t)}}!function(e){e.PACKETS_NUM_CHANEGD="packetNumberChanged",e.READ_EMPTY="readEmpty"}(es||(es={}));class ns extends Ir{constructor(){super(...arguments),this._pool=[],this._locked=!1}get size(){let e=0;return this._pool.forEach((t=>{e+=t.frame.byteLength})),e}get numberOfPackets(){return this._pool.length}get duration(){let e=0;if(this.isEmpty())return e;const t=this.front();if(!t)throw new to("read video packet error when get duration");let n=t.pts;for(let t=1;t<this._pool.length;t++)this._pool.forEach((t=>{e+=n-t.pts,n=t.pts}));return e}lock(){this._locked=!0}unlock(){this._locked=!1}_dropPtsErrDataByPacket(e){this._pool.length>0&&e.pts<this._pool[this._pool.length-1].pts&&this.clear()}push(e){if(this._locked)return;const t=this.numberOfPackets;this._dropPtsErrDataByPacket(e),this._pool.push(e),this._updatePoolPopEvent(t)}_postPoolPopEvent(){this.postMessage&&this.postMessage({target:xr.DECODER,type:Qo.VIDEO_BUFFER_POP,data:{numberOfPackets:this.numberOfPackets}})}_updatePoolPopEvent(e){e!=this.numberOfPackets&&(this.emit(es.PACKETS_NUM_CHANEGD,this.numberOfPackets),this._postPoolPopEvent())}read(){if(this.isEmpty())return;const e=this.numberOfPackets,t=this._pool.shift();return this._updatePoolPopEvent(e),this.isEmpty()&&this.emit(es.READ_EMPTY),t}front(){return this._pool[0]}isEmpty(){return 0===this.numberOfPackets}clear(){const e=this.numberOfPackets;this._pool=[],this._updatePoolPopEvent(e)}removeBeforePts(e){if(this.isEmpty())return;const t=this.numberOfPackets;this._pool=this._pool.filter((t=>t.pts>=e));const n=this._pool.shift();return this._updatePoolPopEvent(t),n}}var is,rs,os=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},ss=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},as=function(e,t){return function(n,i){t(n,i,e)}};!function(e){e.BUFFER_CAN_PLAY="canplay",e.MEDIA_END="mediaEnd"}(rs||(rs={}));let ls=is=class extends Ir{constructor(e,t){super(),this._playerState=e,this._logManager=t,this._pcmPool=new ts,this._yuvPool=new ns,this._lastLegalMediaInfo=new Or,this._currentLegalMediaInfo=new Or,this._locked=!1,this._canPlayAudioBufferListener=e=>{e>43&&(this.logger.info("meida can play (by audio buffer)"),this._pcmPool.off(Jo.PACKETS_NUM_CHANEGD,this._canPlayAudioBufferListener),this.emit(rs.BUFFER_CAN_PLAY))},this._canPlayVideoBufferListener=e=>{e>24&&(this.logger.info("meida can play (by video buffer)"),this._yuvPool.off(es.PACKETS_NUM_CHANEGD,this._canPlayVideoBufferListener),this.emit(rs.BUFFER_CAN_PLAY))},this._mediaEndAudioBufferListener=()=>{!this._playerState.mediaPlayEnded&&this._playerState.decodeEnded&&this._playerState.loaded&&(this.logger.info("media play ended. (by audio buffer)"),this._playerState.mediaPlayEnded=!0,this.emit(rs.MEDIA_END))},this._mediaEndVideoBufferListener=()=>{!this._playerState.mediaPlayEnded&&this._playerState.decodeEnded&&this._playerState.loaded&&(this.logger.info("media play ended."),this._playerState.mediaPlayEnded=!0,this.emit(rs.MEDIA_END))},this.logger=this._logManager.classLogger(is),this._resetBufferEvent()}get audioBuffer(){return this._pcmPool}get videoBuffer(){return this._yuvPool}get info(){return this._playerState.mediaInfo}get lastMediaInfo(){return this._lastLegalMediaInfo}get storeDuration(){const e=this.audioBuffer.size/this.info.channelCount/this.info.sampleRate,t=this.videoBuffer.duration;return Math.min(e,t)}isMediaLegal(){const e=this.info.validate();return this.logger.info(`info validate: ${e}`),e}_canPlayEventByAudioBuffer(){this._pcmPool.off(Jo.PACKETS_NUM_CHANEGD,this._canPlayAudioBufferListener),this._pcmPool.on(Jo.PACKETS_NUM_CHANEGD,this._canPlayAudioBufferListener)}_canPlayEventByVideoBuffer(){this._yuvPool.off(es.PACKETS_NUM_CHANEGD,this._canPlayVideoBufferListener),this._yuvPool.on(es.PACKETS_NUM_CHANEGD,this._canPlayVideoBufferListener)}updateMedia(e){this._pcmPool.clear(),this._yuvPool.clear(),e.validate()&&(this.logger.info("last media info set"),this._lastLegalMediaInfo=this._currentLegalMediaInfo,this._currentLegalMediaInfo=e),this._playerState.mediaInfo=e,this._playerState.mediaPlayEnded=!1,this._playerState.decodeEnded=!1,this.unlock(),this._resetBufferEvent()}clear(){this._pcmPool.clear(),this._yuvPool.clear()}lock(){this.postMessage&&this.postMessage({target:xr.DECODER,type:Qo.MEDIA_BUFFER_LOCK}),this._pcmPool.lock(),this._yuvPool.lock(),this._locked=!0}unlock(){this.postMessage&&this.postMessage({target:xr.DECODER,type:Qo.MEDIA_BUFFER_UNLOCK}),this._pcmPool.unlock(),this._yuvPool.unlock(),this._locked=!1}_mediaPlayEndByAudioBuffer(){this._pcmPool.off(Jo.READ_EMPTY,this._mediaEndAudioBufferListener),this._pcmPool.on(Jo.READ_EMPTY,this._mediaEndAudioBufferListener)}_mediaPlayEndByVideoBuffer(){this._yuvPool.off(es.READ_EMPTY,this._mediaEndVideoBufferListener),this._yuvPool.on(es.READ_EMPTY,this._mediaEndVideoBufferListener)}_resetBufferEvent(){this.info.noAudio?(this.logger.info("media buffer event by video buffer"),this._canPlayEventByVideoBuffer(),this._mediaPlayEndByVideoBuffer()):(this.logger.info("media buffer event by audio buffer"),this._canPlayEventByAudioBuffer(),this._mediaPlayEndByAudioBuffer())}isEmpty(){return this.info.noAudio?this.videoBuffer.isEmpty():this.audioBuffer.isEmpty()}};os([lo("imll"),ss("design:type",Function),ss("design:paramtypes",[]),ss("design:returntype",Boolean)],ls.prototype,"isMediaLegal",null),os([lo("0.cpeab"),ss("design:type",Function),ss("design:paramtypes",[]),ss("design:returntype",void 0)],ls.prototype,"_canPlayEventByAudioBuffer",null),os([lo("0.cpevb"),ss("design:type",Function),ss("design:paramtypes",[]),ss("design:returntype",void 0)],ls.prototype,"_canPlayEventByVideoBuffer",null),os([lo("updm"),ss("design:type",Function),ss("design:paramtypes",[Or]),ss("design:returntype",void 0)],ls.prototype,"updateMedia",null),os([lo("clr"),ss("design:type",Function),ss("design:paramtypes",[]),ss("design:returntype",void 0)],ls.prototype,"clear",null),os([lo("lk"),ss("design:type",Function),ss("design:paramtypes",[]),ss("design:returntype",void 0)],ls.prototype,"lock",null),os([lo("ulk"),ss("design:type",Function),ss("design:paramtypes",[]),ss("design:returntype",void 0)],ls.prototype,"unlock",null),os([lo("0.mpeab"),ss("design:type",Function),ss("design:paramtypes",[]),ss("design:returntype",void 0)],ls.prototype,"_mediaPlayEndByAudioBuffer",null),os([lo("0.mpevb"),ss("design:type",Function),ss("design:paramtypes",[]),ss("design:returntype",void 0)],ls.prototype,"_mediaPlayEndByVideoBuffer",null),os([lo("0.babe"),ss("design:type",Function),ss("design:paramtypes",[]),ss("design:returntype",void 0)],ls.prototype,"_resetBufferEvent",null),os([lo("isem"),ss("design:type",Function),ss("design:paramtypes",[]),ss("design:returntype",void 0)],ls.prototype,"isEmpty",null),ls=is=os([nt(),lo("rd.rdmd"),as(0,dt(Ro)),as(1,dt(_o)),ss("design:paramtypes",[Ro,_o])],ls);var ds,us=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},cs=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},hs=function(e,t){return function(n,i){t(n,i,e)}};!function(e){e.ClockUpdate="clockUpdate"}(ds||(ds={}));let ps=class extends Ir{constructor(e){super(),this._playerState=e,this._lastPts=-1,this._lastProcessTime=-1,this._lastPausedTime=-1}get lastPts(){return this._lastPts}reset(){this._lastPts=-1,this._lastProcessTime=-1}paused(){this._lastProcessTime=-1,this._lastPausedTime=performance.now()}getLiveClock(){return this._lastPts<0?0:this._lastPausedTime<0?this.getClock():(performance.now()-this._lastPausedTime)/1e3+this._lastPts}getClock(){return this._lastPts<0?0:this._lastProcessTime<0?this._lastPts:(performance.now()-this._lastProcessTime)/1e3+this._lastPts}updateClock(e){this._lastPts!==e&&e>0&&(this._lastPts=e,this._lastProcessTime=performance.now(),this._lastPausedTime=-1,this._playerState.mediaPlayEnded||(this._playerState.currentTime=this.getClock()),this.emit(ds.ClockUpdate))}};ps=us([nt(),hs(0,dt(Ro)),cs("design:paramtypes",[Ro])],ps);var fs,_s=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},gs=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ys=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};let ms=fs=class{constructor(e,t,n,i,r){this._packet=null,this._played=!1,this._bounding=!1,this._autoPlayTimeout=null,this.ResumeListener=()=>{"running"!==this.ac.state?(this.ac.onstatechange=()=>{"running"===this.ac.state&&document.body.removeEventListener("click",this.ResumeListener)},this.ac.resume().then((()=>{"running"===this.ac.state&&(this._playerState.audioDeviceReady=!0)}))):document.body.removeEventListener("click",this.ResumeListener)};const o=window.AudioContext||window.webkitAudioContext;this.logger=r.classLogger(fs),this._onComputeTimeoutBound=this._onComputeTimeout.bind(this),this._playerState=i,this._audioContext=new o({sampleRate:e}),this._sampleRate=e,this.logger.info("AudioContext sampleRate="+this._audioContext.sampleRate),this._channelCount=2,this._computeSamplesCount=1024,this._buffersToKeep=5,this._computeDuration=this._computeSamplesCount/this._sampleRate,this._totalBufferDuration=this._buffersToKeep*this._computeDuration,this._totalSamplesCount=this._totalBufferDuration*this._sampleRate,this._computeDurationMS=1e3*this._computeDuration,this._audioBufferSources=[],this._computeSamplesTimeout=null,this._pool=t,this._audioClock=n,this._gainNode=this._audioContext.createGain(),this._initAudioContext(),this._bindDocumentEvent()}_initAudioContext(){this._gainNode.gain.value=this._playerState.muted?0:this._playerState.volume/100,this._gainNode.connect(this._audioContext.destination)}_onAudioClockUpdate(e){this._audioClock.updateClock(e)}_resumeAudioContext(){return new Promise((e=>{if("running"!==this._audioContext.state){const t=()=>{if("running"!==this.ac.state)throw this.logger.error("web audio auto play failed."),new ro("Auto play failed. Please call play() method after click.")},n=()=>{this._autoPlayTimeout&&clearTimeout(this._autoPlayTimeout)};this._audioContext.resume().then((()=>{"running"==this._audioContext.state&&(this._playerState.audioDeviceReady=!0,e())})).catch((e=>{n(),t()})),n(),this._autoPlayTimeout=setTimeout((()=>{t()}),3e3),this.logger.info("audio context resumed.")}else this._playerState.audioDeviceReady=!0,e()}))}_bindDocumentEvent(){document.body.addEventListener("click",this.ResumeListener)}_offDocumentEvent(){document.body.removeEventListener("click",this.ResumeListener)}_audioPaused(){this._audioClock.paused()}get ac(){return this._audioContext}get sampleRate(){return this._sampleRate}get stream(){return this.ac.createMediaStreamDestination().stream}_newAudioContextStartOffset(){return("safari"===Fr.getBrowser()||"unknown"===Fr.getBrowser()?this._audioContext.currentTime:this._audioContext.getOutputTimestamp?this._audioContext.getOutputTimestamp().contextTime:this._audioContext.currentTime)||0}_startPlaying(){this._audioBufferSources.length>0&&this._pausePlaying();(()=>{if(this._audioContext.getOutputTimestamp){let e=this._audioContext.getOutputTimestamp();this._lastTimeoutTime=e.performanceTime||0}else this._lastTimeoutTime=performance.now();this._audioContextStartOffset=this._newAudioContextStartOffset(),this._currentBufferTime=0})(),(()=>{this._audioBufferSources.forEach((e=>{const t=this._audioContext.createBufferSource();t.buffer=e.node.buffer,t.connect(this._gainNode),e.node=t,e.node.start(this._getNextBufferTime());const n=e.pts;e.node.onended=()=>{n>=0&&this._onAudioClockUpdate(n+this._computeDuration),this._audioBufferSources.shift()},this._currentBufferTime+=this._computeDuration}))})(),this._bounding=!0,this._onComputeTimeoutBound()}_getNextBufferTime(){return this._audioContextStartOffset+this._currentBufferTime+.5}_computeSamples(){if(this._pool.isEmpty())return null;{const e=this._pool.read(this._computeSamplesCount);return e||null}}_onComputeTimeout(){if(!this._bounding)return;if(this._pool.isEmpty()){if(this._playerState.decodeEnded)return;this._bufferNext()}else for(;!this._pool.isEmpty()&&this._buffersToKeep>this._audioBufferSources.length;)this._bufferNext();let e=2*this._computeDurationMS-(performance.now()-this._lastTimeoutTime)-20;e=Math.max(0,e),this._lastTimeoutTime=performance.now(),this._computeSamplesTimeout&&clearTimeout(this._computeSamplesTimeout),this._computeSamplesTimeout=setTimeout(this._onComputeTimeoutBound,e)}_bufferNext(){this._currentSamplesOffset=this._currentBufferTime*this._sampleRate,this._audioBuffer=this._audioContext.createBuffer(this._channelCount,this._computeSamplesCount,this._sampleRate),this._channels=[];for(let e=0;e<this._channelCount;++e)this._channels.push(this._audioBuffer.getChannelData(e));const e=this._computeSamples();if(e&&(this._channels[0].set(e.pcm.leftChannel),this._channels[1].set(e.pcm.rightChannel)),e||0==this._audioBufferSources.length){let t=this._audioContext.createBufferSource();t.buffer=this._audioBuffer,t.connect(this._gainNode),t.start(this._getNextBufferTime());let n=-1;n=e&&e.pts||-1,t.onended=()=>{n>=0&&this._onAudioClockUpdate(n+this._computeDuration),this._audioBufferSources.shift()},this._audioBufferSources.push({node:t,pts:n}),this._currentBufferTime+=this._computeDuration}}_pausePlaying(){if(this._audioPaused(),this._audioBufferSources.length>0){this.logger.info("has audio buffer sources.");for(let e of this._audioBufferSources)try{e.node.onended=null,e.node.stop()}catch(e){}}this._computeSamplesTimeout&&clearTimeout(this._computeSamplesTimeout),this._computeSamplesTimeout=null,this._bounding=!1}_stopPlaying(){this._pausePlaying(),this._audioBufferSources=[]}reset(e){this._stopPlaying(),this._audioClock=e,this._played&&this._startPlaying()}play(){return ys(this,void 0,void 0,(function*(){yield this._resumeAudioContext(),this._played||(this._played=!0,this._startPlaying())}))}pause(){this._resumeAudioContext(),this._played&&(this._played=!1,this._audioPaused(),this._pausePlaying())}destroy(){this._stopPlaying(),this._gainNode.disconnect(),this._audioClock.reset(),this._offDocumentEvent(),this._playerState.audioDeviceReady=!1}resume(){this._resumeAudioContext()}setVolume(e){if(e<0||e>100)throw new Qr("volume need to be in the interval [0, 100].");this._gainNode.gain.value=e/100}};_s([lo("0.rmac"),gs("design:type",Function),gs("design:paramtypes",[]),gs("design:returntype",void 0)],ms.prototype,"_resumeAudioContext",null),_s([lo("stpl"),gs("design:type",Function),gs("design:paramtypes",[]),gs("design:returntype",void 0)],ms.prototype,"_startPlaying",null),_s([lo("0.pup"),gs("design:type",Function),gs("design:paramtypes",[]),gs("design:returntype",void 0)],ms.prototype,"_pausePlaying",null),_s([lo("rst"),gs("design:type",Function),gs("design:paramtypes",[ps]),gs("design:returntype",void 0)],ms.prototype,"reset",null),_s([lo("pl"),gs("design:type",Function),gs("design:paramtypes",[]),gs("design:returntype",Promise)],ms.prototype,"play",null),_s([lo("pu"),gs("design:type",Function),gs("design:paramtypes",[]),gs("design:returntype",void 0)],ms.prototype,"pause",null),_s([lo("dst"),gs("design:type",Function),gs("design:paramtypes",[]),gs("design:returntype",void 0)],ms.prototype,"destroy",null),_s([lo("rsm"),gs("design:type",Function),gs("design:paramtypes",[]),gs("design:returntype",void 0)],ms.prototype,"resume",null),ms=fs=_s([lo("rd.msot"),gs("design:paramtypes",[Number,ts,ps,Ro,_o])],ms);class vs{constructor(e,t,n,i){this._masterOutput=new ms(e.info.sampleRate,e.audioBuffer,t,n,i)}get sampleRate(){return this._masterOutput.sampleRate}get ac(){return this._masterOutput.ac}get stream(){return this._masterOutput.stream}resume(){this._masterOutput.resume()}reset(e){this._masterOutput.reset(e)}play(){this._masterOutput.play()}pause(){this._masterOutput.pause()}destroy(){this.pause(),this._masterOutput.destroy()}setVolume(e){this._masterOutput.setVolume(e)}}var ws,bs=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Es=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let As=ws=class{constructor(e,t){this.logger=t.classLogger(ws),this._canvas=e,this._init()}_createTexture(e){const t=e.createTexture();if(!t)throw new to("webgl cannot create texture.");return e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindTexture(e.TEXTURE_2D,null),t}_createShader(e,t,n){const i=e.createShader(t);if(!i)throw new to("webgl cannot create shader");e.shaderSource(i,n),e.compileShader(i);if(!e.getShaderParameter(i,e.COMPILE_STATUS))throw this.logger.warn("get shader parameter error"+e.getShaderInfoLog(i)),e.deleteShader(i),new to("webgl cannot get shader parameter");return i}_createProgram(e,t,n){const i=this._createShader(e,e.VERTEX_SHADER,t),r=this._createShader(e,e.FRAGMENT_SHADER,n),o=e.createProgram();if(!o)throw new to("webgl cannot create program");e.attachShader(o,i),e.attachShader(o,r),e.linkProgram(o);if(e.getProgramParameter(o,e.LINK_STATUS))return o;this.logger.warn("get program parameter error: "+e.getProgramInfoLog(o)),e.deleteProgram(o)}_init(){const e=this._canvas.getContext("webgl");if(!e)throw new to("can not get webgl context on canvas");this._gl=e;const t=this._createProgram(e,"\nattribute vec2 vertexPos; \nattribute vec2 texturePos;\nvarying vec2 textureCoord;\nvoid main() {\n    gl_Position = vec4(vertexPos * vec2(1, -1), 0, 1);;\n    textureCoord = texturePos;\n}\n","\nprecision highp float;\nvarying highp vec2 textureCoord;\nuniform sampler2D ySampler;\nuniform sampler2D uSampler;\nuniform sampler2D vSampler;\nconst mat4 YUV2RGB = mat4(\n    1.1643828125, 0, 1.59602734375, -.87078515625,\n    1.1643828125, -.39176171875, -.81296875, .52959375,\n    1.1643828125, 2.017234375, 0, -1.081390625,\n    0, 0, 0, 1\n);\nvoid main(void) {\n    highp float y = texture2D(ySampler, textureCoord).r;\n    highp float u = texture2D(uSampler, textureCoord).r;\n    highp float v = texture2D(vSampler, textureCoord).r;\n    gl_FragColor = vec4(y, u, v, 1) * YUV2RGB;\n}\n");if(!t)throw new to("webgl cannot create program when init.");e.useProgram(t),e.bindBuffer(e.ARRAY_BUFFER,e.createBuffer()),e.bufferData(e.ARRAY_BUFFER,new Float32Array([1,1,-1,1,1,-1,1,-1,-1,1,-1,-1]),e.STATIC_DRAW);const n=e.getAttribLocation(t,"vertexPos");e.enableVertexAttribArray(n),e.vertexAttribPointer(n,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,e.createBuffer()),e.bufferData(e.ARRAY_BUFFER,new Float32Array([1,1,0,1,1,0,1,0,0,1,0,0]),e.STATIC_DRAW);const i=e.getAttribLocation(t,"texturePos");e.enableVertexAttribArray(i),e.vertexAttribPointer(i,2,e.FLOAT,!1,0,0);const r=this._createTexture(e),o=e.getUniformLocation(t,"ySampler");e.uniform1i(o,0);const s=this._createTexture(e),a=e.getUniformLocation(t,"uSampler");e.uniform1i(a,1);const l=this._createTexture(e),d=e.getUniformLocation(t,"vSampler");e.uniform1i(d,2),this._texture={y:r,u:s,v:l},e.pixelStorei(e.UNPACK_ALIGNMENT,1)}clearCanvas(){const e=this._gl;e.canvas.width=0,e.canvas.height=0,e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}render(e,t,n){const i=this._gl,r=n*t;i.canvas.width=t,i.canvas.height=n,i.viewport(0,0,t,n);const o=r,s=e.subarray(0,o);i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,this._texture.y),i.texImage2D(i.TEXTURE_2D,0,i.LUMINANCE,t,n,0,i.LUMINANCE,i.UNSIGNED_BYTE,s);const a=r/4,l=e.subarray(o,o+a);i.activeTexture(i.TEXTURE1),i.bindTexture(i.TEXTURE_2D,this._texture.u),i.texImage2D(i.TEXTURE_2D,0,i.LUMINANCE,t/2,n/2,0,i.LUMINANCE,i.UNSIGNED_BYTE,l);const d=a,u=e.subarray(o+a,o+a+d);i.activeTexture(i.TEXTURE2),i.bindTexture(i.TEXTURE_2D,this._texture.v),i.texImage2D(i.TEXTURE_2D,0,i.LUMINANCE,t/2,n/2,0,i.LUMINANCE,i.UNSIGNED_BYTE,u),i.drawArrays(i.TRIANGLES,0,6)}};As=ws=bs([lo("imr"),Es("design:paramtypes",[HTMLCanvasElement,_o])],As);class Rs{constructor(){this._lastPts=-1,this._lastRenderTime=-1,this._firstRenderTime=-1,this._firstPts=-1}reset(){this._lastPts=-1,this._lastRenderTime=-1,this._firstRenderTime=-1,this._firstPts=-1}updateClock(e){this._firstPts<0&&(this._firstPts=e,this._firstRenderTime=performance.now()),this._lastPts=e,this._lastRenderTime=performance.now()}calculateCurrentTime(){return this._firstRenderTime<0||this._firstPts<0?0:(performance.now()-this._firstRenderTime)/1e3+this._firstPts}get lastRenderTime(){return this._lastRenderTime}get firstRenderTime(){return this._firstRenderTime}get lastPts(){return this._lastPts<0?0:this._lastPts}}var Ps,Ts=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},ks=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Ss=Ps=class{get _mediaInfo(){return this._media.info}constructor(e,t,n,i){this._media=e,this._videoTimer=null,this._videoClock=new Rs,this._playing=!1,this._renderID=0,this._renderCanvas=i,this._imageRender=new As(this._renderCanvas,n),this._pool=e.videoBuffer,this._audioClock=t,this.logger=n.classLogger(Ps),this._stream=this._renderCanvas.captureStream()}get stream(){return this._stream}_videoRender(){const e=this._pool.read();e&&(this._imageRender.render(e.frame,e.width,e.height),this._videoClock.updateClock(e.pts),this._mediaInfo.noAudio&&this._audioClock.updateClock(e.pts))}_getAudioClock(){return this._audioClock.getClock()}_removeDelayedVideoFrame(){for(;!this._pool.isEmpty();){const e=this._pool.front();if(!this._mediaInfo.noAudio&&e&&e.pts-this._getAudioClock()>0||this._mediaInfo.noAudio&&e&&e.pts-this._getCurrentTimeByVideoClock()>0)break;this._pool.read()}}_syncByAudioClock(){const e=this._videoClock.lastPts-this._getAudioClock();e>.025||(e<-.1?(this._removeDelayedVideoFrame(),this._videoRender()):this._videoRender())}_getCurrentTimeByVideoClock(){return this._videoClock.calculateCurrentTime()}_syncByVideoClock(){const e=this._videoClock.lastPts-this._getCurrentTimeByVideoClock();e>.025||(e<-.1?(this._removeDelayedVideoFrame(),this._videoRender()):this._videoRender())}_onVideoProcess(){this._pool.isEmpty()||(this._mediaInfo.noAudio?this._syncByVideoClock():this._syncByAudioClock())}_clearVideoTimer(){null!=this._videoTimer&&(cancelAnimationFrame(this._videoTimer),this._videoTimer=null)}_startPlayTimer(e){if(this._clearVideoTimer(),e!==this._renderID)return;this._videoTimer=requestAnimationFrame((()=>{this._onVideoProcess(),this._startPlayTimer(e)}))}_stopPlayTimer(){this._clearVideoTimer(),this._renderID++}captureImage(){return this._renderCanvas.toDataURL()}resume(){this._videoRender()}play(){this._playing?this.logger.info("video is already playing !"):(this._renderID++,this._startPlayTimer(this._renderID),this._playing=!0)}pause(){this._playing?(this._stopPlayTimer(),this._mediaInfo.noAudio&&(this.logger.info("clocks paused."),this._audioClock.paused(),this._videoClock.reset()),this._playing=!1):this.logger.info("video is not playing !")}clearCanvas(){this._imageRender.clearCanvas()}destroy(){this._stopPlayTimer(),this._playing=!1,this._videoClock.reset()}};Ts([lo("rsum"),ks("design:type",Function),ks("design:paramtypes",[]),ks("design:returntype",void 0)],Ss.prototype,"resume",null),Ts([lo("pl"),ks("design:type",Function),ks("design:paramtypes",[]),ks("design:returntype",void 0)],Ss.prototype,"play",null),Ts([lo("pu"),ks("design:type",Function),ks("design:paramtypes",[]),ks("design:returntype",void 0)],Ss.prototype,"pause",null),Ts([lo("dst"),ks("design:type",Function),ks("design:paramtypes",[]),ks("design:returntype",void 0)],Ss.prototype,"destroy",null),Ss=Ps=Ts([lo("rd.vdp"),ks("design:paramtypes",[ls,ps,_o,HTMLCanvasElement])],Ss);var Cs,Ds,Ms=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},xs=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};!function(e){e.SHOULD_PLAY="shouldPlay",e.SHOULD_PAUSE="shouldPause"}(Ds||(Ds={}));let Is=Cs=class extends Ir{constructor(e,t){super(),this._playerState=e,this._logManager=t,this._shouldReplay=!1,this.logger=this._logManager.classLogger(Cs),this._bindDocumentEvent()}_bindDocumentEvent(){document.addEventListener("visibilitychange",(e=>{"visible"===document.visibilityState&&this._shouldReplay?(this.logger.info("visibilitychange, media should play"),this._shouldReplay=!1,this.emit(Ds.SHOULD_PLAY)):(this.logger.info("visibilitychange hidden"),this._playerState.played?(this.logger.info("media should pause"),this._shouldReplay=!0,this.emit(Ds.SHOULD_PAUSE)):this._shouldReplay=!1)}))}};Ms([lo("0.bdce"),xs("design:type",Function),xs("design:paramtypes",[]),xs("design:returntype",void 0)],Is.prototype,"_bindDocumentEvent",null),Is=Cs=Ms([lo("rd.mbgh"),xs("design:paramtypes",[Ro,_o])],Is);var Fs,Os=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Ls=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Ns=Fs=class{constructor(e){this._duration=-1,this._timer=null,this.logger=e.classLogger(Fs)}get duration(){return Math.max(this._duration,0)}waiting(){this._duration=2,this._timer&&clearTimeout(this._timer),this._timer=setTimeout((()=>{this.logger.info("waiting duration reset."),this._duration=-1}),6e4)}reset(){this._timer&&clearTimeout(this._timer),this._duration=-1}};Os([lo("wait"),Ls("design:type",Function),Ls("design:paramtypes",[]),Ls("design:returntype",void 0)],Ns.prototype,"waiting",null),Os([lo("rest"),Ls("design:type",Function),Ls("design:paramtypes",[]),Ls("design:returntype",void 0)],Ns.prototype,"reset",null),Ns=Fs=Os([lo("rd.wdrn"),Ls("design:paramtypes",[_o])],Ns);var Bs,js,Us=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},zs=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};!function(e){e.MEDIA_REPLAY="mediaReplay",e.MEDIA_WAITING="mediaWaiting"}(js||(js={}));let Vs=Bs=class extends Ir{constructor(e,t,n){super(),this._logManager=e,this._media=t,this._playerState=n,this._waitingEventAudioBufferListener=()=>{this.logger.info("audio buffer reade empty call"),this._bufferWaiting()},this._waitingEventVideoBufferListener=()=>{this.logger.info("video buffer read empty call"),this._bufferWaiting()},this.logger=this._logManager.classLogger(Bs),this._waitDurationTimer=new Ns(this._logManager)}_playingMedia(){this.logger.info("replaying media"),this._playerState.playing=!0,this.emit(js.MEDIA_REPLAY),clearTimeout(this._timer),this._timer=null}_playAndClearTimer(){this._playingMedia(),this._timer&&clearTimeout(this._timer),this._timeout&&clearTimeout(this._timeout),this._timer=this._timeout=null}_nextDectection(e){if(this.logger.info("next detection call"),!this._timer)return void this.logger.info("no timer");if(this._media.info.noAudio){if(this._media.videoBuffer.numberOfPackets>8||this._playerState.decodeEnded&&this._playerState.loaded)return this.logger.info("should replay media, stop waiting. (by video buffer)"),void this._playAndClearTimer()}else if(this._media.audioBuffer.size>8||this._playerState.decodeEnded&&this._playerState.loaded)return this.logger.info("should replay media, stop waiting. (by audio buffer)"),void this._playAndClearTimer();this._timer&&clearTimeout(this._timer);const t=Math.min(2*e,4e3);this._timer=setTimeout((()=>{this._nextDectection(t)}),t)}_startWaitingBufferDetection(){this._timer&&(clearTimeout(this._timer),this._timer=null),this._timeout&&(clearTimeout(this._timeout),this._timeout=null),this._waitDurationTimer.waiting(),this._timeout=setTimeout((()=>{if(this._timer)return this._playingMedia(),this._timer&&clearTimeout(this._timer),this._timer=null,void this.logger.warn("decode slow or network week.")}),9e4),this._timer=setTimeout((()=>this._nextDectection(1e3)),1e3)}_bufferWaiting(){this._playerState.waiting||this._playerState.decodeEnded&&this._playerState.loaded||(this.logger.info("buffer waiting callback"),this._playerState.waiting=!0,this.emit(js.MEDIA_WAITING),this._startWaitingBufferDetection())}_waitingEventByAudioBuffer(){this._media.audioBuffer.off(Jo.READ_EMPTY,this._waitingEventAudioBufferListener),this._media.audioBuffer.on(Jo.READ_EMPTY,this._waitingEventAudioBufferListener)}_waitingEventByVideoBuffer(){this._media.videoBuffer.off(es.READ_EMPTY,this._waitingEventVideoBufferListener),this._media.videoBuffer.on(es.READ_EMPTY,this._waitingEventVideoBufferListener)}cancelWaiting(){this._playAndClearTimer()}reset(){this.cancelWaiting(),this.resetBufferWaitingEvent()}_clearWaitingEventBind(){this._media.videoBuffer.off(es.READ_EMPTY,this._waitingEventVideoBufferListener),this._media.audioBuffer.off(Jo.READ_EMPTY,this._waitingEventAudioBufferListener)}resetBufferWaitingEvent(){this._clearWaitingEventBind(),this._media.info.noAudio?(this.logger.info("waiting event by video buffer."),this._waitingEventByVideoBuffer()):(this.logger.info("waiting event by audio buffer."),this._waitingEventByAudioBuffer())}onDecodeEnd(){this._playerState.loaded&&this.cancelWaiting()}resetTimer(){this._waitDurationTimer.reset()}destroy(){this.cancelWaiting(),this._media.videoBuffer.off(es.READ_EMPTY,this._waitingEventVideoBufferListener),this._media.audioBuffer.off(Jo.READ_EMPTY,this._waitingEventAudioBufferListener)}};Us([lo("0.plmd"),zs("design:type",Function),zs("design:paramtypes",[]),zs("design:returntype",void 0)],Vs.prototype,"_playingMedia",null),Us([lo("0.pact"),zs("design:type",Function),zs("design:paramtypes",[]),zs("design:returntype",void 0)],Vs.prototype,"_playAndClearTimer",null),Us([lo("0.ndtt"),zs("design:type",Function),zs("design:paramtypes",[Number]),zs("design:returntype",void 0)],Vs.prototype,"_nextDectection",null),Us([lo("0.swbd"),zs("design:type",Function),zs("design:paramtypes",[]),zs("design:returntype",void 0)],Vs.prototype,"_startWaitingBufferDetection",null),Us([lo("0.bfw",{callInfo:!1}),zs("design:type",Function),zs("design:paramtypes",[]),zs("design:returntype",void 0)],Vs.prototype,"_bufferWaiting",null),Us([lo("0.webab"),zs("design:type",Function),zs("design:paramtypes",[]),zs("design:returntype",void 0)],Vs.prototype,"_waitingEventByAudioBuffer",null),Us([lo("0.webab"),zs("design:type",Function),zs("design:paramtypes",[]),zs("design:returntype",void 0)],Vs.prototype,"_waitingEventByVideoBuffer",null),Us([lo("ccwt"),zs("design:type",Function),zs("design:paramtypes",[]),zs("design:returntype",void 0)],Vs.prototype,"cancelWaiting",null),Us([lo("rset"),zs("design:type",Function),zs("design:paramtypes",[]),zs("design:returntype",void 0)],Vs.prototype,"reset",null),Us([lo("bbwe"),zs("design:type",Function),zs("design:paramtypes",[]),zs("design:returntype",void 0)],Vs.prototype,"resetBufferWaitingEvent",null),Us([lo("dece"),zs("design:type",Function),zs("design:paramtypes",[]),zs("design:returntype",void 0)],Vs.prototype,"onDecodeEnd",null),Us([lo("rstt"),zs("design:type",Function),zs("design:paramtypes",[]),zs("design:returntype",void 0)],Vs.prototype,"resetTimer",null),Us([lo("dsty"),zs("design:type",Function),zs("design:paramtypes",[]),zs("design:returntype",void 0)],Vs.prototype,"destroy",null),Vs=Bs=Us([lo("rd.mwhr"),zs("design:paramtypes",[_o,ls,Ro])],Vs);var Hs,Ws=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},qs=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Gs=Hs=class{constructor(e,t,n){this._media=e,this._clock=t,this._logManager=n,this._lastPauseTime=-1,this._lastClockTime=-1,this.logger=this._logManager.classLogger(Hs)}startCount(){if(this._media.isMediaLegal()){if(this._lastPauseTime=performance.now(),this._lastClockTime=this._clock.getClock(),this._lastClockTime<=0)if(this._media.info.noAudio){const e=this._media.videoBuffer.front();e&&(this._lastClockTime=e.pts)}else{const e=this._media.audioBuffer.front();e&&(this._lastClockTime=e.pts)}this._media.lock()}}drop(){if(-1!==this._lastPauseTime&&this._media.isMediaLegal()){const e=(performance.now()-this._lastPauseTime)/1e3+this._lastClockTime;!this._media.info.noAudio&&this._media.audioBuffer.removeBeforePts(e),!this._media.info.noVideo&&this._media.videoBuffer.removeBeforePts(e),this._lastPauseTime=this._lastClockTime=-1,this._media.unlock(),this.logger.info("media play at new time: "+e)}}};Ws([lo("stc"),qs("design:type",Function),qs("design:paramtypes",[]),qs("design:returntype",void 0)],Gs.prototype,"startCount",null),Ws([lo("drp"),qs("design:type",Function),qs("design:paramtypes",[]),qs("design:returntype",void 0)],Gs.prototype,"drop",null),Gs=Hs=Ws([lo("rd.fdph"),qs("design:paramtypes",[ls,ps,_o])],Gs);var Ys,Zs=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Ks=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},$s=function(e,t){return function(n,i){t(n,i,e)}};let Xs=Ys=class{constructor(e,t,n,i){this._loggerManager=e,this._playerEventEmitter=t,this._audioClock=n,this._configState=i,this.seiCache=[],this.logger=this._loggerManager.classLogger(Ys),this._audioClock.on(ds.ClockUpdate,this.active.bind(this))}addSei(e,t){t<=0?this._playerEventEmitter.emit(yo.RECV_SEI,e):this.seiCache.push({sei:e,pts:t})}poll(){this.stopPoll(),this._pollTimer=setInterval(this.active.bind(this),50)}stopPoll(){this._pollTimer&&clearInterval(this._pollTimer)}active(){let e=0;for(e=this._configState.advanceConfig.videoPausedSeiNeeded?this._audioClock.getLiveClock():this._audioClock.getClock();0!=this.seiCache.length&&this.seiCache[0].pts<e-.2;)this.seiCache.shift();for(;0!=this.seiCache.length&&e-.2<=this.seiCache[0].pts&&this.seiCache[0].pts<=e+.05;){const{sei:e,pts:t}=this.seiCache.shift();this._playerEventEmitter.emit(yo.RECV_SEI,e)}}};Xs=Ys=Zs([nt(),lo("rd.sei"),$s(0,dt(_o)),$s(1,dt(bo)),$s(2,dt(ps)),$s(3,dt(Hr)),Ks("design:paramtypes",[_o,bo,ps,Hr])],Xs);var Js,Qs,ea=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},ta=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},na=function(e,t){return function(n,i){t(n,i,e)}},ia=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};!function(e){e.MEDIA_CAN_PLAY="mediaCanPlay"}(Qs||(Qs={}));let ra=Js=class extends Ir{get playable(){return void 0!==this._audioPlayer||void 0!==this._videoPlayer}get userPlayed(){return this._playerState.played}get rendering(){return this._rendering}get canvas(){return this._renderCanvas}constructor(e,t,n,i,r,o){super(),this._media=e,this._clock=t,this._playerState=n,this._logManager=i,this._seiHandler=r,this._configState=o,this._stream=new MediaStream,this._videoEl=null,this._isTempVideoEl=!1,this._rendering=!1,this._canplay=!1,this._mediaChanging=!1,this._renderCanvas=document.createElement("canvas"),this._detectAutoPlayTimer=null,this._fullScreenPrefixes=["","moz","webkit","ms"],this._videoElClickListener=()=>{this._audioPlayer&&this._audioPlayer.resume()},this._videoElPlayListener=()=>{this._videoOnPlay()},this._videoElPauseListener=()=>{this._videoOnPause()},this._videoElVolumechangeListener=()=>{this._videoOnVolumeChange()},this._onEnterFullScreen=()=>{this._isTempVideoEl&&this._videoEl&&(this._videoEl.style.display="block")},this._onOutFullScreen=()=>{if(this._isTempVideoEl&&this._divContainer&&this._videoEl){this._divContainer.contains(this._videoEl)&&this._divContainer.removeChild(this._videoEl);const e=this._isSafariMobile(this._videoEl);this._removeVideo(),this._isTempVideoEl=!1,this._renderCanvas.style.display="block",(this._playerState.played||e)&&this.play()}this._offFullScreenEvent()},this._fullscreenchangeListener=()=>{!this._isFullScreen()&&this._videoEl?this._onOutFullScreen():this._isFullScreen()&&this._videoEl&&this._onEnterFullScreen()},this.logger=this._logManager.classLogger(Js),this._media.isMediaLegal()&&this.reset(this._media.info),this._bindBackgroundHandler(),this._bindWaitingHandler(),this._bindMediaEvent(),this._frameDropHandler=new Gs(this._media,this._clock,this._logManager)}_bindBackgroundHandler(){this._backgroundHandler=new Is(this._playerState,this._logManager),this._backgroundHandler.on(Ds.SHOULD_PLAY,(()=>{this.play()})),this._backgroundHandler.on(Ds.SHOULD_PAUSE,(()=>{this.pause()}))}_bindWaitingHandler(){this._waitingHandler=new Vs(this._logManager,this._media,this._playerState),this._waitingHandler.on(js.MEDIA_REPLAY,(()=>{!this._mediaChanging&&this.userPlayed&&this._canplay&&this.mediaStartRender()})),this._waitingHandler.on(js.MEDIA_WAITING,(()=>{this._rendering&&this.userPlayed&&this.mediaPauseRender()}))}_bindMediaEvent(){this._media.on(rs.MEDIA_END,(()=>{this._onMediaPlayEnd()}))}_resetStream(){this._stream.getTracks().forEach((e=>{this._stream.removeTrack(e)})),this._videoPlayer&&this._videoPlayer.stream.getTracks().forEach((e=>{this._stream.addTrack(e)})),this._audioPlayer&&this._audioPlayer.stream.getTracks().forEach((e=>{this._stream.addTrack(e)}))}get stream(){return this._stream}isCanplay(){return this._canplay&&this._media.isMediaLegal()&&null!==this._stream}resume(){this._audioPlayer&&this._audioPlayer.resume(),this._waitingHandler.resetTimer()}_videoOnPlay(){this._audioPlayer&&"running"!==this._audioPlayer.ac.state&&this._audioPlayer.resume(),this.userPlayed?this.logger.info("media has played."):(this._playerState.waiting&&(this.logger.info("cancel waiting"),this._waitingHandler.cancelWaiting()),this.isCanplay()&&(this.logger.info("start render"),this._frameDropHandler.drop(),this._configState.advanceConfig.videoPausedSeiNeeded&&this._seiHandler.stopPoll(),this._setPlayed(!0),this.mediaStartRender()))}_videoOnPause(){this.userPlayed?(this._frameDropHandler.startCount(),this._configState.advanceConfig.videoPausedSeiNeeded&&this._seiHandler.poll(),this.mediaPauseRender(),this._setPlayed(!1)):this.logger.info("media has paused.")}_videoOnVolumeChange(){this._videoEl&&this.setMuted(this._videoEl.muted),this._videoEl&&this.setVolume(100*this._videoEl.volume)}_refreshConfigFromVideoEl(){if(!this._videoEl)throw new to("not video element set!");this._playerState.muted=this._videoEl.muted,this._playerState.volume=100*this._videoEl.volume,this.logger.info("video config set muted "+this._playerState.muted+" volume "+this._playerState.volume)}setVideo(e){if(this._videoEl)throw new to("cannot repeatly set video element");this._videoEl=e;this._videoEl&&this._refreshConfigFromVideoEl(),(()=>{this._videoEl&&this._videoEl.addEventListener("click",this._videoElClickListener),this._videoEl&&this._videoEl.addEventListener("play",this._videoElPlayListener),this._videoEl&&this._videoEl.addEventListener("pause",this._videoElPauseListener),this._videoEl&&this._videoEl.addEventListener("volumechange",this._videoElVolumechangeListener)})(),this._videoEl.srcObject=null}_removeVideo(){this._videoEl&&(this._videoEl&&this._videoEl.removeEventListener("click",this._videoElClickListener),this._videoEl&&this._videoEl.removeEventListener("play",this._videoElPlayListener),this._videoEl&&this._videoEl.removeEventListener("pause",this._videoElPauseListener),this._videoEl&&this._videoEl.removeEventListener("volumechange",this._videoElVolumechangeListener),this._videoEl=null)}endVideo(){this._videoEl&&(this._videoEl.srcObject=null,this._videoEl.poster="",this._videoEl.pause()),this._canplay=!1,this._waitingHandler.cancelWaiting(),this.mediaPauseRender()}_resetAudioPlayer(e){if(e.noAudio)return this.logger.info("audio player set null"),this._audioPlayer&&this._audioPlayer.destroy(),void(this._audioPlayer=void 0);this._audioPlayer&&e.sampleRate===this._audioPlayer.sampleRate?this._audioPlayer&&this._audioPlayer.reset(this._clock):(this._audioPlayer&&this._audioPlayer.destroy(),this._audioPlayer=new vs(this._media,this._clock,this._playerState,this._logManager))}_resetVideoPlayer(e){if(e.noVideo)return this.logger.info("video player set null"),this._videoPlayer&&this._videoPlayer.destroy(),void(this._videoPlayer=void 0);this._videoPlayer&&this._videoPlayer.destroy(),this._videoPlayer=new Ss(this._media,this._clock,this._logManager,this._renderCanvas)}_updateVideoSrcObject(e){return ia(this,void 0,void 0,(function*(){if(!this._videoEl)throw new to("video not bind");if(null===this._videoEl.srcObject&&(this.logger.info("set video stream"),this._videoEl.srcObject=e),this._videoEl.autoplay&&this._videoEl.paused){clearTimeout(this._detectAutoPlayTimer);const e=()=>{var e;if(clearTimeout(this._detectAutoPlayTimer),null===(e=this._videoEl)||void 0===e?void 0:e.paused)throw this.logger.error("video element auto play failed."),new ro("Auto play failed. Please call play() method after click.")};this._detectAutoPlayTimer=setTimeout((()=>{e()}),3e3),this._videoEl.play().then((()=>{this._videoEl&&!this._videoEl.paused&&clearTimeout(this._detectAutoPlayTimer)})).catch((t=>{e()}))}}))}_resetVideoElement(){this._videoEl&&this._refreshConfigFromVideoEl(),this._media.lastMediaInfo.validate()&&this._media.info.noVideo!==this._media.lastMediaInfo.noVideo&&this._videoEl&&(this._videoEl.srcObject=null),this._resetStream(),this._videoEl&&this._updateVideoSrcObject(this._stream)}reset(e){this._canplay=!1,this._media.isMediaLegal()&&(this.logger.info("media legal and reset media player"),this._clock.reset(),this._resetAudioPlayer(e),this._resetVideoPlayer(e),this._waitingHandler.reset(),this._resetVideoElement(),this._restartPlay(),this._canplay=!0,this._waitingHandler.cancelWaiting(),this.userPlayed||(this._frameDropHandler.startCount(),this._configState.advanceConfig.videoPausedSeiNeeded&&this._seiHandler.poll()),this.emit(Qs.MEDIA_CAN_PLAY),this._playerState.mediaOpened=!0)}_restartPlay(){this.userPlayed&&(this.logger.info("restart play"),this.setMuted(this._playerState.muted),this.setVolume(this._playerState.volume),this.mediaStartRender())}_onMediaPlayEnd(){this._playerState.mediaPlayEnded||(this._playerState.mediaPlayEnded=!0),this._videoEl&&!this._videoEl.paused&&this._videoEl.pause()}mediaStartRender(){if(this._videoEl&&this._videoEl.paused)this.userPlayed&&(this.logger.info("set play false"),this._setPlayed(!1));else if(this._videoEl&&null===this._videoEl.srcObject)this.logger.info("video el no source");else if(this._media.isMediaLegal()&&!this._playerState.waiting&&!this._mediaChanging){if(this._playerState.decodeEnded&&this._playerState.loaded&&this._media.isEmpty()&&!this._playerState.mediaPlayEnded)return void this._onMediaPlayEnd();this.logger.info("media play."),this._rendering=!0,this._audioPlayer&&this._audioPlayer.play(),this._videoPlayer&&this._videoPlayer.play()}}mediaPauseRender(){this.logger.info("media pause."),this._rendering=!1,this._audioPlayer&&this._audioPlayer.pause(),this._videoPlayer&&this._videoPlayer.pause()}_setPlayed(e){e?this._playerState.played=!0:this._playerState.paused=!0}play(){this._videoEl&&this._videoEl.paused?this._videoEl.play():this._videoOnPlay()}pause(){this._videoEl&&!this._videoEl.paused?this._videoEl.pause():this._videoOnPause()}setVolume(e){this._playerState.muted||this._playerState.volume===e||this._audioPlayer&&this._audioPlayer.setVolume(e),this._playerState.volume=e}setMuted(e){this._playerState.muted=e,e?this._audioPlayer&&this._audioPlayer.setVolume(0):this._audioPlayer&&this._audioPlayer.setVolume(this._playerState.volume)}onDecodeEnd(){this._waitingHandler.onDecodeEnd()}onMediaChanging(){this._mediaChanging=!0}onMediaChangingEnd(){this._mediaChanging=!1}_requestFullScreen(e){e&&(this._bindFullScreenEvent(),e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.webkitSupportsFullscreen&&e.webkitEnterFullscreen&&e.webkitEnterFullscreen())}_isSafariMobile(e){return!e.requestFullscreen&&!e.mozRequestFullScreen&&!e.webkitRequestFullscreen&&!e.msRequestFullscreen&&e.webkitEnterFullscreen}_exitFullScreen(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}_isFullScreen(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement||this._videoEl&&this._videoEl.webkitDisplayingFullscreen}_bindFullScreenEvent(){this._fullScreenPrefixes.forEach((e=>{document.addEventListener(e+"fullscreenchange",this._fullscreenchangeListener)})),this._videoEl&&(this._videoEl.addEventListener("webkitendfullscreen",this._onOutFullScreen),this._videoEl.addEventListener("webkitenterfullscreen",this._onEnterFullScreen))}_offFullScreenEvent(){this._fullScreenPrefixes.forEach((e=>{document.removeEventListener(e+"fullscreenchange",this._fullscreenchangeListener)})),this._videoEl&&(this._videoEl.removeEventListener("webkitendfullscreen",this._onOutFullScreen),this._videoEl.removeEventListener("webkitenterfullscreen",this._onEnterFullScreen))}fullScreen(){if(this._videoEl||!this._divContainer||this._isTempVideoEl)this._videoEl&&!this._isTempVideoEl&&this._requestFullScreen(this._videoEl);else{const e=document.createElement("video");if(e.muted=this._playerState.muted,e.controls=!0,e.disablePictureInPicture=!0,e.width=this._renderCanvas.clientWidth,e.height=this._renderCanvas.clientHeight,e.playsInline=!0,e.style.display="none",this.setVideo(e),this._resetVideoElement(),this._isTempVideoEl=!0,this._videoPlayer&&(e.poster=this._videoPlayer.captureImage()),this._playerState.played&&e.play(),!this._divContainer||!this._videoEl)return;if(this._divContainer.contains(this._renderCanvas)&&(this._renderCanvas.style.display="none"),this._divContainer.appendChild(e),this._isSafariMobile(e))e.addEventListener("loadeddata",(()=>{setTimeout((()=>{try{this._isFullScreen()||(this._requestFullScreen(e),e.style.display="block")}catch(e){}}),10)}));else try{this._isFullScreen()||this._requestFullScreen(e)}catch(e){}}}destroy(){this._videoEl&&(this._videoEl.srcObject=null),this._videoEl&&(this._videoEl.poster=""),this._divContainer&&this._divContainer.removeChild(this._renderCanvas),this._divObserver&&this._divObserver.disconnect(),this._audioPlayer&&this._audioPlayer.destroy(),this._videoPlayer&&this._videoPlayer.destroy(),this._waitingHandler.destroy(),this._canplay=!1,this._media.updateMedia(new Or),this._removeVideo(),this._offFullScreenEvent()}bindContainer(e){e.appendChild(this._renderCanvas);const t=e.attributes["zg-width"];t&&t.value&&(this._renderCanvas.style.width=t.value+"px");const n=e.attributes["zg-height"];n&&n.value&&(this._renderCanvas.style.height=n.value+"px"),this._divObserver=new MutationObserver((e=>{e.forEach((e=>{if("attributes"===e.type)switch(e.attributeName){case"zg-width":{const t=e.target.getAttribute(e.attributeName);this._renderCanvas.style.width=t?t+"px":"";break}case"zg-height":{const t=e.target.getAttribute(e.attributeName);this._renderCanvas.style.height=t?t+"px":"";break}}}))})),this._divContainer=e,this._divObserver.observe(e,{attributes:!0})}clearRender(){this._videoPlayer&&this._videoPlayer.clearCanvas()}};var oa;ea([lo("0.bkgh"),ta("design:type",Function),ta("design:paramtypes",[]),ta("design:returntype",void 0)],ra.prototype,"_bindBackgroundHandler",null),ea([lo("0.bwhl"),ta("design:type",Function),ta("design:paramtypes",[]),ta("design:returntype",void 0)],ra.prototype,"_bindWaitingHandler",null),ea([lo("0.bmde"),ta("design:type",Function),ta("design:paramtypes",[]),ta("design:returntype",void 0)],ra.prototype,"_bindMediaEvent",null),ea([lo("0.rst"),ta("design:type",Function),ta("design:paramtypes",[]),ta("design:returntype",void 0)],ra.prototype,"_resetStream",null),ea([lo("rsum"),ta("design:type",Function),ta("design:paramtypes",[]),ta("design:returntype",void 0)],ra.prototype,"resume",null),ea([lo("0.vopl"),ta("design:type",Function),ta("design:paramtypes",[]),ta("design:returntype",void 0)],ra.prototype,"_videoOnPlay",null),ea([lo("0.vopu"),ta("design:type",Function),ta("design:paramtypes",[]),ta("design:returntype",void 0)],ra.prototype,"_videoOnPause",null),ea([lo("0.rcfve"),ta("design:type",Function),ta("design:paramtypes",[]),ta("design:returntype",void 0)],ra.prototype,"_refreshConfigFromVideoEl",null),ea([lo("svo"),ta("design:type",Function),ta("design:paramtypes",[HTMLVideoElement]),ta("design:returntype",void 0)],ra.prototype,"setVideo",null),ea([lo("0.rmvo"),ta("design:type",Function),ta("design:paramtypes",[]),ta("design:returntype",void 0)],ra.prototype,"_removeVideo",null),ea([lo("edv"),ta("design:type",Function),ta("design:paramtypes",[]),ta("design:returntype",void 0)],ra.prototype,"endVideo",null),ea([lo("0.rsaup"),ta("design:type",Function),ta("design:paramtypes",[Or]),ta("design:returntype",void 0)],ra.prototype,"_resetAudioPlayer",null),ea([lo("0.rsvdp"),ta("design:type",Function),ta("design:paramtypes",[Or]),ta("design:returntype",void 0)],ra.prototype,"_resetVideoPlayer",null),ea([lo("0.udvso"),ta("design:type",Function),ta("design:paramtypes",[MediaStream]),ta("design:returntype",Promise)],ra.prototype,"_updateVideoSrcObject",null),ea([lo("0.rstve"),ta("design:type",Function),ta("design:paramtypes",[]),ta("design:returntype",void 0)],ra.prototype,"_resetVideoElement",null),ea([lo("rst"),ta("design:type",Function),ta("design:paramtypes",[Or]),ta("design:returntype",void 0)],ra.prototype,"reset",null),ea([lo("0.rstp"),ta("design:type",Function),ta("design:paramtypes",[]),ta("design:returntype",void 0)],ra.prototype,"_restartPlay",null),ea([lo("0.ompe"),ta("design:type",Function),ta("design:paramtypes",[]),ta("design:returntype",void 0)],ra.prototype,"_onMediaPlayEnd",null),ea([lo("mdsr"),ta("design:type",Function),ta("design:paramtypes",[]),ta("design:returntype",void 0)],ra.prototype,"mediaStartRender",null),ea([lo("mdpr"),ta("design:type",Function),ta("design:paramtypes",[]),ta("design:returntype",void 0)],ra.prototype,"mediaPauseRender",null),ea([lo("pl"),ta("design:type",Function),ta("design:paramtypes",[]),ta("design:returntype",void 0)],ra.prototype,"play",null),ea([lo("pau"),ta("design:type",Function),ta("design:paramtypes",[]),ta("design:returntype",void 0)],ra.prototype,"pause",null),ea([lo("odde"),ta("design:type",Function),ta("design:paramtypes",[]),ta("design:returntype",void 0)],ra.prototype,"onDecodeEnd",null),ea([lo("omci"),ta("design:type",Function),ta("design:paramtypes",[]),ta("design:returntype",void 0)],ra.prototype,"onMediaChanging",null),ea([lo("omce"),ta("design:type",Function),ta("design:paramtypes",[]),ta("design:returntype",void 0)],ra.prototype,"onMediaChangingEnd",null),ea([lo("fuscn"),ta("design:type",Function),ta("design:paramtypes",[]),ta("design:returntype",void 0)],ra.prototype,"fullScreen",null),ea([lo("dsty"),ta("design:type",Function),ta("design:paramtypes",[]),ta("design:returntype",void 0)],ra.prototype,"destroy",null),ea([lo("bctn"),ta("design:type",Function),ta("design:paramtypes",[HTMLDivElement]),ta("design:returntype",void 0)],ra.prototype,"bindContainer",null),ra=Js=ea([nt(),lo("rd.mdp"),na(0,dt(ls)),na(1,dt(ps)),na(2,dt(Ro)),na(3,dt(_o)),na(4,dt(Xs)),na(5,dt(Hr)),ta("design:paramtypes",[ls,ps,Ro,_o,Xs,Hr])],ra),function(e){e.CHANGING_START="MediachangeStart",e.CHANGING_END="MediachangeEnd"}(oa||(oa={}));class sa extends Ir{constructor(e){super(),this._mediaPlayer=e,this._shouldReplayMedia=!1,this._changing=!1}get changing(){return this._changing}mediaChanging(){this._changing||(this._changing=!0,this._mediaPlayer.onMediaChanging(),this._shouldReplayMedia=this._mediaPlayer.userPlayed,this._shouldReplayMedia&&this._mediaPlayer.mediaPauseRender(),this.emit(oa.CHANGING_START))}cancelMediaChanging(){this._changing=!1,this._mediaPlayer.onMediaChangingEnd(),this._shouldReplayMedia&&this._mediaPlayer.mediaStartRender(),this._shouldReplayMedia=!1,this.emit(oa.CHANGING_END)}}var aa,la=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},da=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ua=function(e,t){return function(n,i){t(n,i,e)}},ca=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};let ha=aa=class{constructor(e,t,n,i,r){this._media=e,this._mediaPlayer=t,this._playerState=n,this._seiHandler=i,this._loggerManager=r,this._pMap=new Cr,this._mediaChangingOperater=new sa(this._mediaPlayer),this.logger=this._loggerManager.classLogger(aa),this._media.postMessage=e=>{this.postMessage(e)},this._media.videoBuffer.postMessage=e=>{this.postMessage(e)},this._media.audioBuffer.postMessage=e=>{this.postMessage(e)}}_pushAudioBuffer(e){this._media.audioBuffer.push(e)}_pushVideoBuffer(e){this._media.videoBuffer.push(e)}terminate(){this.stop(),this._mediaPlayer.destroy()}stop(){this._mediaChangingOperater.cancelMediaChanging(),this._mediaPlayer.endVideo(),this._media.clear()}bindVideoElement(e){this._mediaPlayer.setVideo(e)}postMessage(e){}onmessage(e){switch(e.type){case lt.PLAY:this.logger.info("msg: ",e.type),this.play();break;case Xo.PUSH_AUDIO_BUFFER:this._pushAudioBuffer(e.data);break;case Xo.PUSH_VIDEO_BUFFER:this._pushVideoBuffer(e.data);break;case Xo.DECODE_END:this.logger.info("msg: ",e.type),this.onDecodeEnd();break;case lt.PAUSE:this.logger.info("msg: ",e.type),this.pause();break;case Xo.MEDIA_INFO_UPDATE:this.logger.info("msg: ",e.type),this.updateMediaInfo(e.data);break;case lt.SRC_CHANGED:this.logger.info("msg: ",e.type),this._mediaChangingOperater.mediaChanging();break;case lt.SET_VOLUME:this.logger.info("msg: ",e.type,e.data),this._mediaPlayer.setVolume(e.data.volume);break;case lt.STOP:this.logger.info("msg: ",e.type),this.stop();break;case Xo.MEDIA_NOT_FETCH:this.logger.info("msg: "+e.type),this.stop();break;case Xo.RECV_SEI_DATA:{const{sei:t,pts:n}=e.data;this._seiHandler.addSei(t,n);break}default:this.logger.error("unknown msg type: ",e.type)}}play(){return ca(this,void 0,void 0,(function*(){const e=this._pMap.get("play");e.reset();let t=null,n=null;this._media.unlock(),e.add(new Mr(((e,t)=>{this._mediaPlayer.playable?e():(n=()=>e(),this._mediaPlayer.once(Qs.MEDIA_CAN_PLAY,n))})),new Mr(((e,n)=>{this._mediaChangingOperater.changing?(t=()=>e(),this._mediaChangingOperater.once(oa.CHANGING_END,t)):e()})));try{yield e.all()}catch(e){if(e===Sr)return n&&this._mediaPlayer.off(Qs.MEDIA_CAN_PLAY,n),void(t&&this._mediaChangingOperater.off(oa.CHANGING_END,t));throw e}this._mediaPlayer.play()}))}pause(){this._mediaPlayer.pause()}updateMediaInfo(e){const t=new Or(e);t.validate()&&(this._mediaChangingOperater.changing||this._mediaChangingOperater.mediaChanging(),this._media.removeAllListeners(rs.BUFFER_CAN_PLAY),this._media.once(rs.BUFFER_CAN_PLAY,(()=>{this._mediaPlayer.reset(t),this._mediaChangingOperater.cancelMediaChanging(),this.logger.info("update media info success!")})),this._media.updateMedia(t))}onDecodeEnd(){this._mediaPlayer.onDecodeEnd(),this._playerState.loaded&&this._mediaChangingOperater.changing&&this._mediaChangingOperater.cancelMediaChanging()}resume(){this._mediaPlayer.resume()}setMuted(e){this._mediaPlayer.setMuted(e)}getCanvas(){return this._mediaPlayer.canvas}fullScreen(){this._mediaPlayer.fullScreen()}bindContainer(e){this._mediaPlayer.bindContainer(e)}};la([lo("tmi"),da("design:type",Function),da("design:paramtypes",[]),da("design:returntype",void 0)],ha.prototype,"terminate",null),la([lo("stp"),da("design:type",Function),da("design:paramtypes",[]),da("design:returntype",void 0)],ha.prototype,"stop",null),la([lo("bve"),da("design:type",Function),da("design:paramtypes",[HTMLVideoElement]),da("design:returntype",void 0)],ha.prototype,"bindVideoElement",null),la([lo("omsg",{callInfo:!1}),da("design:type",Function),da("design:paramtypes",[Object]),da("design:returntype",void 0)],ha.prototype,"onmessage",null),la([lo("ply"),da("design:type",Function),da("design:paramtypes",[]),da("design:returntype",Promise)],ha.prototype,"play",null),la([lo("pse"),da("design:type",Function),da("design:paramtypes",[]),da("design:returntype",void 0)],ha.prototype,"pause",null),la([lo("umif"),da("design:type",Function),da("design:paramtypes",[Object]),da("design:returntype",void 0)],ha.prototype,"updateMediaInfo",null),la([lo("odce"),da("design:type",Function),da("design:paramtypes",[]),da("design:returntype",void 0)],ha.prototype,"onDecodeEnd",null),la([lo("rsm"),da("design:type",Function),da("design:paramtypes",[]),da("design:returntype",void 0)],ha.prototype,"resume",null),la([lo("smd"),da("design:type",Function),da("design:paramtypes",[Boolean]),da("design:returntype",void 0)],ha.prototype,"setMuted",null),la([lo("gcvs"),da("design:type",Function),da("design:paramtypes",[]),da("design:returntype",void 0)],ha.prototype,"getCanvas",null),la([lo("fusc"),da("design:type",Function),da("design:paramtypes",[]),da("design:returntype",void 0)],ha.prototype,"fullScreen",null),la([lo("cdiv"),da("design:type",Function),da("design:paramtypes",[HTMLDivElement]),da("design:returntype",void 0)],ha.prototype,"bindContainer",null),ha=aa=la([nt(),lo("rd.rnd"),ua(0,dt(ls)),ua(1,dt(ra)),ua(2,dt(Ro)),ua(3,dt(Xs)),ua(4,dt(_o)),da("design:paramtypes",[ls,ra,Ro,Xs,_o])],ha);var pa,fa=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},_a=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ga=function(e,t){return function(n,i){t(n,i,e)}};let ya=pa=class{constructor(e,t){this._playerEmitter=e,this._loggerManager=t,this.logger=this._loggerManager.classLogger(pa)}_handleZegoError(e){const{code:t,msg:n}=JSON.parse(e.message);if(this.logger.error("error: "+JSON.stringify({code:t,msg:n})),0===this._playerEmitter.listenerCount(yo.ERROR))throw e;this._playerEmitter.emit(yo.ERROR,{code:t,msg:n})}_handleErrorLog(e){this.logger.info("catch error: ",e.message)}postMessage(e){}onmessage(e){const{type:t}=e;switch(t){case"onzegoerror":{const{error:t}=e.data;this._handleZegoError(t);break}case"onerrorlog":{const{error:t}=e.data;this._handleErrorLog(t);break}default:throw new to("unknown message type "+t)}}terminate(){}};fa([lo("hzer",{callInfo:!1}),_a("design:type",Function),_a("design:paramtypes",[Error]),_a("design:returntype",void 0)],ya.prototype,"_handleZegoError",null),fa([lo("lger",{callInfo:!1}),_a("design:type",Function),_a("design:paramtypes",[Error]),_a("design:returntype",void 0)],ya.prototype,"_handleErrorLog",null),fa([lo("omsg"),_a("design:type",Function),_a("design:paramtypes",[Object]),_a("design:returntype",void 0)],ya.prototype,"onmessage",null),ya=pa=fa([nt(),lo("0.errh"),ga(0,dt(bo)),ga(1,dt(_o)),_a("design:paramtypes",[bo,_o])],ya);var ma,va=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},wa=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let ba=ma=class{constructor(e){this._lastNetworkRequestTime=0,this._networkFetchTime=0,this.logger=e.classLogger(ma)}reset(){this._lastNetworkRequestTime=0,this._networkFetchTime=0}networkRequestStart(){this._lastNetworkRequestTime=performance.now()}fetchedFirstData(){this._lastNetworkRequestTime>0&&(this._networkFetchTime=performance.now()-this._lastNetworkRequestTime,this.logger.info(`network fetch time cost: ${this._networkFetchTime.toFixed(2)} ms`))}};ba=ma=va([lo("qlt.net"),wa("design:paramtypes",[_o])],ba);var Ea,Aa=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Ra=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Pa=Ea=class{constructor(e){this._lastRenderRequestTime=0,this._audioFirstFrameTime=0,this._videoFirstFrameTime=0,this.logger=e.classLogger(Ea)}reset(){this._lastRenderRequestTime=0,this._audioFirstFrameTime=0,this._videoFirstFrameTime=0}renderRequestStart(){this._lastRenderRequestTime=performance.now()}renderFailed(){this._lastRenderRequestTime=0,this.logger.info("renderFailed recv")}firstAudioFrame(){this._lastRenderRequestTime>0&&(this._audioFirstFrameTime=performance.now()-this._lastRenderRequestTime,this.logger.info(`First audio frame time cost: ${this._audioFirstFrameTime.toFixed(2)} ms`))}firstVideoFrame(){this._lastRenderRequestTime>0&&(this._videoFirstFrameTime=performance.now()-this._lastRenderRequestTime,this.logger.info(`First video frame time cost: ${this._videoFirstFrameTime.toFixed(2)} ms`))}};Pa=Ea=Aa([lo("plt.rnd"),Ra("design:paramtypes",[_o])],Pa);var Ta,ka=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Sa=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ca=function(e,t){return function(n,i){t(n,i,e)}};let Da=Ta=class{constructor(e){this._loggerManager=e,this.logger=this._loggerManager.classLogger(Ta),this._networkStatistic=new ba(this._loggerManager),this._renderStatistic=new Pa(this._loggerManager)}postMessage(e){}onmessage(e){switch(this.logger.info("msg: ",e.type),e.type){case Io.ResetStatistic:this._networkStatistic.reset(),this._renderStatistic.reset();break;case Io.MediaStartRequest:this._networkStatistic.networkRequestStart(),this._renderStatistic.renderRequestStart();break;case Io.NetworkStartDownloadBody:this._networkStatistic.fetchedFirstData();break;case Io.NetworkFetchFailed:this._networkStatistic.reset(),this._renderStatistic.reset();break;case Io.VideoFirstFrameRecv:this._renderStatistic.firstVideoFrame();break;case Io.AudioFirstFrameRecv:this._renderStatistic.firstAudioFrame();break;case Io.AudioRenderFailed:case Io.VideoRenderFailed:this._renderStatistic.renderFailed();default:this.logger.error("unknown msg type: ",e.type)}}terminate(){}};Da=Ta=ka([nt(),lo("qlt.0"),Ca(0,dt(_o)),Sa("design:paramtypes",[_o])],Da);var Ma,xa=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Ia=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Fa=function(e,t){return function(n,i){t(n,i,e)}},Oa=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};let La=Ma=class{constructor(e,t,n,i,r,o){this._render=e,this._playerEmitter=t,this._dataManager=n,this._loggerManager=i,this._errorHandler=r,this._qualityStatisticContext=o,this._map=new Map,this._destroied=!1,this._loaded=!1,this._cacheMsg=[],this._registerWorkerTags=[xr.DECODER],this._registerObjectTags=[xr.RENDER,xr.EVENT_EMITTER,xr.DATA_MANAGER,xr.LOGGER_MANAGER,xr.ERROR_HANDLER,xr.QUALITY_STATISTIC],this.logger=this._loggerManager.classLogger(Ma),this._registerWorkerTags.forEach(((e,t)=>Oa(this,void 0,void 0,(function*(){yield this.load(e),t===this._registerWorkerTags.length-1&&(this._loaded=!0,this._cacheMsg.forEach((e=>{this.dispatchMessage(e)})),this._cacheMsg=[])})))),this._registerObjectTags.forEach((e=>this.load(e)))}_createDispatchable(e){return Oa(this,void 0,void 0,(function*(){switch(e){case xr.DECODER:try{return new Worker(new URL(n.p+n.u(691),n.b))}catch(e){throw new to("cannot create worker 'decoder'. "+e.message)}case xr.RENDER:return this.logger.info("register render."),this._render;case xr.EVENT_EMITTER:return this.logger.info("register event emitter."),this._playerEmitter;case xr.DATA_MANAGER:return this.logger.info("register data manager."),this._dataManager;case xr.LOGGER_MANAGER:return this.logger.info("register logger manager."),this._loggerManager;case xr.ERROR_HANDLER:return this.logger.info("register error handler."),this._errorHandler;case xr.QUALITY_STATISTIC:return this.logger.info("register error handler."),this._qualityStatisticContext;default:throw new to("unknown worker tag "+e)}}))}onReceiveMessage(e){}dispatchMessage(e){if(this._destroied)throw new to("player destroied!");if(so.bind(e).is.exist.then(e.type).exist.then(e.target).exist.catch((()=>{throw new to("dispatcher error, illegal message.")})),!this._loaded)return void this._cacheMsg.push(e);const t=e.target;if(this._registerWorkerTags.some((e=>e===t))){const n=this._map.get(t);n&&n.postMessage(e)}else{if(!this._registerObjectTags.some((e=>e===t)))throw new to("can not dispatch message , target: "+t);{const n=this._map.get(t);n&&n.onmessage(e)}}}load(e){return Oa(this,void 0,void 0,(function*(){this._map.get(e)||this._map.set(e,yield this._createDispatchable(e));const t=this._map.get(e);if(!t)throw new to("cannot dispatch target: "+e);t instanceof window.Worker?t.onmessage=e=>{const{data:t}=e;this.dispatchMessage(t)}:t.postMessage=e=>{this.dispatchMessage(e)}}))}destroy(){this._map.forEach((e=>{e.terminate()})),this._destroied=!0}};xa([lo("cdpt",{callInfo:!1}),Ia("design:type",Function),Ia("design:paramtypes",[String]),Ia("design:returntype",Promise)],La.prototype,"_createDispatchable",null),La=Ma=xa([nt(),lo("dspt"),Fa(0,dt(ha)),Fa(1,dt(bo)),Fa(2,dt(Mo)),Fa(3,dt(_o)),Fa(4,dt(ya)),Fa(5,dt(Da)),Ia("design:paramtypes",[Object,bo,Mo,_o,ya,Da])],La);class Na{constructor(e,t){this._global=e,this._postMessage=t,this._log=!1,this._errorMap=new Map}_postError(e){const t={target:xr.ERROR_HANDLER,type:"onzegoerror",data:{error:e}};if(this._postMessage)this._postMessage(t);else{if(!this._global.postMessage)throw new to("Cannot post error to ErrorHandler.");this._global.postMessage(t)}}_postLog(e){const t={target:xr.ERROR_HANDLER,type:"onerrorlog",data:{error:e}};if(this._postMessage)this._postMessage(t);else{if(!this._global.postMessage)throw new to("Cannot post error to ErrorHandler.");this._global.postMessage(t)}}_logError(e){const t=e.error&&e.error.message||e.message;this._postLog(new Error(t))}_logRejection(e){const t=e.reason&&e.reason.message||"unhandledrejection";this._postLog(new Error(t))}_handleError(e){const t=e.error;return!t||t.name!==Wr||(this._errorMap.get(t)||(this._errorMap.set(t,!0),this._postError(t)),e.preventDefault(e),e.stopPropagation(),!1)}_handleRejection(e){const t=e.reason;return!t||t.name!==Wr||(this._errorMap.get(t)||(this._errorMap.set(t,!0),this._postError(t)),e.preventDefault(e),e.stopPropagation(),!1)}listen(){this._global.addEventListener("error",(e=>(this._log&&this._logError(e),this._handleError(e)))),this._global.addEventListener("unhandledrejection",(e=>(this._log&&this._logRejection(e),this._handleRejection(e))))}enableLog(){this._log=!0}}var Ba,ja=n(701),Ua=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},za=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Va=function(e,t){return function(n,i){t(n,i,e)}},Ha=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};const Wa=((e,t=21)=>((e,t,n)=>{let i=(2<<Math.log(e.length-1)/Math.LN2)-1,r=-~(1.6*i*t/e.length);return(o=t)=>{let s="";for(;;){let t=n(r),a=r;for(;a--;)if(s+=e[t[a]&i]||"",s.length===o)return s}}})(e,t,Br))(ja.numbers,8);let qa=Ba=class{_environmentCheck(){if(!(window.WebAssembly&&(window.AudioContext||window.webkitAudioContext)&&window.WebGLRenderingContext&&window.Worker&&window.AbortController)){const e=`\n          environment not support!\n          window.WebAssembly: ${!!window.WebAssembly},\n          window.AudioContext: ${!!window.AudioContext}\n          window.webkitAudioContext : ${!!window.webkitAudioContext}\n          window.WebGLRenderingContext: ${!!window.WebGLRenderingContext}\n          window.Worker: ${!!window.Worker}\n          window.AbortController: ${!!window.AbortController}\n        `;throw this.logger.error(e),new eo(e)}}_seiConfigUpdate(){var e;const t=null===(e=this._engineInjections)||void 0===e?void 0:e.seiConfig();this._dispatcher.dispatchMessage({target:xr.DECODER,type:Xo.SET_SEI_CONFIG,data:{seiConfig:t}})}get destroyed(){return this._playerState.destroy}constructor(e,t,n,i,r,o){this._playerState=e,this._configState=t,this._render=n,this._dispatcher=i,this._playerEmitter=r,this._loggerManager=o,this._validated=!1,this._playerReceiver={sendMsg:e=>{if("SEIConfigUpdate"===e.type)this._seiConfigUpdate()}},this._errorListener=new Na(window,(e=>{this._dispatcher.dispatchMessage(e)})),this._errorListener.listen(),this.logger=this._loggerManager.classLogger(Ba)}_stateCheck(){if(!this._validated)throw new to("player is not validated. Please use verify() and pass in the correct token and userID.");if(this.destroyed)throw new to("player destroied!")}initConfig(e,t,n){so.bind(e).is.exist.catch((()=>{throw new Qr("config is needed. example: 'var player = new Player(..., { /* config here */  });'")})).verify((e=>!(e.videoElement&&e.container))).catch((()=>{throw new Qr("Simultaneous use of parameter 'videoElement' and parameter 'container' is not allowed.")})).hasKey("mode").then(e.mode).eq("live").catch((()=>{throw new Qr("param 'mode' should be set 'live'. example: 'var player = new Player(..., { ... , mode: \"live\");'")})),so.bind(t).is.exist.hasKey("appid").hasKey("logger").hasKey("validateToken").hasKey("seiConfig").hasKey("addReceiver").hasKey("removeReceiver").catch((()=>{throw new to("player lacks injection from sdk, initialization failed! This may be caused by the version of 'zego-express-engine-webrtc' package being too low.")})),t.addReceiver(this._playerReceiver),this._validated=n||t.isLogin&&t.isLogin(),this._loggerManager.setZegoLogger(t.logger),this._configState.setConfig({appid:t.appid,version:Ur}),e.videoElement&&this.setVideoEl(e.videoElement),e.container&&this._render.bindContainer(e.container),this._engineInjections=t,this._environmentCheck(),t.seiConfig()&&this._seiConfigUpdate(),this.logger.info("player init success.")}verifyToken(e,t){var n;return Ha(this,void 0,void 0,(function*(){if(this._validated)return!0;so.expect(e).typeof("string").catch((()=>{throw new Qr("token need to be string")})).then(t).typeof("string").catch((()=>{throw new Qr("userID need to be string")}));const i=yield null===(n=this._engineInjections)||void 0===n?void 0:n.validateToken(e,t);return this._validated=!!i,this._validated}))}setUrl(e){this._stateCheck(),so.expect(e).typeof("string").catch((()=>{throw new Qr("url need to be string")})).verify((e=>""===e||Fr.isFlvMediaSource(e))).catch((()=>{throw new Qr("The URL of the media resource only supports 'flv' format")})),""!==e&&(e=Fr.change2fullPath(e)),this.logger.info("set url to "+e),this._playerState.url=e,this._dispatcher.dispatchMessage({target:xr.QUALITY_STATISTIC,type:Io.ResetStatistic}),""!==e?(this._playerState.taskID=Number.parseInt(Wa()),this._dispatcher.dispatchMessage({target:xr.RENDER,type:lt.SRC_CHANGED}),this._dispatcher.dispatchMessage({target:xr.DECODER,type:lt.SRC_CHANGED,data:{url:e}}),this._dispatcher.dispatchMessage({target:xr.QUALITY_STATISTIC,type:Io.MediaStartRequest})):this.stop()}getUrl(){return this._stateCheck(),this._playerState.url}play(){this._stateCheck(),this._render.resume(),this._render.play()}pause(){this._stateCheck(),this._render.pause()}setVideoEl(e){this._render.bindVideoElement(e)}resume(){this._stateCheck(),this._playerState.url&&(this._render.resume(),this.setUrl(this._playerState.url),this.play())}getCurrentTime(){return this._stateCheck(),this._playerState.currentTime}getPlayed(){return this._stateCheck(),this._playerState.played}getPaused(){return this._stateCheck(),this._playerState.paused}getVolume(){return this._stateCheck(),this._playerState.volume}getDuration(){return this._stateCheck(),this._playerState.duration}getMediaInfo(){return this._stateCheck(),this._playerState.mediaInfo.info}getCanvas(){return this._stateCheck(),this._render.getCanvas()}setVolume(e){this._stateCheck(),so.expect(e).typeof("number").range([0,100]).catch((()=>{throw new Qr("volume must be in the interval [0, 100].")})),this._dispatcher.dispatchMessage({target:xr.RENDER,type:lt.SET_VOLUME,data:{volume:e}})}_stop(){this._dispatcher.dispatchMessage({target:xr.DECODER,type:lt.STOP}),this._dispatcher.dispatchMessage({target:xr.RENDER,type:lt.STOP})}stop(){this._stateCheck(),this._stop()}destroy(){var e;this._stop(),null===(e=this._engineInjections)||void 0===e||e.removeReceiver(this._playerReceiver),this._dispatcher.destroy(),this._playerEmitter.removeAllListeners(),this._playerState.destroy=!0}setMuted(e){this._stateCheck(),this._render.setMuted(e)}fullScreen(){this._stateCheck(),this._render.fullScreen()}setAdvanceConfig(e){this._configState.setConfig({advanceConfig:Object.assign(Object.assign({},this._configState.advanceConfig),e)})}addEventListener(e,t){this._stateCheck(),so.expect(e).typeof("string").catch((()=>{throw new Qr("event name should be a string.")})),so.expect(t).typeof("function").catch((()=>{throw new Qr("event callback should be a function")})),t&&this._playerEmitter.on(e,t)}removeEventListener(e,t){this._stateCheck(),so.expect(e).typeof("string").catch((()=>{throw new Qr("event name should be a string.")})),t?this._playerEmitter.off(e,t):this._playerEmitter.removeAllListeners(e)}};Ua([lo("0.eck"),za("design:type",Function),za("design:paramtypes",[]),za("design:returntype",void 0)],qa.prototype,"_environmentCheck",null),Ua([lo("0.seiu"),za("design:type",Function),za("design:paramtypes",[]),za("design:returntype",void 0)],qa.prototype,"_seiConfigUpdate",null),Ua([lo("icg"),za("design:type",Function),za("design:paramtypes",[Object,Object,Boolean]),za("design:returntype",void 0)],qa.prototype,"initConfig",null),Ua([lo("vify.tkn"),za("design:type",Function),za("design:paramtypes",[String,String]),za("design:returntype",Promise)],qa.prototype,"verifyToken",null),Ua([lo("sul"),za("design:type",Function),za("design:paramtypes",[String]),za("design:returntype",void 0)],qa.prototype,"setUrl",null),Ua([lo("gul"),za("design:type",Function),za("design:paramtypes",[]),za("design:returntype",String)],qa.prototype,"getUrl",null),Ua([lo("ply"),za("design:type",Function),za("design:paramtypes",[]),za("design:returntype",void 0)],qa.prototype,"play",null),Ua([lo("pus"),za("design:type",Function),za("design:paramtypes",[]),za("design:returntype",void 0)],qa.prototype,"pause",null),Ua([lo("svel"),za("design:type",Function),za("design:paramtypes",[HTMLVideoElement]),za("design:returntype",void 0)],qa.prototype,"setVideoEl",null),Ua([lo("rsm"),za("design:type",Function),za("design:paramtypes",[]),za("design:returntype",void 0)],qa.prototype,"resume",null),Ua([lo("0.stp"),za("design:type",Function),za("design:paramtypes",[]),za("design:returntype",void 0)],qa.prototype,"_stop",null),Ua([lo("stp"),za("design:type",Function),za("design:paramtypes",[]),za("design:returntype",void 0)],qa.prototype,"stop",null),Ua([lo("dsy"),za("design:type",Function),za("design:paramtypes",[]),za("design:returntype",void 0)],qa.prototype,"destroy",null),Ua([lo("stmut"),za("design:type",Function),za("design:paramtypes",[Boolean]),za("design:returntype",void 0)],qa.prototype,"setMuted",null),Ua([lo("fusc"),za("design:type",Function),za("design:paramtypes",[]),za("design:returntype",void 0)],qa.prototype,"fullScreen",null),Ua([lo("sacfg"),za("design:type",Function),za("design:paramtypes",[Object]),za("design:returntype",void 0)],qa.prototype,"setAdvanceConfig",null),Ua([lo("aevl"),za("design:type",Function),za("design:paramtypes",[String,Function]),za("design:returntype",void 0)],qa.prototype,"addEventListener",null),Ua([lo("revl"),za("design:type",Function),za("design:paramtypes",[String,Function]),za("design:returntype",void 0)],qa.prototype,"removeEventListener",null),qa=Ba=Ua([nt(),lo("0.pctl"),Va(0,dt(Ro)),Va(1,dt(Hr)),Va(2,dt(ha)),Va(3,dt(La)),Va(4,dt(bo)),Va(5,dt(_o)),za("design:paramtypes",[Ro,Hr,ha,La,bo,_o])],qa);var Ga=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class Ya{constructor(e,t){this._container=new tt,this._controller=this._container.get(qa),so.bind(e).is.exist.catch((()=>{throw new Qr("engine is needed. example: 'var player = new Player(zg, ..);'")})),t.engineType&&"liveroom"===t.engineType&&(e=e.zegoEntity),so.bind(e.zegoWebRTC).is.exist.hasKey("inject").catch((()=>{throw new to("sdk version is not support! This may be caused by the version of 'zego-express-engine-webrtc' package being too low.")})),e.zegoWebRTC.inject("ZegoExpressPlayer",(n=>{this._controller.initConfig(t,n,e.zegoWebRTC.stateCenter.player265Validated)}))}set src(e){this._controller.setUrl(e)}get src(){return this._controller.getUrl()}get currentTime(){return this._controller.getCurrentTime()}get played(){return this._controller.getPlayed()}get paused(){return this._controller.getPaused()}get volume(){return this._controller.getVolume()}get duration(){return this._controller.getDuration()}get canvas(){return this._controller.getCanvas()}verify(e,t){return Ga(this,void 0,void 0,(function*(){return yield this._controller.verifyToken(e,t)}))}play(){this._controller.play()}pause(){this._controller.pause()}resume(){this._controller.resume()}setVolume(e){this._controller.setVolume(e)}setMuted(e){this._controller.setMuted(e)}destroy(){this._controller.destroy()}stop(){this._controller.stop()}fullScreen(){this._controller.fullScreen()}setAdvanceConfig(e){this._controller.setAdvanceConfig(e)}set onEnded(e){this._controller.removeEventListener(yo.MEDIA_PLAY_ENDED),e&&this._controller.addEventListener(yo.MEDIA_PLAY_ENDED,e)}set onCanPlay(e){this._controller.removeEventListener(yo.MEDIA_CAN_PLAY),e&&this._controller.addEventListener(yo.MEDIA_CAN_PLAY,e)}set onPlay(e){this._controller.removeEventListener(yo.MEDIA_PLAYED),e&&this._controller.addEventListener(yo.MEDIA_PLAYED,e)}set onPaused(e){this._controller.removeEventListener(yo.MEDIA_PAUSED),e&&this._controller.addEventListener(yo.MEDIA_PAUSED,e)}set onLoaded(e){this._controller.removeEventListener(yo.MEDIA_LOADED),e&&this._controller.addEventListener(yo.MEDIA_LOADED,e)}set onTimeUpdate(e){this._controller.removeEventListener(yo.CURRENT_TIME_CHANGE),e&&this._controller.addEventListener(yo.CURRENT_TIME_CHANGE,e)}set onWaiting(e){this._controller.removeEventListener(yo.MEDIA_PLAY_WAITING),e&&this._controller.addEventListener(yo.MEDIA_PLAY_WAITING,e)}set onPlaying(e){this._controller.removeEventListener(yo.MEDIA_PLAYING),e&&this._controller.addEventListener(yo.MEDIA_PLAYING,e)}set onError(e){this._controller.removeEventListener(yo.ERROR),e&&this._controller.addEventListener(yo.ERROR,e)}set onMediaInfoUpdate(e){this._controller.removeEventListener(yo.MEDIA_INFO_UPDATE),e&&this._controller.addEventListener(yo.MEDIA_INFO_UPDATE,e)}set onRecvSEI(e){this._controller.removeEventListener(yo.RECV_SEI),e&&this._controller.addEventListener(yo.RECV_SEI,e)}}})(),ZegoExpressPlayer=i.ZegoExpressPlayer})();